!function(e){function t(t){for(var n,i,s=t[0],c=t[1],l=t[2],p=0,d=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);d.length;)d.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==a[c]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={3:0},o=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],r=a[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=n);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+""+({}[e]||e)+"."+{0:"a3276bf9",1:"e90c062f",2:"343b0f44",17:"1139dcb7",18:"0ff1a67f",19:"e535fa88",20:"d43b28a8",21:"dd4b7644",22:"4336fbea"}[e]+".iframe.bundle.js"}(e);var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(l);var r=a[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",c.name="ChunkLoadError",c.type=n,c.request=o,r[1](c)}a[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;o.push([721,7,5,14,15,6,16,4,13,11,9,10,12,8]),r()}({1042:function(e,t,r){},1043:function(e,t,r){"use strict";(function(e){(0,r(511).configure)([r(1044),r(1084)],e,!1)}).call(this,r(315)(e))},1044:function(e,t,r){var n={"./stories/IntroductionCore.stories.mdx":1045};function a(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id=1044},1045:function(e,t,r){"use strict";r.r(t),r.d(t,"__page",(function(){return l}));r(0);var n=r(115),a=r(624),o=r(630);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}const s={};function c({components:e,...t}){return Object(n.b)("wrapper",i({},s,t,{components:e,mdxType:"MDXLayout"}),Object(n.b)(o.a,{title:"Core/Introduction",mdxType:"Meta"}))}c.isMDXComponent=!0;const l=()=>{throw new Error("Docs-only story")};l.parameters={docsOnly:!0};const u={title:"Core/Introduction",includeStories:["__page"]},p={};u.parameters=u.parameters||{},u.parameters.docs={...u.parameters.docs||{},page:()=>Object(n.b)(a.a,{mdxStoryNameToKey:p,mdxComponentAnnotations:u},Object(n.b)(c,null))},t.default=u},1084:function(e,t,r){var n={"./components/MapLibreMap/MapLibreMap.stories.js":1085,"./components/MlComponentTemplate/MlComponentTemplate.stories.js":1086,"./components/MlCreatePdfButton/MlCreatePdfButton.stories.js":1087,"./components/MlFeatureEditor/MlFeatureEditor.stories.js":1088,"./components/MlFillExtrusionLayer/MlFillExtrusionLayer.stories.js":1097,"./components/MlFollowGps/MlFollowGps.stories.js":1098,"./components/MlGPXViewer/MlGPXViewer.stories.js":1099,"./components/MlGeoJsonLayer/MlGeoJsonLayer.stories.js":1103,"./components/MlImageMarkerLayer/MlImageMarkerLayer.stories.js":1143,"./components/MlLayer/MlLayer.stories.js":1104,"./components/MlLayerMagnify/MlLayerMagnify.stories.js":1105,"./components/MlLayerSwipe/MlLayerSwipe.stories.js":1107,"./components/MlLayerSwitcher/MlLayerSwitcher.stories.js":1133,"./components/MlMarker/MlMarker.stories.js":1118,"./components/MlNavigationCompass/MlNavigationCompass.stories.js":1119,"./components/MlNavigationTools/MlNavigationTools.stories.js":1120,"./components/MlOsmLayer/MlOsmLayer.stories.js":1121,"./components/MlScaleReference/MlScaleReference.stories.js":1144,"./components/MlShareMapState/MlShareMapState.stories.js":1145,"./components/MlSpatialElevationProfile/MlSpatialElevationProfile.stories.js":1122,"./components/MlThreeJsLayer/MlThreeJsLayer.stories.js":1134,"./components/MlTransitionGeoJsonLayer/MlTransitionGeoJsonLayer.stories.js":1132,"./components/MlUseMapDebugger/MlUseMapDebugger.stories.js":1146,"./components/MlVectorTileLayer/MlVectorTileLayer.stories.js":1123,"./components/MlWmsFeatureInfoPopup/MlWmsFeatureInfoPopup.stories.js":1147,"./components/MlWmsLayer/MlWmsLayer.stories.js":1124,"./components/MlWmsLoader/MlWmsLoader.stories.js":1137,"./hooks/useMapState.stories.js":1127};function a(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id=1084},1085:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(124)),o=r(34),i=r(1),s={title:"Core/MapLibreMap",component:a.a,argTypes:{options:{control:{type:"object"}}}};t.default=s;var c=function(e){return Object(i.jsx)(o.a,{children:Object(i.jsx)(a.a,{options:e.options})})}.bind({});c.args={options:{style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[8.607,53.1409349],maxBounds:[[1.40625,43.452919],[17.797852,55.973798]]}},c.parameters={},c.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <MapComponentsProvider>\n    <MapLibreMap options={args.options} />\n  </MapComponentsProvider>\n)"}},c.parameters)},1086:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(252)),o=r(40),i=r(1),s={title:"MapComponents/MlComponentTemplate",component:a.a,argTypes:{url:{},layer:{}},decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,{})}.bind({});c.parameters={},c.args={},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlComponentTemplate />"}},c.parameters)},1087:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(266)),o=r(92),i=r(40),s=r(1),c={title:"MapComponents/MlCreatePdfButton",component:a.a,argTypes:{options:{control:{type:"object"}}},decorators:i.a};t.default=c;var l=function(e){return Object(s.jsx)(o.a,{children:Object(s.jsx)(a.a,{})})}.bind({});l.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <TopToolbar>\n    <MlCreatePdfButton />\n  </TopToolbar>\n)"}},l.parameters)},1088:function(e,t,r){"use strict";r.r(t),r.d(t,"EditPolygon",(function(){return l})),r.d(t,"EditPoint",(function(){return u})),r.d(t,"EditLineString",(function(){return p})),r.d(t,"DrawPolygon",(function(){return d})),r.d(t,"DrawPoint",(function(){return f})),r.d(t,"DrawLineString",(function(){return m}));var n=r(5),a=(r(0),r(265)),o=r(40),i=r(1),s={title:"MapComponents/MlFeatureEditor",component:a.a,argTypes:{},decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,Object(n.a)({debug:!0,onChange:function(e){console.log(e)}},e))},l=c.bind({});l.args={mode:"custom_select",geojson:{type:"Feature",properties:{},geometry:{coordinates:[[[7.0904979943736635,50.73948334574527],[7.087554458473562,50.73827346433987],[7.093562913197076,50.73723639825727],[7.096294028980594,50.7387727842636],[7.0904979943736635,50.73948334574527]]],type:"Polygon"}}};var u=c.bind({});u.args={mode:"custom_select",geojson:{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[7.0904979943736635,50.73948334574527]}}};var p=c.bind({});p.args={mode:"simple_select",geojson:{type:"Feature",properties:{},geometry:{coordinates:[[7.0904979943736635,50.73948334574527],[7.087554458473562,50.73827346433987],[7.093562913197076,50.73723639825727],[7.096294028980594,50.7387727842636]],type:"LineString"}}};var d=c.bind({});d.args={mode:"custom_polygon"};var f=c.bind({});f.args={mode:"draw_point"};var m=c.bind({});m.args={mode:"draw_line_string"},l.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},l.parameters),u.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},u.parameters),p.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},p.parameters),d.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},d.parameters),f.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},f.parameters),m.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},m.parameters)},1089:function(e,t,r){},1097:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(92)),o=r(256),i=r(40),s=r(1),c={title:"MapComponents/MlFillExtrusionLayer",component:o.a,argTypes:{options:{control:{type:"object"}}},decorators:i.a};t.default=c;var l=function(e){return Object(s.jsx)(a.a,{children:Object(s.jsx)(o.a,{})})}.bind({});l.parameters={},l.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <TopToolbar>\n    <MlFillExtrusionLayer />\n  </TopToolbar>\n)"}},l.parameters)},1098:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(183)),o=r(40),i=r(1),s={title:"MapComponents/MlFollowGps",component:a.a,argTypes:{url:{},layer:{}},decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,{})}.bind({});c.parameters={},c.args={},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlFollowGps />"}},c.parameters)},1099:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(184)),o=r(40),i=r(210),s=r(1),c={title:"MapComponents/MlGPXViewer",component:a.a,argTypes:{options:{control:{type:"object"}}},decorators:o.a};t.default=c;var l=function(e){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(i.a,{children:Object(s.jsx)(a.a,{})})})}.bind({});l.parameters={},l.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <>\n    <GeoJsonProvider>\n      <MlGPXViewer />\n    </GeoJsonProvider>\n  </>\n)"}},l.parameters)},1103:function(e,t,r){"use strict";r.r(t),r.d(t,"Linestring",(function(){return p})),r.d(t,"Polygon",(function(){return d})),r.d(t,"DefaultPaintOverrides",(function(){return f}));var n=r(5),a=(r(0),r(84)),o=r(40),i=r(343),s=r(351),c=r(1);console.log(s);var l={title:"MapComponents/MlGeoJsonLayer",component:a.a,argTypes:{url:{},layer:{}},decorators:o.a};t.default=l;var u=function(e){return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(a.a,Object(n.a)({},e))})},p=function(e){return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(a.a,{type:"line",geojson:i})})}.bind({});p.parameters={},p.args={};var d=u.bind({});d.parameters={},d.args={geojson:s};var f=u.bind({});f.parameters={},f.args={defaultPaintOverrides:{fill:{"fill-color":"blue"},circle:{"circle-color":"red"},line:{"line-color":"orange"}},geojson:s},p.parameters=Object(n.a)({storySource:{source:'(props) => {\n  return (\n    <>\n      <MlGeoJsonLayer type="line" geojson={sample_geojson_1} />\n    </>\n  );\n}'}},p.parameters),d.parameters=Object(n.a)({storySource:{source:"(props) => {\n  return (\n    <>\n      <MlGeoJsonLayer {...props} />\n    </>\n  );\n}"}},d.parameters),f.parameters=Object(n.a)({storySource:{source:"(props) => {\n  return (\n    <>\n      <MlGeoJsonLayer {...props} />\n    </>\n  );\n}"}},f.parameters)},1104:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(185)),o=r(40),i=r(1),s={title:"MapComponents/MlLayer",component:a.a,argTypes:{url:{},layer:{}},decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,{})}.bind({});c.parameters={},c.args={},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlLayer />"}},c.parameters)},1105:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(258)),o=r(93),i=r(216),s=r(1),c={title:"MapComponents/MlLayerMagnify",component:a.a,argTypes:{url:{},layer:{}},decorators:i.a};t.default=c;var l=function(e){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(o.a,{url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",urlParameters:{layers:"nw_uraufnahme_rw"},sourceOptions:{minzoom:13,maxzoom:20},mapId:e.wmsLayerMapId}),Object(s.jsx)(a.a,{map1Id:"map_1",map2Id:"map_2",magnifierRadius:e.magnifierRadius})]})}.bind({});l.parameters={},l.args={wmsLayerMapId:"map_2",magnifierRadius:200},l.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <>\n    <MlWmsLayer\n      url="https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme"\n      urlParameters={{\n        layers: "nw_uraufnahme_rw",\n      }}\n      sourceOptions={{\n        minzoom: 13,\n        maxzoom: 20,\n      }}\n      mapId={args.wmsLayerMapId}\n    />\n    <MlLayerMagnify map1Id="map_1" map2Id="map_2" magnifierRadius={args.magnifierRadius} />\n  </>\n)'}},l.parameters)},1106:function(e,t,r){},1107:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(259)),o=r(93),i=r(216),s=r(1),c={title:"MapComponents/MlLayerSwipe",name:"MlLayerSwipe",component:a.a,argTypes:{url:{},layer:{}},decorators:i.a};t.default=c;var l=function(e){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(o.a,{url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",urlParameters:{layers:"nw_uraufnahme_rw"},sourceOptions:{minzoom:13,maxzoom:20},mapId:"map_2"}),Object(s.jsx)(a.a,{map1Id:"map_1",map2Id:"map_2"})]})}.bind({});l.parameters={},l.args={},l.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <>\n    <MlWmsLayer\n      url="https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme"\n      urlParameters={{\n        layers: "nw_uraufnahme_rw",\n      }}\n      sourceOptions={{\n        minzoom: 13,\n        maxzoom: 20,\n      }}\n      mapId="map_2"\n    />\n    <MlLayerSwipe map1Id="map_1" map2Id="map_2" />\n  </>\n)'}},l.parameters)},1108:function(e,t,r){},1112:function(e,t,r){},1118:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(271)),o=r(40),i=r(1),s={title:"MapComponents/MlMarker",component:a.a,decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,Object(n.a)({},e))}.bind({});c.args={content:"WhereGroup",lng:7.0851268,lat:50.73884,mapId:"map_1"},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlMarker {...args}/>"}},c.parameters)},1119:function(e,t,r){"use strict";r.r(t),r.d(t,"Standard",(function(){return l})),r.d(t,"StyleExample",(function(){return u}));var n=r(5),a=(r(0),r(186)),o=r(40),i=r(1),s={title:"MapComponents/MlNavigationCompass",component:a.a,decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,Object(n.a)({},e))},l=c.bind({});l.args={style:{transform:"scale(4)",left:"50%",marginLeft:"-100px",top:"50%",marginTop:"-100px"}};var u=c.bind({});u.args={style:{transform:"scale(4)",left:"50%",marginLeft:"-100px",top:"50%",marginTop:"-100px"},backgroundStyle:{border:"12px solid #adad44",background:"radial-gradient(#417741, #111)"},needleStyle:{":hover svg path:nth-of-type(1)":{fill:"#eded66"},":hover svg path:nth-of-type(2)":{fill:"#252f1b"},"svg path:nth-of-type(1)":{fill:"#adad44"},"svg path:nth-of-type(2)":{fill:"#1a1d15"}},rotateRightStyle:{"svg:hover path":{fill:"#ededb1"}},rotateLeftStyle:{"svg:hover path":{fill:"#ededb1"}}},l.parameters=Object(n.a)({storySource:{source:"(props) => <MlNavigationCompass {...props} />"}},l.parameters),u.parameters=Object(n.a)({storySource:{source:"(props) => <MlNavigationCompass {...props} />"}},u.parameters)},1120:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(5),a=(r(0),r(260)),o=r(40),i=r(1),s={title:"MapComponents/MlNavigationTools",component:a.a,argTypes:{url:{},layer:{}},decorators:o.a};t.default=s;var c=function(e){return Object(i.jsx)(a.a,{})}.bind({});c.parameters={},c.args={},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlNavigationTools />"}},c.parameters)},1121:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(261)),o=r(92),i=r(40),s=r(1),c={title:"MapComponents/MlOsmLayer",component:a.a,argTypes:{options:{control:{type:"object"}}},decorators:i.a};t.default=c;var l=function(e){return Object(s.jsx)(o.a,{children:Object(s.jsx)(a.a,Object(n.a)({},e))})}.bind({});l.args={sourceOptions:{tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg"],attribution:'Map tiles by <a target="_top" rel="noopener" href="http://stamen.com">Stamen Design</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a target="_top" rel="noopener" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'},layerOptions:{}},l.parameters=Object(n.a)({storySource:{source:"(props) => (\n  <TopToolbar>\n    <MlOsmLayer {...props} />\n  </TopToolbar>\n)"}},l.parameters)},1122:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return m}));var n=r(5),a=(r(0),r(263)),o=r(184),i=r(40),s=r(210),c=r(660),l=r.n(c),u=r(278),p=r(353),d=r(1),f={title:"MapComponents/MlSpatialElevationProfile",component:a.a,argTypes:{options:{control:{type:"object"}}},decorators:i.a};t.default=f;var m=function(e){var t=Object(p.a)("(max-width:900px)");return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(u.a,{style:{position:"absolute",right:"5px",bottom:t?"145px":"125px",backgroundColor:"rgba(255,255,255,1)",zIndex:1e3},title:"Download sample-data",size:"large",href:"assets/sample.gpx",target:"blank",children:Object(d.jsx)(l.a,{})}),Object(d.jsxs)(s.a,{children:[Object(d.jsx)(o.a,{}),Object(d.jsx)(a.a,{})]})]})}.bind({});m.parameters={},m.parameters=Object(n.a)({storySource:{source:'(args) => {\n\n  const mediaIsMobile = useMediaQuery("(max-width:900px)");\n\n  return(\n  <>\n    <IconButton\n      style={{\n        position: "absolute",\n        right: "5px",\n        bottom: mediaIsMobile ? "145px" : "125px",\n        backgroundColor: "rgba(255,255,255,1)",\n\n        zIndex: 1000,\n      }}\n      title="Download sample-data"\n      size="large"\n      href="assets/sample.gpx"\n      target="blank"\n    >\n      <FileDownloadIcon />\n    </IconButton>\n    <GeoJsonProvider>\n      <MlGPXViewer />\n      <MlSpatialElevationProfile />\n    </GeoJsonProvider>\n  </>\n);\n}'}},m.parameters)},1123:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(264)),o=r(92),i=r(40),s=r(1),c={title:"MapComponents/MlVectorTileLayer",component:a.a,argTypes:{url:{},layer:{}},decorators:i.a};t.default=c;var l=function(e){return Object(s.jsx)(o.a,{children:Object(s.jsx)(a.a,Object(n.a)({},e))})}.bind({});l.parameters={},l.args={mapId:"map_1",url:"https://wms.wheregroup.com/tileserver/tile/tileserver.php?/europe-0-14/index.json?/europe-0-14/{z}/{x}/{y}.pbf",layers:{landuseLine:{"source-layer":"landuse",layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":2,"line-color":"#ff0000"}}},sourceOptions:{minzoom:0,maxzoom:20}},l.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <TopToolbar>\n    <MlVectorTileLayer {...args} />\n  </TopToolbar>\n)"}},l.parameters)},1124:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return d}));var n=r(5),a=r(15),o=r(0),i=r(93),s=r(92),c=r(168),l=r(216),u=(r(1125),r(1)),p={title:"MapComponents/MlWmsLayer",component:i.a,argTypes:{url:{},layer:{}},decorators:l.a};t.default=p;var d=function(e){var t=Object(o.useState)(!0),r=Object(a.a)(t,2),l=r[0],p=r[1];return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(s.a,{children:Object(u.jsx)(c.a,{color:"primary",variant:l?"contained":"outlined",onClick:function(){return p(!l)},children:"WMS"})}),Object(u.jsx)(i.a,Object(n.a)({visible:l},e))]})}.bind({});d.parameters={},d.args={mapId:"map_2",url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",urlParameters:{layers:"nw_uraufnahme_rw"}},d.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const [showLayer, setShowLayer] = useState(true);\n\n  return (\n    <>\n      <TopToolbar>\n        <Button\n          color="primary"\n          variant={showLayer ? "contained" : "outlined"}\n          onClick={() => setShowLayer(!showLayer)}\n        >\n          WMS\n        </Button>\n      </TopToolbar>\n      <MlWmsLayer visible={showLayer} {...props} />\n    </>\n  );\n}'}},d.parameters)},1125:function(e,t,r){},1127:function(e,t,r){"use strict";r.r(t),r.d(t,"ViewportOnly",(function(){return u})),r.d(t,"IncludeBaseLayers",(function(){return p})),r.d(t,"MatchLayerIdString",(function(){return d})),r.d(t,"MatchLayerIdRegexp",(function(){return f})),r.d(t,"NonBaseLayersOnly",(function(){return m}));var n=r(5),a=r(0),o=r(64),i=r(40),s=r(1),c={title:"Hooks/UseMapState",component:o.a,argTypes:{},decorators:i.a};t.default=c;var l=function(e){var t=Object(o.a)(Object(n.a)({},e));return Object(a.useEffect)((function(){}),[t.layers]),Object(s.jsx)(s.Fragment,{children:Object(s.jsx)("div",{style:{position:"fixed",zIndex:1e4,display:"flex",flexWrap:"wrap",top:0,left:0,right:0,bottom:0,maxHeight:"100VH",backgroundColor:"rgba(80,80,80,.8)",padding:"50px",fontSize:"20px",color:"#51ff09",overflow:"hidden",pointerEvents:"none"},children:Object(s.jsx)("pre",{children:JSON.stringify(t,null,"  ")})})})},u=l.bind({});u.parameters={},u.args={mapId:"map_1",watch:{viewport:!0,layers:!1,sources:!1}};var p=l.bind({});p.parameters={},p.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!0}};var d=l.bind({});d.parameters={},d.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!0,matchLayerIds:"water"}};var f=l.bind({});f.parameters={},f.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!0,matchLayerIds:/water/}};var m=l.bind({});m.parameters={},m.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}},u.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},u.parameters),p.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},p.parameters),d.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},d.parameters),f.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},f.parameters),m.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},m.parameters)},1132:function(e,t,r){"use strict";r.r(t),r.d(t,"Linestring",(function(){return M}));var n=r(5),a=r(15),o=r(0),i=r(213),s=r(65),c=r(76),l=r(56),u=function(e,t,r,n,a,o,i,c,u,d){var f=[],m=[],h=[],g=[];t.current=[];var y=a.current||{geometry:{type:"LineString",coordinates:[]},properties:{},type:"Feature"},b=e.geojson,v=b,j=y,O=!1;if(void 0===v.geometry&&void 0!==j.geometry&&j.geometry.coordinates.length>1)v=s.lineString(j.geometry.coordinates.slice(0,2));else if(void 0===j.geometry&&void 0!==v.geometry&&v.geometry.coordinates.length>1)j=s.lineString(v.geometry.coordinates.slice(0,2));else if(void 0===j.geometry&&void 0===v.geometry)return;if(v.geometry.coordinates.length<j.geometry.coordinates.length&&(v=y,j=b,O=!0),v&&j)for(var x=0,S=v.geometry.coordinates.length;x<S;x++)void 0!==j.geometry.coordinates[x]&&v.geometry.coordinates[x][0]===j.geometry.coordinates[x][0]&&v.geometry.coordinates[x][1]===j.geometry.coordinates[x][1]?t.current.push(v.geometry.coordinates[x]):(void 0!==v.geometry.coordinates[x]&&m.push(v.geometry.coordinates[x]),void 0!==j.geometry.coordinates[x]&&f.push(j.geometry.coordinates[x]));if(O?(h=f,g=m):(h=m,g=f),!(h.length<2&&g<2)){var M,C=e.transitionTime/o,L=g.length>1?Math.round(s.length(s.lineString(g))):0,w=h.length>1?Math.round(s.length(s.lineString(h))):0,I=w+L,E=L/I,T=Math.round(C*E),_=Math.round(L/T*100)/100,R=w/I,A=Math.round(C*R),P=Math.round(w/A*100)/100;L<=0&&.1,(M=Object(l.a)(p(g,_,T))).reverse(),(M=[].concat(Object(l.a)(M),Object(l.a)(p(h,P,A)))).push(b),r.current=M,i.current=1,n.current=!0,u.current=setTimeout((function(){return function e(t,r,n,a,o,i,c,u,p){var d=arguments;if(void 0!==a.current[i.current]){var f=i.current+1===a.current.length?t.geojson:s.lineString([].concat(Object(l.a)(o.current),Object(l.a)(a.current[i.current].geometry.coordinates)));p(f),"function"==typeof t.onTransitionFrame&&t.onTransitionFrame(f),i.current++,n.current&&i.current<a.current.length?u.current=setTimeout((function(){return e.apply(void 0,Object(l.a)(d))}),c):("function"==typeof t.onTransitionEnd&&t.onTransitionEnd(t.geojson),n.current=!1)}}(e,c,n,r,t,i,o,u,d)}),o)}},p=function(e,t,r){var n=[];if(e.length>1)for(var a=s.lineChunk(s.lineString(e),t),o=a.features[0],i=0;i<r&&(n.push(o),void 0!==a.features[i]);i++)o=s.lineString([].concat(Object(l.a)(o.geometry.coordinates),Object(l.a)(a.features[i].geometry.coordinates)));return n},d=(r(124),r(252),r(256),r(183),r(266),r(84)),f=(r(257),r(260),r(186),r(185),r(261),r(264),r(93),r(265),r(34)),m=r(1),h=function(e){var t=Object(o.useContext)(f.b);return Object(o.useEffect)((function(){if(t.mapExists())return function(){"function"==typeof e.cleanup&&e.cleanup(t.getMap(e.mapId))}})),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&"function"==typeof e.mapIsReady&&e.mapIsReady(t.getMap(e.mapId))}),[t.mapIds,t,e]),Object(m.jsx)(m.Fragment,{})};h.__docgenInfo={description:"",methods:[],displayName:"MlBasicComponent"};"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlBasicComponent.js"]={name:"MlBasicComponent",docgenInfo:h.__docgenInfo,path:"src/components/MlBasicComponent.js"});r(258),r(259),r(184),r(210),r(160),r(263),r(64);var g=["geojson"],y=function(e){e.geojson;var t=Object(i.a)(e,g),r=Object(c.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),l=Object(o.useRef)(!1),p=Object(o.useRef)(null),f=Object(o.useRef)(!1),h=Object(o.useRef)(void 0),y=Object(o.useRef)(!1),b=Object(o.useRef)([]),v=Object(o.useRef)([]),j=Object(o.useState)(s.featureCollection([])),O=Object(a.a)(j,2),x=O[0],S=O[1];Object(o.useEffect)((function(){return function(){h.current&&clearTimeout(h.current)}}),[]);var M=Object(o.useCallback)((function(){u(e,v,b,f,p,50,y,r.map,h,S)}),[e,r.map]);Object(o.useEffect)((function(){r.map&&l.current&&(void 0!==e.transitionTime&&"line"===e.type&&p.current&&(f.current=!1,y.current=!1,b.current=[],v.current=[],M()),p.current=e.geojson)}),[r.map,M,e]);var C=Object(o.useCallback)((function(){"line"===e.type&&void 0!==e.transitionTime&&e.transitionTime&&void 0!==e.geojson.geometry&&JSON.stringify(p.current)!==JSON.stringify(e.geojson)&&(M(e.geojson),p.current=e.geojson)}),[e,M]);return Object(o.useEffect)((function(){r.mapIsReady&&e.geojson&&(l.current=!0,C())}),[r.mapIsReady,C,e]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(d.a,Object(n.a)(Object(n.a)({},t),{},{geojson:x}))})};y.__docgenInfo={description:'Adds source and layer of types "line", "fill" or "circle" to display GeoJSON data on the map.\n\n@component',methods:[],displayName:"MlTransitionGeoJsonLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},type:{type:{name:"string"},required:!1,description:'Type of the layer that will be added to the MapLibre instance.\nPossible values: "line", "circle", "fill"'},layout:{type:{name:"object"},required:!1,description:"Layout property object, that is passed to the addLayer call.\nPossible props depend on the layer type.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill"},paint:{type:{name:"object"},required:!1,description:"Paint property object, that is passed to the addLayer call.\nPossible props depend on the layer type.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill"},defaultPaintOverrides:{type:{name:"object"},required:!1,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.'},options:{type:{name:"object"},required:!1,description:"Javascript object that is spread into the addLayer commands first parameter."},geojson:{type:{name:"object"},required:!1,description:"GeoJSON data that is supposed to be rendered by this component."},insertBeforeLayer:{type:{name:"string"},required:!1,description:'Id of an existing layer in the mapLibre instance to help specify the layer order\nThis layer will be visually beneath the layer with the "insertBeforeLayer" id.'},onClick:{type:{name:"func"},required:!1,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked."},onHover:{type:{name:"func"},required:!1,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered."},onLeave:{type:{name:"func"},required:!1,description:"Leave event handler that is executed whenever a geometry rendered by this component is\nleft/unhovered."},transitionTime:{type:{name:"number"},required:!1,description:'Creates transition animation whenever the geojson prop changes.\nOnly works with layer type "line" and LineString GeoJSON data.'}}};var b=y;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlTransitionGeoJsonLayer/MlTransitionGeoJsonLayer.js"]={name:"MlTransitionGeoJsonLayer",docgenInfo:y.__docgenInfo,path:"src/components/MlTransitionGeoJsonLayer/MlTransitionGeoJsonLayer.js"});var v=r(40),j=r(661),O=r(662),x=r(663);console.log(x);var S={title:"MapComponents/MlTransitionGeoJsonLayer",component:b,argTypes:{url:{},layer:{}},decorators:v.a},M=(t.default=S,function(e){var t=Object(o.useContext)(f.b),r=Object(o.useState)(j),i=Object(a.a)(r,2),s=i[0],c=i[1],l=Object(o.useRef)(!1);return Object(o.useEffect)((function(){t.getMap()&&!l.current&&(l.current=!0,t.getMap().setCenter({lng:7.137609868988648,lat:50.74746799549129}),t.getMap().setZoom(9.5),setTimeout((function(){c(O)}),4e3))}),[s,t]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(b,Object(n.a)({type:"line",geojson:s,transitionTime:2e3},e))})}.bind({}));M.parameters={},M.args={paint:{"line-color":"red","line-width":4}},M.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapContext = useContext(MapContext);\n  const [geojson, setGeojson] = useState(sample_geojson_1);\n  const initializedRef = useRef(false);\n\n  useEffect(() => {\n    if (!mapContext.getMap() || initializedRef.current) return;\n\n    initializedRef.current = true;\n    mapContext.getMap().setCenter({ lng: 7.137609868988648, lat: 50.74746799549129 });\n    mapContext.getMap().setZoom(9.5);\n\n    setTimeout(() => {\n      setGeojson(sample_geojson_2);\n    }, 4000);\n  }, [geojson, mapContext]);\n\n  return (\n    <>\n      <MlTransitionGeoJsonLayer type="line" geojson={geojson} transitionTime={2000} {...props} />\n    </>\n  );\n}'}},M.parameters)},1133:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return P}));var n=r(5),a=r(0),o=r(93),i=r(15),s=(r(1109),r(1110),r(1111),r(1112),r(1231)),c=r(1235),l=r(1236),u=r(1225),p=r(670),d=r(34),f=r(223),m=r(167),h=r(1224),g=r(1234),y=r(640),b=r.n(y),v=r(1),j=function(e){var t=Object(a.useState)("loading"),r=Object(i.a)(t,2),o=r[0],s=r[1];Object(a.useEffect)((function(){e.src?fetch(e.src).then((function(e){var t=e.ok;s(t?"ready":"error")})).catch((function(e){console.error(e),s("error")})):s("error")}),[e.src]);var c={width:"100%",height:"100%",border:2,borderRadius:"8px",textAlign:"center",display:"flex"},l=function(){return Object(v.jsx)(h.a,{className:e.className,sx:Object(n.a)(Object(n.a)({},c),e.style),children:Object(v.jsx)(g.a,{})})},u=function(){return Object(v.jsx)("img",{className:e.className,style:Object(n.a)(Object(n.a)({},c),e.style),src:e.src,alt:e.alt||""})},p=function(){return Object(v.jsx)(h.a,{className:e.className,sx:Object(n.a)({boxStyle:c},e.style),children:Object(v.jsx)(b.a,{sx:{display:"block",margin:"auto"}})})};return Object(v.jsx)(v.Fragment,{children:function(e){switch(e){case"ready":return Object(v.jsx)(u,{});case"error":return Object(v.jsx)(p,{});default:return Object(v.jsx)(l,{})}}(o)})};j.__docgenInfo={description:"",methods:[],displayName:"ImageLoader"};var O=j;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/ImageLoader.js"]={name:"ImageLoader",docgenInfo:j.__docgenInfo,path:"src/ui_components/ImageLoader.js"});var x,S=r(64),M=function(e){var t,r=Object(S.a)({mapId:e.mapId,watch:{viewport:!1,layers:!0,sources:!1},filter:{matchLayerIds:e.layerId}}).layers,n=Object(m.a)(x||(x=Object(f.a)(["\n    & img:hover {\n    }\n  "])));return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(h.a,{className:n,sx:{width:"40px",height:"53px",justifyContent:"center",py:.25,px:"1rem",cursor:"pointer"},onClick:function(){var t;null==e||null===(t=e.handleLayerBoxClick)||void 0===t||t.call(e,e.layerId)},children:[Object(v.jsx)(O,{style:{border:"2px solid "+(null!=r&&null!==(t=r[0])&&void 0!==t&&t.visible?"#64c864":"#fd720f"),borderRadius:"8px",height:"40px",width:"40px"},src:e.thumbnail}),Object(v.jsx)("div",{className:"mllayerswitcher-layer-text",style:{textAlign:"center",color:"rgb(112, 117, 122)",fontFamily:"Roboto, Arial",width:"40px",fontSize:"0.60rem"},children:e.label})]},e.layerId)})};M.__docgenInfo={description:"@component",methods:[],displayName:"LayerBox"};var C=M;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerSwitcher/components/LayerBox.js"]={name:"LayerBox",docgenInfo:M.__docgenInfo,path:"src/components/MlLayerSwitcher/components/LayerBox.js"});var L=r(1165),w=function(e){var t,r,n,o,f=Object(a.useContext)(d.b),m=!(null===(t=e.baseSourceConfig)||void 0===t||null===(r=t.layers)||void 0===r||!r.length),h=!(null===(n=e.detailLayerConfig)||void 0===n||null===(o=n.layers)||void 0===o||!o.length),g=Object(S.a)({mapId:e.mapId,watch:{viewport:!1,layers:!0,sources:!1},filter:{}}).layers,y=Object(a.useState)([]),b=Object(i.a)(y,2),j=b[0],O=b[1],x=Object(a.useState)([]),M=Object(i.a)(x,2),w=M[0],I=M[1],E=Object(s.a)().t;Object(a.useEffect)((function(){if(f.map){var t=function(e,t){var r=T(e.layerId),n=0===t?"visible":"none";r.forEach((function(e){e&&R(e,n)}))};e.baseSourceConfig.layers.forEach((function(e,r){return t(e,r)})),e.detailLayerConfig.layers.forEach((function(e,r){return t(e,r)}))}return function(){}}),[f.map]),Object(a.useEffect)((function(){var t,r;if(null!==(t=f.map)&&void 0!==t&&null!==(r=t.style)&&void 0!==r&&r._layers){var n=[],a=[];e.baseSourceConfig.layers.forEach((function(e){T(e.layerId).forEach((function(e){var t,r=null===(t=f.map)||void 0===t?void 0:t.getLayoutProperty(e,"visibility");-1!==f.map.baseLayers.indexOf(e)&&(e="styleBase"),-1===n.indexOf(e)&&"visible"===r&&n.push(e)}))})),e.detailLayerConfig.layers.forEach((function(e){var t,r=e.layerId,n=null===(t=f.map)||void 0===t?void 0:t.getLayoutProperty(r,"visibility");-1===a.indexOf(r)&&"visible"===n&&a.push(r)})),O(n),I(a)}}),[g]);var T=function(e){return"styleBase"===e?null==f?void 0:f.map.baseLayers:[e]},_=function(t){var r,n=T(t),a="visible"===(null==f||null===(r=f.map.getLayer(n[0]))||void 0===r?void 0:r.getLayoutProperty("visibility"))?"none":"visible";e.baseSourceConfig.layers.forEach((function(e,r){var n=T(e.layerId),o="none";e.layerId===t&&(o=a),"none"===a&&0===r&&(o="visible"),n.forEach((function(e){e&&R(e,o)}))}))},R=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";null===(t=f.map)||void 0===t||t.setLayoutProperty(e,"visibility",r)};return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(c.a,{sx:{zIndex:101,position:"absolute",minWidth:"200px"},children:[Object(v.jsxs)(l.a,{children:[m&&Object(v.jsxs)(u.a,{sx:{minHeight:"150px"},children:[Object(v.jsx)(p.a,{variant:"h6",children:E(e.baseSourceConfig.label||"Map type")}),Object(v.jsx)(L.a,{}),Object(v.jsx)(u.a,{sx:{display:"flex",paddingTop:"1rem"},children:e.baseSourceConfig.layers.map((function(t){var r=t.src,n=t.label,a=t.layerId;return Object(v.jsx)(C,{mapId:e.mapId,activeLayers:j,label:E(n),layerId:a,thumbnail:r,handleLayerBoxClick:function(){_(a)}},a)}))})]}),h&&Object(v.jsxs)(u.a,{sx:{minHeight:"150px"},children:[Object(v.jsx)(p.a,{variant:"h6",children:E("Map details")}),Object(v.jsx)(L.a,{}),Object(v.jsx)(u.a,{sx:{display:"flex",paddingTop:"1rem"},children:e.detailLayerConfig.layers.map((function(t){var r=t.src,n=t.label,a=t.layerId;return Object(v.jsx)(C,{mapId:e.mapId,activeLayers:w,label:E(n),layerId:a,thumbnail:r,handleLayerBoxClick:function(){!function(t){var r,n=e.detailLayerConfig.layers.find((function(e){return e.layerId===t}));n.linkedTo&&_(n.linkedTo);var a="visible"===(null==f||null===(r=f.map.getLayer(t))||void 0===r?void 0:r.getLayoutProperty("visibility"))?"none":"visible";R(t,a)}(a)}},a)}))})]})]})," "]})})};w.__docgenInfo={description:"@component",methods:[],displayName:"MlLayerSwitcher",props:{baseSourceConfig:{type:{name:"shape",value:{label:{name:"string",required:!1},layers:{name:"arrayOf",value:{name:"shape",value:{layerId:{name:"string",required:!0},src:{name:"string",required:!1},label:{name:"string",required:!0}}},required:!1}}},required:!1,description:""},detailLayerConfig:{type:{name:"shape",value:{label:{name:"string",required:!1},layers:{name:"arrayOf",value:{name:"shape",value:{layerId:{name:"string",required:!0},src:{name:"string",required:!1},label:{name:"string",required:!0},linkedTo:{name:"string",required:!1}}},required:!1}}},required:!1,description:""},mapId:{type:{name:"string"},required:!1,description:""}}};var I=w;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerSwitcher/MlLayerSwitcher.js"]={name:"MlLayerSwitcher",docgenInfo:w.__docgenInfo,path:"src/components/MlLayerSwitcher/MlLayerSwitcher.js"});var E=r(84),T=r(40),_=r(644),R=r(645),A={title:"MapComponents/MlLayerSwitcher",component:I,argTypes:{url:{},layer:{}},decorators:T.a},P=(t.default=A,function(e){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(o.a,{url:e.url,urlParameters:{layers:e.layer},sourceOptions:e.sourceOptions,layerId:"historic",visible:e.layerVisible}),Object(v.jsx)(o.a,{url:e.url2,urlParameters:{layers:e.layer2},sourceOptions:e.sourceOptions,layerId:e.layer2,visible:e.layer2Visible}),Object(v.jsx)(E.a,{type:"line",layout:{visibility:e.geojsonLayerVisible?"visible":"none"},geojson:_,layerId:"geojson1"}),Object(v.jsx)(E.a,{type:"line",layout:{visibility:e.geojson2LayerVisible?"visible":"none"},geojson:R,layerId:"geojson2"}),Object(v.jsx)(I,{baseSourceConfig:{active:e.baseSourcesActive,layers:e.layers},detailLayerConfig:e.detailLayerConfig}),";"]})}.bind({}));P.parameters={},P.args={url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",layer:"nw_uraufnahme_rw",layerVisible:!0,url2:"https://www.wms.nrw.de/geobasis/wms_nw_dop",layer2:"WMS_NW_DOP",layer2Visible:!1,geojsonLayerVisible:!0,geojson2LayerVisible:!0,sourceOptions:{minzoom:13,maxzoom:20},baseSourcesActive:!0,layers:[{label:"Historic",layerId:"historic",src:"assets/historic.png"},{label:"Straßenkarte",layerId:"styleBase",src:"assets/osm.png"},{label:"DOP",layerId:"WMS_NW_DOP",src:"assets/dop.png"}],detailLayerConfig:{layers:[{label:"GeoJson 1",layerId:"geojson1",src:"assets/historic.png",active:!0}]}},P.parameters=Object(n.a)({storySource:{source:'(args) => {\n  return (\n    <>\n      <MlWmsLayer\n        url={args.url}\n        urlParameters={{ layers: args.layer }}\n        sourceOptions={args.sourceOptions}\n        layerId="historic"\n        visible={args.layerVisible}\n      />\n      <MlWmsLayer\n        url={args.url2}\n        urlParameters={{ layers: args.layer2 }}\n        sourceOptions={args.sourceOptions}\n        layerId={args.layer2}\n        visible={args.layer2Visible}\n      />\n      <MlGeoJsonLayer\n        type="line"\n        layout={{ visibility: args.geojsonLayerVisible ? "visible" : "none" }}\n        geojson={sample_geojson_1}\n        layerId="geojson1"\n      />\n      <MlGeoJsonLayer\n        type="line"\n        layout={{ visibility: args.geojson2LayerVisible ? "visible" : "none" }}\n        geojson={sample_geojson_2}\n        layerId="geojson2"\n      />\n      <MlLayerSwitcher\n        baseSourceConfig={{\n          active: args.baseSourcesActive,\n          layers: args.layers,\n        }}\n        detailLayerConfig={args.detailLayerConfig}\n      />\n      ;\n    </>\n  );\n}'}},P.parameters)},1134:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return Ie}));var n=r(5),a=r(0),o=r.n(a),i=r(92),s=r(15),c=r(34),l=r(168),u=r(161),p=r.n(u),d=r(7),f=r(451),m=r(125),h=r(452),g=r(133),y=r(62),b=r(54),v=r(275),j=r(277),O=function(e){Object(v.a)(r,e);var t=Object(j.a)(r);function r(e){var n;return Object(y.a)(this,r),(n=t.call(this,e)).dracoLoader=null,n.ktx2Loader=null,n.meshoptDecoder=null,n.pluginCallbacks=[],n.register((function(e){return new L(e)})),n.register((function(e){return new R(e)})),n.register((function(e){return new A(e)})),n.register((function(e){return new w(e)})),n.register((function(e){return new I(e)})),n.register((function(e){return new E(e)})),n.register((function(e){return new T(e)})),n.register((function(e){return new _(e)})),n.register((function(e){return new M(e)})),n.register((function(e){return new P(e)})),n}return Object(b.a)(r,[{key:"load",value:function(e,t,r,n){var a,o=this;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:d.B.extractUrlBase(e),this.manager.itemStart(e);var i=function(t){n?n(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},s=new d.k(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(r){try{o.parse(r,a,(function(r){t(r),o.manager.itemEnd(e)}),i)}catch(e){i(e)}}),r,i)}},{key:"setDRACOLoader",value:function(e){return this.dracoLoader=e,this}},{key:"setDDSLoader",value:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}},{key:"setKTX2Loader",value:function(e){return this.ktx2Loader=e,this}},{key:"setMeshoptDecoder",value:function(e){return this.meshoptDecoder=e,this}},{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(e,t,r,n){var a,o={},i={};if("string"==typeof e)a=e;else if(d.B.decodeText(new Uint8Array(e,0,4))===k){try{o[S.KHR_BINARY_GLTF]=new N(e)}catch(e){return void(n&&n(e))}a=o[S.KHR_BINARY_GLTF].content}else a=d.B.decodeText(new Uint8Array(e));var s=JSON.parse(a);if(void 0===s.asset||s.asset.version[0]<2)n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var c=new he(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(var l=0;l<this.pluginCallbacks.length;l++){var u=this.pluginCallbacks[l](c);i[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(var p=0;p<s.extensionsUsed.length;++p){var f=s.extensionsUsed[p],m=s.extensionsRequired||[];switch(f){case S.KHR_MATERIALS_UNLIT:o[f]=new C;break;case S.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[f]=new D;break;case S.KHR_DRACO_MESH_COMPRESSION:o[f]=new B(s,this.dracoLoader);break;case S.KHR_TEXTURE_TRANSFORM:o[f]=new U;break;case S.KHR_MESH_QUANTIZATION:o[f]=new q;break;default:m.indexOf(f)>=0&&void 0===i[f]&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}c.setExtensions(o),c.setPlugins(i),c.parse(r,n)}}},{key:"parseAsync",value:function(e,t){var r=this;return new Promise((function(n,a){r.parse(e,t,n,a)}))}}]),r}(d.A);function x(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}var S={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},M=function(){function e(t){Object(y.a)(this,e),this.parser=t,this.name=S.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}return Object(b.a)(e,[{key:"_markDefs",value:function(){for(var e=this.parser,t=this.parser.json.nodes||[],r=0,n=t.length;r<n;r++){var a=t[r];a.extensions&&a.extensions[this.name]&&void 0!==a.extensions[this.name].light&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}},{key:"_loadLight",value:function(e){var t=this.parser,r="light:"+e,n=t.cache.get(r);if(n)return n;var a,o=t.json,i=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],s=new d.h(16777215);void 0!==i.color&&s.fromArray(i.color);var c=void 0!==i.range?i.range:0;switch(i.type){case"directional":(a=new d.i(s)).target.position.set(0,0,-1),a.add(a.target);break;case"point":(a=new d.R(s)).distance=c;break;case"spot":(a=new d.cb(s)).distance=c,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,a.angle=i.spot.outerConeAngle,a.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return a.position.set(0,0,0),a.decay=2,void 0!==i.intensity&&(a.intensity=i.intensity),a.name=t.createUniqueName(i.name||"light_"+e),n=Promise.resolve(a),t.cache.add(r,n),n}},{key:"createNodeAttachment",value:function(e){var t=this,r=this.parser,n=r.json.nodes[e],a=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then((function(e){return r._getNodeRef(t.cache,a,e)}))}}]),e}(),C=function(){function e(){Object(y.a)(this,e),this.name=S.KHR_MATERIALS_UNLIT}return Object(b.a)(e,[{key:"getMaterialType",value:function(){return d.G}},{key:"extendParams",value:function(e,t,r){var n=[];e.color=new d.h(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var o=a.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==a.baseColorTexture&&n.push(r.assignTexture(e,"map",a.baseColorTexture))}return Promise.all(n)}}]),e}(),L=function(){function e(t){Object(y.a)(this,e),this.parser=t,this.name=S.KHR_MATERIALS_CLEARCOAT}return Object(b.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.H:null}},{key:"extendMaterialParams",value:function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var a=[],o=n.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&a.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&a.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(a.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var i=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new d.ib(i,i)}return Promise.all(a)}}]),e}(),w=function(){function e(t){Object(y.a)(this,e),this.parser=t,this.name=S.KHR_MATERIALS_SHEEN}return Object(b.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.H:null}},{key:"extendMaterialParams",value:function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var a=[];t.sheenColor=new d.h(0,0,0),t.sheenRoughness=0,t.sheen=1;var o=n.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&a.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture)),void 0!==o.sheenRoughnessTexture&&a.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(a)}}]),e}(),I=function(){function e(t){Object(y.a)(this,e),this.parser=t,this.name=S.KHR_MATERIALS_TRANSMISSION}return Object(b.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.H:null}},{key:"extendMaterialParams",value:function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var a=[],o=n.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&a.push(r.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(a)}}]),e}(),E=function(){function e(t){Object(y.a)(this,e),this.parser=t,this.name=S.KHR_MATERIALS_VOLUME}return Object(b.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.H:null}},{key:"extendMaterialParams",value:function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var a=[],o=n.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&a.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;var i=o.attenuationColor||[1,1,1];return t.attenuationColor=new d.h(i[0],i[1],i[2]),Promise.all(a)}}]),e}(),T=function(){function e(t){Object(y.a)(this,e),this.parser=t,this.name=S.KHR_MATERIALS_IOR}return Object(b.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.H:null}},{key:"extendMaterialParams",value:function(e,t){var r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var n=r.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}}]),e}(),_=function(){function e(t){Object(y.a)(this,e),this.parser=t,this.name=S.KHR_MATERIALS_SPECULAR}return Object(b.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.H:null}},{key:"extendMaterialParams",value:function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var a=[],o=n.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&a.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));var i=o.specularColorFactor||[1,1,1];return t.specularColor=new d.h(i[0],i[1],i[2]),void 0!==o.specularColorTexture&&a.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture).then((function(e){e.encoding=d.mb}))),Promise.all(a)}}]),e}(),R=function(){function e(t){Object(y.a)(this,e),this.parser=t,this.name=S.KHR_TEXTURE_BASISU}return Object(b.a)(e,[{key:"loadTexture",value:function(e){var t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;var a=n.extensions[this.name],o=r.images[a.source],i=t.options.ktx2Loader;if(!i){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o,i)}}]),e}(),A=function(){function e(t){Object(y.a)(this,e),this.parser=t,this.name=S.EXT_TEXTURE_WEBP,this.isSupported=null}return Object(b.a)(e,[{key:"loadTexture",value:function(e){var t=this.name,r=this.parser,n=r.json,a=n.textures[e];if(!a.extensions||!a.extensions[t])return null;var o=a.extensions[t],i=n.images[o.source],s=r.textureLoader;if(i.uri){var c=r.options.manager.getHandler(i.uri);null!==c&&(s=c)}return this.detectSupport().then((function(a){if(a)return r.loadTextureImage(e,i,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}]),e}(),P=function(){function e(t){Object(y.a)(this,e),this.name=S.EXT_MESHOPT_COMPRESSION,this.parser=t}return Object(b.a)(e,[{key:"loadBufferView",value:function(e){var t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){var n=r.extensions[this.name],a=this.parser.getDependency("buffer",n.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([a,o.ready]).then((function(e){var t=n.byteOffset||0,r=n.byteLength||0,a=n.count,i=n.byteStride,s=new ArrayBuffer(a*i),c=new Uint8Array(e[0],t,r);return o.decodeGltfBuffer(new Uint8Array(s),a,i,c,n.mode,n.filter),s}))}return null}}]),e}(),k="glTF",H=1313821514,F=5130562,N=Object(b.a)((function e(t){Object(y.a)(this,e),this.name=S.KHR_BINARY_GLTF,this.content=null,this.body=null;var r=new DataView(t,0,12);if(this.header={magic:d.B.decodeText(new Uint8Array(t.slice(0,4))),version:r.getUint32(4,!0),length:r.getUint32(8,!0)},this.header.magic!==k)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=this.header.length-12,a=new DataView(t,12),o=0;o<n;){var i=a.getUint32(o,!0);o+=4;var s=a.getUint32(o,!0);if(o+=4,s===H){var c=new Uint8Array(t,12+o,i);this.content=d.B.decodeText(c)}else if(s===F){var l=12+o;this.body=t.slice(l,l+i)}o+=i}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")})),B=function(){function e(t,r){if(Object(y.a)(this,e),!r)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=S.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=r,this.dracoLoader.preload()}return Object(b.a)(e,[{key:"decodePrimitive",value:function(e,t){var r=this.json,n=this.dracoLoader,a=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,i={},s={},c={};for(var l in o){var u=ae[l]||l.toLowerCase();i[u]=o[l]}for(var p in e.attributes){var d=ae[p]||p.toLowerCase();if(void 0!==o[p]){var f=r.accessors[e.attributes[p]],m=ee[f.componentType];c[d]=m,s[d]=!0===f.normalized}}return t.getDependency("bufferView",a).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],a=s[r];void 0!==a&&(n.normalized=a)}t(e)}),i,c)}))}))}}]),e}(),U=function(){function e(){Object(y.a)(this,e),this.name=S.KHR_TEXTURE_TRANSFORM}return Object(b.a)(e,[{key:"extendTexture",value:function(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}]),e}(),G=function(e){Object(v.a)(r,e);var t=Object(j.a)(r);function r(e){var n;Object(y.a)(this,r),(n=t.call(this)).isGLTFSpecularGlossinessMaterial=!0;var a=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),o=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),c=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),l={specular:{value:(new d.h).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};return n._extraUniforms=l,n.onBeforeCompile=function(e){for(var t in l)e.uniforms[t]=l[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",a).replace("#include <metalnessmap_pars_fragment>",o).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",c)},Object.defineProperties(Object(m.a)(n),{specular:{get:function(){return l.specular.value},set:function(e){l.specular.value=e}},specularMap:{get:function(){return l.specularMap.value},set:function(e){l.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return l.glossiness.value},set:function(e){l.glossiness.value=e}},glossinessMap:{get:function(){return l.glossinessMap.value},set:function(e){l.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete n.metalness,delete n.roughness,delete n.metalnessMap,delete n.roughnessMap,n.setValues(e),n}return Object(b.a)(r,[{key:"copy",value:function(e){return Object(h.a)(Object(g.a)(r.prototype),"copy",this).call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}]),r}(d.I),D=function(){function e(){Object(y.a)(this,e),this.name=S.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}return Object(b.a)(e,[{key:"getMaterialType",value:function(){return G}},{key:"extendParams",value:function(e,t,r){var n=t.extensions[this.name];e.color=new d.h(1,1,1),e.opacity=1;var a=[];if(Array.isArray(n.diffuseFactor)){var o=n.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==n.diffuseTexture&&a.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new d.h(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new d.h(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var i=n.specularGlossinessTexture;a.push(r.assignTexture(e,"glossinessMap",i)),a.push(r.assignTexture(e,"specularMap",i))}return Promise.all(a)}},{key:"createMaterial",value:function(e){var t=new G(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=d.db,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}]),e}(),q=Object(b.a)((function e(){Object(y.a)(this,e),this.name=S.KHR_MESH_QUANTIZATION})),z=function(e){Object(v.a)(r,e);var t=Object(j.a)(r);function r(e,n,a,o){return Object(y.a)(this,r),t.call(this,e,n,a,o)}return Object(b.a)(r,[{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,a=e*n*3+n,o=0;o!==n;o++)t[o]=r[a+o];return t}}]),r}(d.q);z.prototype.beforeStart_=z.prototype.copySampleValue_,z.prototype.afterEnd_=z.prototype.copySampleValue_,z.prototype.interpolate_=function(e,t,r,n){for(var a=this.resultBuffer,o=this.sampleValues,i=this.valueSize,s=2*i,c=3*i,l=n-t,u=(r-t)/l,p=u*u,d=p*u,f=e*c,m=f-c,h=-2*d+3*p,g=d-p,y=1-h,b=g-p+u,v=0;v!==i;v++){var j=o[m+v+i],O=o[m+v+s]*l,x=o[f+v+i],S=o[f+v]*l;a[v]=y*j+b*O+h*x+g*S}return a};var V=new d.V,W=function(e){Object(v.a)(r,e);var t=Object(j.a)(r);function r(){return Object(y.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"interpolate_",value:function(e,t,n,a){var o=Object(h.a)(Object(g.a)(r.prototype),"interpolate_",this).call(this,e,t,n,a);return V.fromArray(o).normalize().toArray(o),o}}]),r}(z),K=0,J=1,Y=2,X=3,Z=4,Q=5,$=6,ee={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},te={9728:d.K,9729:d.x,9984:d.M,9985:d.z,9986:d.L,9987:d.y},re={33071:d.g,33648:d.J,10497:d.X},ne={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ae={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},oe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ie={CUBICSPLINE:void 0,LINEAR:d.s,STEP:d.r},se="OPAQUE",ce="MASK",le="BLEND";function ue(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function pe(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function de(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var a=t.extras.targetNames;if(e.morphTargetInfluences.length===a.length){e.morphTargetDictionary={};for(var o=0,i=a.length;o<i;o++)e.morphTargetDictionary[a[o]]=o}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function fe(e){for(var t="",r=Object.keys(e).sort(),n=0,a=r.length;n<a;n++)t+=r[n]+":"+e[r[n]]+";";return t}function me(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var he=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,e),this.json=t,this.extensions={},this.plugins={},this.options=r,this.cache=new x,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)?this.textureLoader=new d.n(this.options.manager):this.textureLoader=new d.fb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new d.k(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}return Object(b.a)(e,[{key:"setExtensions",value:function(e){this.extensions=e}},{key:"setPlugins",value:function(e){this.plugins=e}},{key:"parse",value:function(e,t){var r=this,n=this.json,a=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){var o={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};ue(a,o,n),pe(o,n),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(o)}))).then((function(){e(o)}))})).catch(t)}},{key:"_markDefs",value:function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n=0,a=t.length;n<a;n++)for(var o=t[n].joints,i=0,s=o.length;i<s;i++)e[o[i]].isBone=!0;for(var c=0,l=e.length;c<l;c++){var u=e[c];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(r[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}}},{key:"_addNodeRef",value:function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}},{key:"_getNodeRef",value:function(e,t,r){var n=this;if(e.refs[t]<=1)return r;var a=r.clone();return function e(t,r){var a=n.associations.get(t);null!=a&&n.associations.set(r,a);var o,i=Object(f.a)(t.children.entries());try{for(i.s();!(o=i.n()).done;){var c=Object(s.a)(o.value,2),l=c[0];e(c[1],r.children[l])}}catch(e){i.e(e)}finally{i.f()}}(r,a),a.name+="_instance_"+e.uses[t]++,a}},{key:"_invokeOne",value:function(e){var t=Object.values(this.plugins);t.push(this);for(var r=0;r<t.length;r++){var n=e(t[r]);if(n)return n}return null}},{key:"_invokeAll",value:function(e){var t=Object.values(this.plugins);t.unshift(this);for(var r=[],n=0;n<t.length;n++){var a=e(t[n]);a&&r.push(a)}return r}},{key:"getDependency",value:function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":n=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n}},{key:"getDependencies",value:function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t}},{key:"loadBuffer",value:function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[S.KHR_BINARY_GLTF].body);var n=this.options;return new Promise((function(e,a){r.load(d.B.resolveURL(t.uri,n.path),e,void 0,(function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}},{key:"loadBufferView",value:function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))}},{key:"loadAccessor",value:function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var a=[];return void 0!==n.bufferView?a.push(this.getDependency("bufferView",n.bufferView)):a.push(null),void 0!==n.sparse&&(a.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(a).then((function(e){var a,o,i=e[0],s=ne[n.type],c=ee[n.componentType],l=c.BYTES_PER_ELEMENT,u=l*s,p=n.byteOffset||0,f=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,m=!0===n.normalized;if(f&&f!==u){var h=Math.floor(p/f),g="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+h+":"+n.count,y=t.cache.get(g);y||(a=new c(i,h*f,n.count*f/l),y=new d.o(a,f/l),t.cache.add(g,y)),o=new d.p(y,s,p%f/l,m)}else a=null===i?new c(n.count*s):new c(i,p,n.count*s),o=new d.d(a,s,m);if(void 0!==n.sparse){var b=ne.SCALAR,v=ee[n.sparse.indices.componentType],j=n.sparse.indices.byteOffset||0,O=n.sparse.values.byteOffset||0,x=new v(e[1],j,n.sparse.count*b),S=new c(e[2],O,n.sparse.count*s);null!==i&&(o=new d.d(o.array.slice(),o.itemSize,o.normalized));for(var M=0,C=x.length;M<C;M++){var L=x[M];if(o.setX(L,S[M*s]),s>=2&&o.setY(L,S[M*s+1]),s>=3&&o.setZ(L,S[M*s+2]),s>=4&&o.setW(L,S[M*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse THREE.BufferAttribute.")}}return o}))}},{key:"loadTexture",value:function(e){var t=this.json,r=this.options,n=t.textures[e],a=t.images[n.source],o=this.textureLoader;if(a.uri){var i=r.manager.getHandler(a.uri);null!==i&&(o=i)}return this.loadTextureImage(e,a,o)}},{key:"loadTextureImage",value:function(e,t,r){var n=this,a=this.json,o=this.options,i=a.textures[e],s=(t.uri||t.bufferView)+":"+i.sampler;if(this.textureCache[s])return this.textureCache[s];var c=this.URL||this.webkitURL,l=t.uri||"",u=!1;if(void 0!==t.bufferView)l=n.getDependency("bufferView",t.bufferView).then((function(e){u=!0;var r=new Blob([e],{type:t.mimeType});return l=c.createObjectURL(r)}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");var p=Promise.resolve(l).then((function(e){return new Promise((function(t,n){var a=t;!0===r.isImageBitmapLoader&&(a=function(e){var r=new d.eb(e);r.needsUpdate=!0,t(r)}),r.load(d.B.resolveURL(e,o.path),a,void 0,n)}))})).then((function(t){!0===u&&c.revokeObjectURL(l),t.flipY=!1,i.name&&(t.name=i.name);var r=(a.samplers||{})[i.sampler]||{};return t.magFilter=te[r.magFilter]||d.x,t.minFilter=te[r.minFilter]||d.y,t.wrapS=re[r.wrapS]||d.X,t.wrapT=re[r.wrapT]||d.X,n.associations.set(t,{textures:e}),t})).catch((function(){return console.error("THREE.GLTFLoader: Couldn't load texture",l),null}));return this.textureCache[s]=p,p}},{key:"assignTexture",value:function(e,t,r){var n=this;return this.getDependency("texture",r.index).then((function(a){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===t&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),n.extensions[S.KHR_TEXTURE_TRANSFORM]){var o=void 0!==r.extensions?r.extensions[S.KHR_TEXTURE_TRANSFORM]:void 0;if(o){var i=n.associations.get(a);a=n.extensions[S.KHR_TEXTURE_TRANSFORM].extendTexture(a,o),n.associations.set(a,i)}}return e[t]=a,a}))}},{key:"assignFinalMaterial",value:function(e){var t=e.geometry,r=e.material,n=void 0===t.attributes.tangent,a=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){var i="PointsMaterial:"+r.uuid,s=this.cache.get(i);s||(s=new d.T,d.C.prototype.copy.call(s,r),s.color.copy(r.color),s.map=r.map,s.sizeAttenuation=!1,this.cache.add(i,s)),r=s}else if(e.isLine){var c="LineBasicMaterial:"+r.uuid,l=this.cache.get(c);l||(l=new d.u,d.C.prototype.copy.call(l,r),l.color.copy(r.color),this.cache.add(c,l)),r=l}if(n||a||o){var u="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),n&&(u+="derivative-tangents:"),a&&(u+="vertex-colors:"),o&&(u+="flat-shading:");var p=this.cache.get(u);p||(p=r.clone(),a&&(p.vertexColors=!0),o&&(p.flatShading=!0),n&&(p.normalScale&&(p.normalScale.y*=-1),p.clearcoatNormalScale&&(p.clearcoatNormalScale.y*=-1)),this.cache.add(u,p),this.associations.set(p,this.associations.get(r))),r=p}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=r}},{key:"getMaterialType",value:function(){return d.I}},{key:"loadMaterial",value:function(e){var t,r=this,n=this.json,a=this.extensions,o=n.materials[e],i={},s=o.extensions||{},c=[];if(s[S.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=a[S.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(),c.push(l.extendParams(i,o,r))}else if(s[S.KHR_MATERIALS_UNLIT]){var u=a[S.KHR_MATERIALS_UNLIT];t=u.getMaterialType(),c.push(u.extendParams(i,o,r))}else{var p=o.pbrMetallicRoughness||{};if(i.color=new d.h(1,1,1),i.opacity=1,Array.isArray(p.baseColorFactor)){var f=p.baseColorFactor;i.color.fromArray(f),i.opacity=f[3]}void 0!==p.baseColorTexture&&c.push(r.assignTexture(i,"map",p.baseColorTexture)),i.metalness=void 0!==p.metallicFactor?p.metallicFactor:1,i.roughness=void 0!==p.roughnessFactor?p.roughnessFactor:1,void 0!==p.metallicRoughnessTexture&&(c.push(r.assignTexture(i,"metalnessMap",p.metallicRoughnessTexture)),c.push(r.assignTexture(i,"roughnessMap",p.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),c.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,i)}))))}!0===o.doubleSided&&(i.side=d.j);var m=o.alphaMode||se;if(m===le?(i.transparent=!0,i.depthWrite=!1):(i.transparent=!1,m===ce&&(i.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==d.G&&(c.push(r.assignTexture(i,"normalMap",o.normalTexture)),i.normalScale=new d.ib(1,1),void 0!==o.normalTexture.scale)){var h=o.normalTexture.scale;i.normalScale.set(h,h)}return void 0!==o.occlusionTexture&&t!==d.G&&(c.push(r.assignTexture(i,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(i.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==d.G&&(i.emissive=(new d.h).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&t!==d.G&&c.push(r.assignTexture(i,"emissiveMap",o.emissiveTexture)),Promise.all(c).then((function(){var n;return n=t===G?a[S.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(i):new t(i),o.name&&(n.name=o.name),n.map&&(n.map.encoding=d.mb),n.emissiveMap&&(n.emissiveMap.encoding=d.mb),pe(n,o),r.associations.set(n,{materials:e}),o.extensions&&ue(a,n,o),n}))}},{key:"createUniqueName",value:function(e){for(var t=d.U.sanitizeNodeName(e||""),r=t,n=1;this.nodeNamesUsed[r];++n)r=t+"_"+n;return this.nodeNamesUsed[r]=!0,r}},{key:"loadGeometries",value:function(e){var t=this,r=this.extensions,n=this.primitiveCache;function a(e){return r[S.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return ye(r,e,t)}))}for(var o,i,s=[],c=0,l=e.length;c<l;c++){var u=e[c],p=(i=void 0,(i=(o=u).extensions&&o.extensions[S.KHR_DRACO_MESH_COMPRESSION])?"draco:"+i.bufferView+":"+i.indices+":"+fe(i.attributes):o.indices+":"+fe(o.attributes)+":"+o.mode),f=n[p];if(f)s.push(f.promise);else{var m=void 0;m=u.extensions&&u.extensions[S.KHR_DRACO_MESH_COMPRESSION]?a(u):ye(new d.e,u,t),n[p]={primitive:u,promise:m},s.push(m)}}return Promise.all(s)}},{key:"loadMesh",value:function(e){for(var t,r=this,n=this.json,a=this.extensions,o=n.meshes[e],i=o.primitives,s=[],c=0,l=i.length;c<l;c++){var u=void 0===i[c].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new d.I({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.l})),t.DefaultMaterial):this.getDependency("material",i[c].material);s.push(u)}return s.push(r.loadGeometries(i)),Promise.all(s).then((function(t){for(var n=t.slice(0,t.length-1),s=t[t.length-1],c=[],l=0,u=s.length;l<u;l++){var p=s[l],f=i[l],m=void 0,h=n[l];if(f.mode===Z||f.mode===Q||f.mode===$||void 0===f.mode)!0!==(m=!0===o.isSkinnedMesh?new d.ab(p,h):new d.F(p,h)).isSkinnedMesh||m.geometry.attributes.skinWeight.normalized||m.normalizeSkinWeights(),f.mode===Q?m.geometry=be(m.geometry,d.hb):f.mode===$&&(m.geometry=be(m.geometry,d.gb));else if(f.mode===J)m=new d.w(p,h);else if(f.mode===X)m=new d.t(p,h);else if(f.mode===Y)m=new d.v(p,h);else{if(f.mode!==K)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);m=new d.S(p,h)}Object.keys(m.geometry.morphAttributes).length>0&&de(m,o),m.name=r.createUniqueName(o.name||"mesh_"+e),pe(m,o),f.extensions&&ue(a,m,f),r.assignFinalMaterial(m),c.push(m)}for(var g=0,y=c.length;g<y;g++)r.associations.set(c[g],{meshes:e,primitives:g});if(1===c.length)return c[0];var b=new d.m;r.associations.set(b,{meshes:e});for(var v=0,j=c.length;v<j;v++)b.add(c[v]);return b}))}},{key:"loadCamera",value:function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new d.Q(d.D.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new d.P(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),pe(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}},{key:"loadSkin",value:function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))}},{key:"loadAnimation",value:function(e){for(var t=this.json.animations[e],r=[],n=[],a=[],o=[],i=[],s=0,c=t.channels.length;s<c;s++){var l=t.channels[s],u=t.samplers[l.sampler],p=l.target,f=void 0!==p.node?p.node:p.id,m=void 0!==t.parameters?t.parameters[u.input]:u.input,h=void 0!==t.parameters?t.parameters[u.output]:u.output;r.push(this.getDependency("node",f)),n.push(this.getDependency("accessor",m)),a.push(this.getDependency("accessor",h)),o.push(u),i.push(p)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(a),Promise.all(o),Promise.all(i)]).then((function(r){for(var n=r[0],a=r[1],o=r[2],i=r[3],s=r[4],c=[],l=function(e,t){var r=n[e],l=a[e],u=o[e],p=i[e],f=s[e];if(void 0===r)return"continue";r.updateMatrix(),r.matrixAutoUpdate=!0;var m=void 0;switch(oe[f.path]){case oe.weights:m=d.N;break;case oe.rotation:m=d.W;break;case oe.position:case oe.scale:default:m=d.kb}var h=r.name?r.name:r.uuid,g=void 0!==p.interpolation?ie[p.interpolation]:d.s,y=[];oe[f.path]===oe.weights?r.traverse((function(e){e.morphTargetInfluences&&y.push(e.name?e.name:e.uuid)})):y.push(h);var b=u.array;if(u.normalized){for(var v=me(b.constructor),j=new Float32Array(b.length),O=0,x=b.length;O<x;O++)j[O]=b[O]*v;b=j}for(var S=0,M=y.length;S<M;S++){var C=new m(y[S]+"."+oe[f.path],l.array,b,g);"CUBICSPLINE"===p.interpolation&&(C.createInterpolant=function(e){return new(this instanceof d.W?W:z)(this.times,this.values,this.getValueSize()/3,e)},C.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(C)}},u=0,p=n.length;u<p;u++)l(u);var f=t.name?t.name:"animation_"+e;return new d.a(f,void 0,c)}))}},{key:"createNodeMesh",value:function(e){var t=this.json,r=this,n=t.nodes[e];return void 0===n.mesh?null:r.getDependency("mesh",n.mesh).then((function(e){var t=r._getNodeRef(r.meshCache,n.mesh,e);return void 0!==n.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=n.weights.length;t<r;t++)e.morphTargetInfluences[t]=n.weights[t]})),t}))}},{key:"loadNode",value:function(e){var t,r,n=this.json,a=this.extensions,o=this,i=n.nodes[e],s=i.name?o.createUniqueName(i.name):"";return(t=[],r=o._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)})),r&&t.push(r),void 0!==i.camera&&t.push(o.getDependency("camera",i.camera).then((function(e){return o._getNodeRef(o.cameraCache,i.camera,e)}))),o._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)).then((function(t){var r;if((r=!0===i.isBone?new d.b:t.length>1?new d.m:1===t.length?t[0]:new d.O)!==t[0])for(var n=0,c=t.length;n<c;n++)r.add(t[n]);if(i.name&&(r.userData.name=i.name,r.name=s),pe(r,i),i.extensions&&ue(a,r,i),void 0!==i.matrix){var l=new d.E;l.fromArray(i.matrix),r.applyMatrix4(l)}else void 0!==i.translation&&r.position.fromArray(i.translation),void 0!==i.rotation&&r.quaternion.fromArray(i.rotation),void 0!==i.scale&&r.scale.fromArray(i.scale);return o.associations.has(r)||o.associations.set(r,{}),o.associations.get(r).nodes=e,r}))}},{key:"loadScene",value:function(e){var t=this.json,r=this.extensions,n=this.json.scenes[e],a=this,o=new d.m;n.name&&(o.name=a.createUniqueName(n.name)),pe(o,n),n.extensions&&ue(r,o,n);for(var i=n.nodes||[],c=[],l=0,u=i.length;l<u;l++)c.push(ge(i[l],o,t,a));return Promise.all(c).then((function(){return a.associations=function(e){var t,r=new Map,n=Object(f.a)(a.associations);try{for(n.s();!(t=n.n()).done;){var o=Object(s.a)(t.value,2),i=o[0],c=o[1];(i instanceof d.C||i instanceof d.eb)&&r.set(i,c)}}catch(e){n.e(e)}finally{n.f()}return e.traverse((function(e){var t=a.associations.get(e);null!=t&&r.set(e,t)})),r}(o),o}))}}]),e}();function ge(e,t,r,n){var a=r.nodes[e];return n.getDependency("node",e).then((function(e){return void 0===a.skin?e:n.getDependency("skin",a.skin).then((function(e){for(var r=[],a=0,o=(t=e).joints.length;a<o;a++)r.push(n.getDependency("node",t.joints[a]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(e.isMesh){for(var n=[],a=[],o=0,i=r.length;o<i;o++){var s=r[o];if(s){n.push(s);var c=new d.E;void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*o),a.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}e.bind(new d.Z(n,a),e.matrixWorld)}})),e}));var t})).then((function(e){t.add(e);var o=[];if(a.children)for(var i=a.children,s=0,c=i.length;s<c;s++){var l=i[s];o.push(ge(l,e,r,n))}return Promise.all(o)}))}function ye(e,t,r){var n=t.attributes,a=[];function o(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(var i in n){var s=ae[i]||i.toLowerCase();s in e.attributes||a.push(o(n[i],s))}if(void 0!==t.indices&&!e.index){var c=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));a.push(c)}return pe(e,t),function(e,t,r){var n=t.attributes,a=new d.c;if(void 0!==n.POSITION){var o=r.json.accessors[n.POSITION],i=o.min,s=o.max;if(void 0!==i&&void 0!==s){if(a.set(new d.jb(i[0],i[1],i[2]),new d.jb(s[0],s[1],s[2])),o.normalized){var c=me(ee[o.componentType]);a.min.multiplyScalar(c),a.max.multiplyScalar(c)}var l=t.targets;if(void 0!==l){for(var u=new d.jb,p=new d.jb,f=0,m=l.length;f<m;f++){var h=l[f];if(void 0!==h.POSITION){var g=r.json.accessors[h.POSITION],y=g.min,b=g.max;if(void 0!==y&&void 0!==b){if(p.setX(Math.max(Math.abs(y[0]),Math.abs(b[0]))),p.setY(Math.max(Math.abs(y[1]),Math.abs(b[1]))),p.setZ(Math.max(Math.abs(y[2]),Math.abs(b[2]))),g.normalized){var v=me(ee[g.componentType]);p.multiplyScalar(v)}u.max(p)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}a.expandByVector(u)}e.boundingBox=a;var j=new d.bb;a.getCenter(j.center),j.radius=a.min.distanceTo(a.max)/2,e.boundingSphere=j}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,r),Promise.all(a).then((function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,a=!1,o=0,i=t.length;o<i;o++){var s=t[o];if(void 0!==s.POSITION&&(n=!0),void 0!==s.NORMAL&&(a=!0),n&&a)break}if(!n&&!a)return Promise.resolve(e);for(var c=[],l=[],u=0,p=t.length;u<p;u++){var d=t[u];if(n){var f=void 0!==d.POSITION?r.getDependency("accessor",d.POSITION):e.attributes.position;c.push(f)}if(a){var m=void 0!==d.NORMAL?r.getDependency("accessor",d.NORMAL):e.attributes.normal;l.push(m)}}return Promise.all([Promise.all(c),Promise.all(l)]).then((function(t){var r=t[0],o=t[1];return n&&(e.morphAttributes.position=r),a&&(e.morphAttributes.normal=o),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}function be(e,t){var r=e.getIndex();if(null===r){var n=[],a=e.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var o=0;o<a.count;o++)n.push(o);e.setIndex(n),r=e.getIndex()}var i=r.count-2,s=[];if(t===d.gb)for(var c=1;c<=i;c++)s.push(r.getX(0)),s.push(r.getX(c)),s.push(r.getX(c+1));else for(var l=0;l<i;l++)l%2==0?(s.push(r.getX(l)),s.push(r.getX(l+1)),s.push(r.getX(l+2))):(s.push(r.getX(l+2)),s.push(r.getX(l+1)),s.push(r.getX(l)));s.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var u=e.clone();return u.setIndex(s),u}var ve=O,je=r(1),Oe=function(e){var t=Object(a.useContext)(c.b),r=Object(a.useState)(!0),n=Object(s.a)(r,2),o=n[0],i=n[1],u=Object(a.useRef)(!0),f=Object(a.useRef)(!1),m=Object(a.useRef)(null),h=Object(a.useRef)(e.init),g=function(){m.current&&m.current.style&&(m.current.getLayer("3d-model")&&m.current.removeLayer("3d-model"),m.current=null)};return Object(a.useEffect)((function(){return"function"==typeof h.current&&h.current(),g}),[]),Object(a.useEffect)((function(){if(t.mapExists(e.mapId)&&!f.current){f.current=!0,m.current=t.getMap(e.mapId),m.current.setCenter([7.099771581806502,50.73395746209983]),m.current.setZoom(15),m.current.setPitch(45);var r=[Math.PI/2,90,0],n=p.a.MercatorCoordinate.fromLngLat([7.099771581806502,50.73395746209983],0),a={translateX:n.x+8e-7,translateY:n.y+18e-7,translateZ:n.z,rotateX:r[0],rotateY:r[1],rotateZ:r[2],scale:n.meterInMercatorCoordinateUnits()+3e-8},o={id:"3d-model",type:"custom",renderingMode:"3d",onAdd:function(t,r){this.camera=new d.f,this.scene=new d.Y;var n=new d.i(16777215);n.position.set(0,-70,100).normalize(),this.scene.add(n);var a=new d.i(16777215);a.position.set(0,70,100).normalize(),this.scene.add(a),(new ve).load("assets/3D/godzilla_simple.glb",function(t){this.scene.add(t.scene),"function"==typeof e.onDone&&e.onDone()}.bind(this)),this.map=t,this.renderer=new d.lb({canvas:t.getCanvas(),context:r,antialias:!0}),this.renderer.autoClear=!1},render:function(e,t){var r=(new d.E).makeRotationAxis(new d.jb(1,0,0),a.rotateX),n=(new d.E).makeRotationAxis(new d.jb(0,1,0),a.rotateY),o=(new d.E).makeRotationAxis(new d.jb(0,0,1),a.rotateZ),i=(new d.E).fromArray(t),s=(new d.E).makeTranslation(a.translateX,a.translateY,a.translateZ).scale(new d.jb(a.scale,-a.scale,a.scale)).multiply(r).multiply(n).multiply(o);this.camera.projectionMatrix=i.multiply(s),this.renderer.resetState(),this.renderer.render(this.scene,this.camera),this.map.triggerRepaint()}};m.current.addLayer(o),m.current.getLayer("3d-model")&&m.current.setLayoutProperty("3d-model","visibility","visible")}}),[t.mapIds,t,e]),Object(a.useEffect)((function(){m.current&&m.current.getLayer("3d-model")&&(o?m.current.setLayoutProperty("3d-model","visibility","visible"):m.current.setLayoutProperty("3d-model","visibility","none"))}),[o,t]),Object(je.jsx)(je.Fragment,{children:Object(je.jsx)(l.a,{color:"primary",variant:o?"contained":"outlined",onClick:function(){i(!o),u.current=!o},children:"3D"})})};Oe.__docgenInfo={description:"Renders obj or gltf 3D Models on the MapLibreMap referenced by props.mapId\n\n@component",methods:[],displayName:"MlThreeJsLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},init:{type:{name:"func"},required:!1,description:"function that gets called when initialized"},onDone:{type:{name:"func"},required:!1,description:"function that gets called when models are loaded"}}};var xe=Oe;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlThreeJsLayer/MlThreeJsLayer.js"]={name:"MlThreeJsLayer",docgenInfo:Oe.__docgenInfo,path:"src/components/MlThreeJsLayer/MlThreeJsLayer.js"});var Se=r(40),Me=o.a.createContext({}),Ce=Me.Provider,Le=function(e){var t=e.children,r=Object(a.useContext)(c.b),n=Object(a.useState)(!1),o=Object(s.a)(n,2),i=o[0],l=o[1],u=Object(a.useState)(!1),p=Object(s.a)(u,2),d=p[0],f=p[1],m=Object(a.useState)(!0),h=Object(s.a)(m,2),g=h[0],y=h[1],b=Object(a.useState)(!1),v=Object(s.a)(b,2),j=v[0],O=v[1],x=Object(a.useRef)({}),S=Object(a.useState)(0),M=Object(s.a)(S,2),C=M[0],L=M[1],w=function(e){return function(){x.current[e]=!0,L(Math.random())}},I=function(){setTimeout((function(){O(!0),setTimeout((function(){y(!1)}),1700)}),900)};Object(a.useEffect)((function(){if(r.map&&!i){for(var e in x.current)if(!x.current[e])return;I()}}),[C,i,r]),Object(a.useEffect)((function(){for(var e=0,t=r.mapIds.length;e<t;e++)if(-1===Object.keys(x.current).indexOf(r.mapIds[e])){var n=r.mapIds[e]+"";r.getMap(n)&&(x.current[n]=!1,r.getMap(n).on("idle",w(n)))}}),[r,r.mapIds]),Object(a.useEffect)((function(){d&&I()}),[d]);var E={setControlled:l,controlled:i,visible:g,fadeoutAnimation:j,setLoadingDone:f};return Object(je.jsx)(Ce,{value:E,children:t})};Le.__docgenInfo={description:"",methods:[],displayName:"LoadingOverlayProvider",props:{children:{type:{name:"node"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/LoadingOverlayContext.js"]={name:"LoadingOverlayProvider",docgenInfo:Le.__docgenInfo,path:"src/ui_components/LoadingOverlayContext.js"});var we={title:"MapComponents/MlThreeJsLayer",component:xe,argTypes:{options:{control:{type:"object"}}},decorators:Se.a},Ie=(t.default=we,function(e){var t=Object(a.useContext)(Me);return Object(je.jsx)(i.a,{children:Object(je.jsx)(xe,{init:function(){var e;return null==t||null===(e=t.setControlled)||void 0===e?void 0:e.call(t,!0)},onDone:function(){return setTimeout((function(){var e;return null==t||null===(e=t.setLoadingDone)||void 0===e?void 0:e.call(t,!0)}),1200)}})})}.bind({}));Ie.parameters={},Ie.parameters=Object(n.a)({storySource:{source:"(args) => {\n  const loadingOverlayContext = useContext(LoadingOverlayContext);\n\n  return (\n    <TopToolbar>\n      <MlThreeJsLayer\n        init={() => loadingOverlayContext?.setControlled?.(true)}\n        onDone={() =>\n          setTimeout(() => loadingOverlayContext?.setLoadingDone?.(true), 1200)\n        }\n      />\n    </TopToolbar>\n  );\n}"}},Ie.parameters)},1137:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return A}));var n=r(5),a=r(15),o=r(0),i=r(56),s=r(34),c=r(96),l=r(93),u=r(271),p=r(185),d=r(664),f=r.n(d);function m(e){var t=Object(o.useState)(void 0),r=Object(a.a)(t,2),i=r[0],s=r[1],c=Object(o.useState)(e.url),l=Object(a.a)(c,2),u=l[0],p=l[1],d=Object(o.useState)(""),m=Object(a.a)(d,2),h=m[0],g=m[1],y=Object(o.useState)(void 0),b=Object(a.a)(y,2),v=b[0],j=b[1],O=Object(o.useState)(void 0),x=Object(a.a)(O,2),S=x[0],M=x[1],C=function(){s(void 0),j(void 0),g("")};return Object(o.useEffect)((function(){var t;if(C(),M(void 0),u){var r,a=u;-1!==u.indexOf("?")&&(a=(r=u.split("?"))[0]);var o=new URLSearchParams(null===(t=r)||void 0===t?void 0:t[1]),i=Object(n.a)(Object(n.a)({},Object.fromEntries(o)),e.urlParameters),s=new URLSearchParams(i),c=decodeURIComponent(s.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");fetch(a+"?"+c).then((function(e){if(e.ok)return e.text();throw Error(e.statusText+" ("+e.status+" - "+e.type+")")})).then((function(e){j(new f.a(e).toJSON())})).catch((function(e){C(),console.log(e),M(e.message)}))}}),[u,e.urlParameters]),Object(o.useEffect)((function(){var e,t,r,n,a,o,i,c,l,u,p,d,f,m;null!=v&&v.Service&&(g(null===(e=v.Capability)||void 0===e||null===(t=e.Request)||void 0===t||null===(r=t.GetMap)||void 0===r||null===(n=r.DCPType)||void 0===n||null===(a=n[0])||void 0===a||null===(o=a.HTTP)||void 0===o||null===(i=o.Get)||void 0===i?void 0:i.OnlineResource),s(null===(c=v.Capability)||void 0===c||null===(l=c.Request)||void 0===l||null===(u=l.GetFeatureInfo)||void 0===u||null===(p=u.DCPType)||void 0===p||null===(d=p[0])||void 0===d||null===(f=d.HTTP)||void 0===f||null===(m=f.Get)||void 0===m?void 0:m.OnlineResource))}),[v]),{capabilities:v,getFeatureInfoUrl:i,wmsUrl:h,error:S,setUrl:p}}m.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"getCapabilities"}};var h=m,g=r(346),y=r.n(g),b=r(347),v=r.n(b),j=r(1160),O=r(1158),x=r(1161),S=r(278),M=r(1),C=2*Math.PI*6378137/2,L=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1},n=e.lng,a=e.lat,o=n*C/180,i=Math.log(Math.tan((90+a)*Math.PI/360))/(Math.PI/180);return i=i*C/180,r.enable&&(o=Number(o.toFixed(r.decimal)),i=Number(i.toFixed(r.decimal))),[o,i]},w=function(e){var t,r,d,f,m,g,b=Object(o.useContext)(s.b),C=h({url:void 0,urlParameters:e.urlParameters}),w=C.capabilities,I=C.error,E=C.setUrl,T=C.getFeatureInfoUrl,_=C.wmsUrl,R=Object(o.useRef)(!1),A=Object(o.useRef)(void 0),P=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlWmsLoader-")+Object(c.a)()),k=Object(o.useState)([]),H=Object(a.a)(k,2),F=H[0],N=H[1],B=Object(o.useState)(void 0),U=Object(a.a)(B,2),G=U[0],D=U[1],q=Object(o.useState)(void 0),z=Object(a.a)(q,2),V=z[0],W=z[1];Object(o.useEffect)((function(){var e=P.current;return function(){A.current&&(A.current.cleanup(e),A.current=void 0),R.current=!1}}),[]),Object(o.useEffect)((function(){R.current&&E(e.url)}),[e.url]);var K=Object(o.useCallback)((function(t){var r,a,o,i,s;D(void 0),W(void 0);var c,l=A.current.getBounds(),u=L(l._sw),p=L(l._ne),d={REQUEST:"GetFeatureInfo",BBOX:[u[0],u[1],p[0],p[1]].join(","),SERVICE:"WMS",INFO_FORMAT:-1!==(null==w||null===(r=w.Capability)||void 0===r||null===(a=r.Request)||void 0===a?void 0:a.GetFeatureInfo.Format.indexOf("text/html"))?"text/html":"text/plain",FEATURE_COUNT:"10",LAYERS:F.map((function(e,t){return e.visible&&e.queryable?e.Name:void 0})).filter((function(e){return e})),QUERY_LAYERS:F.map((function(e,t){return e.visible&&e.queryable?e.Name:void 0})).filter((function(e){return e})),WIDTH:A.current._container.clientWidth,HEIGHT:A.current._container.clientHeight,srs:"EPSG:3857",CRS:"EPSG:3857",version:"1.3.0",X:t.point.x,Y:t.point.y,I:t.point.x,J:t.point.y,buffer:"50"},f=T;-1!==(null===(o=f)||void 0===o||null===(i=o.indexOf)||void 0===i?void 0:i.call(o,"?"))&&(f=(c=e.url.split("?"))[0]);var m=new URLSearchParams(null===(s=c)||void 0===s?void 0:s[1]),h=Object(n.a)(Object(n.a)({},Object.fromEntries(m)),d),g=new URLSearchParams(h);fetch(e.url+"?"+g.toString()).then((function(e){if(!e.ok)throw new Error("FeatureInfo could not be fetched");return e.text()})).then((function(e){D(t.lngLat),W(e)})).catch((function(e){return console.log(e)}))}),[w,T]);return Object(o.useEffect)((function(){if(A.current){var e=K;return A.current.on("click",e,P.current),function(){var t,r;null===(t=A.current)||void 0===t||null===(r=t.off)||void 0===r||r.call(t,"click",e)}}}),[T]),Object(o.useEffect)((function(){var e,t,r,n,a,o,i,s;null!=w&&w.Service&&(-1===(null==w||null===(e=w.Capability)||void 0===e||null===(t=e.Layer)||void 0===t||null===(r=t.SRS)||void 0===r||null===(n=r.indexOf)||void 0===n?void 0:n.call(r,"EPSG:3857"))?console.log("MlWmsLoader ("+w.Service.Title+"): No WGS 84/Pseudo-Mercator support"):(console.log("MlWmsLoader ("+w.Service.Title+"): WGS 84/Pseudo-Mercator supported"),N(null==w||null===(a=w.Capability)||void 0===a||null===(o=a.Layer)||void 0===o?void 0:o.Layer.map((function(e,t){var r,n,a;return 0===t&&((s=e.LatLonBoundingBox)||(s=e.EX_GeographicBoundingBox)),e.visible=!((null==w||null===(r=w.Capability)||void 0===r||null===(n=r.Layer)||void 0===n||null===(a=n.Layer)||void 0===a?void 0:a.length)>2)||t>1,e}))),A.current&&(null===(i=s)||void 0===i?void 0:i.length)>3&&A.current.fitBounds([[s[0],s[1]],[s[2],s[3]]])))}),[w]),Object(o.useEffect)((function(){var t;null!=b&&null!==(t=b.mapExists)&&void 0!==t&&t.call(b,e.mapId)&&!R.current&&(R.current=!0,A.current=b.getMap(e.mapId),console.log("set url "+e.url),E(e.url))}),[b.mapIds,b,e.mapId,e.url]),Object(M.jsxs)(M.Fragment,{children:[I&&Object(M.jsx)("p",{children:I}),Object(M.jsx)("h3",{children:null==w||null===(t=w.Service)||void 0===t?void 0:t.Title},"title"),console.log(P.current),null==w||null===(r=w.Capability)||void 0===r||null===(d=r.Layer)||void 0===d?void 0:d.Layer.map((function(e,t){return Object(M.jsx)(p.a,Object(n.a)({layerId:"Order-"+P.current+"-"+t},t>0?{insertBeforeLayer:"Order-"+P.current+"-"+(t-1)}:void 0),P.current+"-"+t)})),Object(M.jsx)(j.a,{dense:!0,children:_&&(null==F||null===(f=F.map)||void 0===f?void 0:f.call(F,(function(t,r){return null!=t&&t.Name?Object(M.jsxs)(O.a,{secondaryAction:Object(M.jsx)(S.a,{edge:"end","aria-label":"toggle visibility",onClick:function(){var e=Object(i.a)(F);e[r].visible=!e[r].visible,N(Object(i.a)(e))},children:F[r].visible?Object(M.jsx)(y.a,{}):Object(M.jsx)(v.a,{})}),children:[Object(M.jsx)(x.a,{primary:null==t?void 0:t.Title,secondary:null==t?void 0:t.Abstract}),Object(M.jsx)(l.a,{url:_,urlParameters:Object(n.a)(Object(n.a)({},e.wmsUrlParameters),{},{layers:null==t?void 0:t.Name}),visible:F[r].visible,insertBeforeLayer:"Order-"+P.current+"-"+r},(null==t?void 0:t.Name)+r)]},t.Name+r):Object(M.jsx)(M.Fragment,{})})))},"layers"),Object(M.jsx)("p",{style:{fontSize:".7em"},children:null==w||null===(m=w.Capability)||void 0===m||null===(g=m.Layer)||void 0===g?void 0:g.Abstract},"description"),G&&Object(M.jsx)(u.a,Object(n.a)(Object(n.a)({},G),{},{content:V}))]})};w.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"getCapabilities"},wmsUrlParameters:{TRANSPARENT:"TRUE"}},w.__docgenInfo={description:"Loads a WMS getCapabilities xml document and adds a MlWmsLayer component for each layer that is\noffered by the WMS.\n\nTODO: EaseTo the extend offered by the WMS in a zoom level that is supported\n\n@component",methods:[],displayName:"MlWmsLoader",props:{url:{defaultValue:{value:'""',computed:!1},type:{name:"string"},required:!1,description:"WMS URL"},urlParameters:{defaultValue:{value:'{\n  SERVICE: "WMS",\n  VERSION: "1.3.0",\n  REQUEST: "getCapabilities",\n}',computed:!1},type:{name:"object"},required:!1,description:"URL parameters that will be used in the getCapabilities request"},wmsUrlParameters:{defaultValue:{value:'{\n  TRANSPARENT: "TRUE",\n}',computed:!1},type:{name:"object"},required:!1,description:"URL parameters that will be added when requesting WMS capabilities"},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},layerUrlParameters:{type:{name:"object"},required:!1,description:"URL parameters that will be added when requesting tiles"}}};var I=w;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlWmsLoader/MlWmsLoader.js"]={name:"MlWmsLoader",docgenInfo:w.__docgenInfo,path:"src/components/MlWmsLoader/MlWmsLoader.js"});var E=r(1226),T=r(40),_=r(345),R={title:"MapComponents/MlWmsLoader",component:I,argTypes:{url:{},layer:{}},decorators:T.a},A=(t.default=R,function(e){var t=Object(o.useState)(e.url),r=Object(a.a)(t,2),i=r[0],s=r[1];return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(_.a,{sx:{wordBreak:"break-word"},children:[Object(M.jsx)(E.a,{label:"WMS Url",variant:"standard",value:i,onChange:function(e){return s(e.target.value)}}),Object(M.jsx)(I,Object(n.a)(Object(n.a)({},e),{},{url:i}))]})})}.bind({}));A.parameters={},A.args={url:"https://www.wms.nrw.de/wms/kitas"},A.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const [url, setUrl] = useState(props.url);\n\n  return (\n    <>\n      <Sidebar sx={{ wordBreak: "break-word" }}>\n        <TextField\n          label="WMS Url"\n          variant="standard"\n          value={url}\n          onChange={(ev) => setUrl(ev.target.value)}\n        />\n        <MlWmsLoader {...props} url={url} />\n      </Sidebar>\n    </>\n  );\n}'}},A.parameters)},1142:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"parameters",(function(){return i}));var a=r(1232),o=r(12),i=(r(0),r(34),r(124),r(1042),{docs:{inlineStories:!1},actions:{argTypesRegex:"^on[A-Z].*"}});function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.keys(n).forEach((function(e){var t=n[e];switch(e){case"args":case"argTypes":return o.a.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(t));case"decorators":return t.forEach((function(e){return Object(a.d)(e,!1)}));case"loaders":return t.forEach((function(e){return Object(a.e)(e,!1)}));case"parameters":return Object(a.f)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t),!1);case"argTypesEnhancers":return t.forEach((function(e){return Object(a.b)(e)}));case"argsEnhancers":return t.forEach((function(e){return Object(a.c)(e)}));case"render":return Object(a.g)(t);case"globals":case"globalTypes":var r={};return r[e]=t,Object(a.f)(r,!1);case"decorateStory":case"renderToDOM":return null;default:return console.log(e+" was not supported :( !")}}))},1143:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return l}));var n=r(5),a=(r(0),r(257)),o=r(40),i=r.p+"static/media/wg-marker.bf3eeb2d.png",s=r(1),c={title:"MapComponents/MlImageMarkerLayer",component:a.a,argTypes:{url:{},layer:{}},decorators:o.a},l=(t.default=c,function(e){return Object(s.jsx)(a.a,{options:{type:"symbol",source:{type:"geojson",data:{type:"Feature",properties:{id:"test"},geometry:{type:"Point",coordinates:[7.0847929969609424,50.73855193187643]}}},layout:{"icon-allow-overlap":!0,"icon-size":.14,"icon-offset":[0,-180]}},imgSrc:i})}.bind({}));l.parameters={},l.args={},l.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <MlImageMarkerLayer\n    options={{\n      type: "symbol",\n      source: {\n        type: "geojson",\n        data: {\n          type: "Feature",\n          properties: {\n            id: "test",\n          },\n          geometry: {\n            type: "Point",\n            coordinates: [7.0847929969609424, 50.73855193187643],\n          },\n        },\n      },\n      layout: {\n        "icon-allow-overlap": true,\n        "icon-size": 0.14,\n        "icon-offset": [0, -180],\n      },\n    }}\n    imgSrc={wgMarker}\n  />\n)'}},l.parameters)},1144:function(e,t,r){"use strict";r.r(t),r.d(t,"Toolbar",(function(){return g})),r.d(t,"Overlay",(function(){return y}));var n=r(5),a=r(0),o=r(15),i=r(34),s=r(96),c=r(1),l=function(e){var t=Object(a.useContext)(i.b),r=Object(a.useRef)(void 0),n=Object(a.useRef)(!1),l=Object(a.useRef)(0),u=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlScaleReference-")+Object(s.a)()),p=Object(a.useState)(0),d=Object(o.a)(p,2),f=d[0],m=d[1],h=Object(a.useState)(""),g=Object(o.a)(h,2),y=g[0],b=g[1];Object(a.useEffect)((function(){var e=u.current;return function(){r.current&&(r.current.cleanup(e),r.current=void 0)}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!n.current&&(n.current=!0,r.current=t.getMap(e.mapId),r.current.on("move",v.current,u.current),v.current())}),[t.mapIds,t,e.mapId]);var v=Object(a.useRef)((function(){if(r.current.map.getZoom()!==l.current){l.current=r.current.map.getZoom();var t=e.maxWidth||100,n=r.current._container.clientHeight/2,a=r.current.unproject([0,n]),o=r.current.unproject([t,n]),i=a.distanceTo(o);if("imperial"===e.unit){var s=3.2808*i;if(s>5280)j(t,s/5280,r.current._getUIString("ScaleControl.Miles"));else j(t,s,r.current._getUIString("ScaleControl.Feet"))}else if("nautical"===e.unit){j(t,i/1852,r.current._getUIString("ScaleControl.NauticalMiles"))}else i>=1e3?j(t,i/1e3,r.current._getUIString("ScaleControl.Kilometers")):j(t,i,r.current._getUIString("ScaleControl.Meters"))}})),j=function(e,t,r){var n=O(t);m(e*(n/t)),b(n+"&nbsp;"+r)},O=function(e){var t=Math.pow(10,"".concat(Math.floor(e)).length-1),r=e/t;return t*(r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r))};return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("div",{style:{backgroundColor:"hsla(0,0%,100%,.75)",fontSize:"10px",border:"2px solid #333",borderTop:"#333",padding:"0 5px",color:"#333",boxSizing:"border-box",width:f+"px",fontFamily:"sans-serif"},dangerouslySetInnerHTML:{__html:y}})})};l.__docgenInfo={description:"",methods:[],displayName:"MlScaleReference"};var u=l;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlScaleReference/MlScaleReference.js"]={name:"MlScaleReference",docgenInfo:l.__docgenInfo,path:"src/components/MlScaleReference/MlScaleReference.js"});var p=r(92),d=r(40),f=r(353),m={title:"MapComponents/MlScaleReference",component:u,argTypes:{url:{},layer:{}},decorators:d.a},h=(t.default=m,function(e){var t=Object(f.a)("(max-width:900px)");return Object(c.jsxs)(c.Fragment,{children:["toolbar"===e.show&&Object(c.jsx)(p.a,{children:Object(c.jsx)(u,Object(n.a)({},e))}),"overlay"===e.show&&Object(c.jsx)("div",{style:{position:"absolute",zIndex:1e5,bottom:t?"40px":"20px",right:"20px"},children:Object(c.jsx)(u,Object(n.a)({},e))})]})}),g=h.bind({});g.args={show:"toolbar"};var y=h.bind({});y.args={show:"overlay"},g.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mediaIsMobile = useMediaQuery("(max-width:900px)");\n  return(\n    <>\n      {props.show === "toolbar" && (\n        <TopToolbar>\n          <MlScaleReference {...props} />\n        </TopToolbar>\n      )}\n      {props.show === "overlay" && (\n        <div\n          style={{\n            position: "absolute",\n            zIndex: 100000,\n            bottom: mediaIsMobile ? "40px" : "20px",\n            right: "20px",\n          }}\n        >\n          <MlScaleReference {...props} />\n        </div>\n      )}\n    </>\n  );\n}'}},g.parameters),y.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mediaIsMobile = useMediaQuery("(max-width:900px)");\n  return(\n    <>\n      {props.show === "toolbar" && (\n        <TopToolbar>\n          <MlScaleReference {...props} />\n        </TopToolbar>\n      )}\n      {props.show === "overlay" && (\n        <div\n          style={{\n            position: "absolute",\n            zIndex: 100000,\n            bottom: mediaIsMobile ? "40px" : "20px",\n            right: "20px",\n          }}\n        >\n          <MlScaleReference {...props} />\n        </div>\n      )}\n    </>\n  );\n}'}},y.parameters)},1145:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return H}));var n=r(5),a=r(15),o=r(0),i=r(3),s=r.n(i),c=r(34),l=r(96),u=r(64),p=r(1),d=function(){var e=Object.fromEntries(new URLSearchParams(window.location.search));return e.layers=JSON.parse(null!=e&&e.layers?e.layers:"[]"),e},f=d(),m=function(e){var t=Object(o.useContext)(c.b),r=Object(o.useRef)(!1),i=Object(o.useRef)(void 0),s=Object(o.useState)(void 0),m=Object(a.a)(s,2),h=m[0],g=m[1],y=Object(o.useRef)({}),b=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlShareMapState-")+Object(l.a)()),v=Object(u.a)({watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}}),j=Object(o.useRef)(!1),O=Object(o.useRef)(void 0),x=Object(o.useRef)({viewport:{center:!1,bearing:!1,pitch:!1,zoom:!1},layers:Object(n.a)({},y)}),S=Object(o.useRef)({}),M=Object(o.useCallback)((function(){if(e.active){var t=[];for(var r in v.layers)t.push({id:v.layers[r].id,type:v.layers[r].type,visible:v.layers[r].visible});C();var a=new URLSearchParams(Object(n.a)(Object(n.a)(Object(n.a)({},d()),S.current),{},{layers:JSON.stringify(t)}));JSON.parse(Object.fromEntries(a).layers).forEach((function(e){y.current[e.id]=!1}));var o=new URLSearchParams(window.location.search);L(v.layers),a.toString()!==o.toString()&&window.history.pushState(Object(n.a)({},S.current),document.title,"?"+a.toString())}}),[v.layers,e.active]);Object(o.useEffect)((function(){var e=b.current;return S.current=d(),function(){i.current&&(i.current.cleanup(e),i.current=void 0),r.current=!1}}),[]),Object(o.useEffect)((function(){i.current&&M()}),[M]),Object(o.useEffect)((function(){if(i.current){var e=M;return i.current.on("moveend",e,b.current),function(){var t;null===(t=i.current)||void 0===t||t.off("moveend",e)}}}),[M,h]),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,i.current=t.getMap(e.mapId),g(i.current),S.current.lat&&S.current.lng&&w())}),[t.mapIds,t,e.mapId,e.active]),Object(o.useEffect)((function(){var e;if(null!=v&&null!==(e=v.layers)&&void 0!==e&&e.length){for(var t in void 0===O.current&&(O.current={},null==f||f.layers.forEach((function(e){O.current[e.id]=!1}))),O.current){var r=!0;if(!1===O.current[t]&&(r=!1),r)return}f.layers&&f.layers.forEach((function(e){var t,r,n;null!==(t=i.current)&&void 0!==t&&t.getLayer(e.id)&&!1===O.current[e.id]&&(O.current[e.id]=!0,null===(r=i.current)||void 0===r||null===(n=r.getLayer(e.id))||void 0===n||n.setLayoutProperty("visibility",e.visible?"visible":"none"))}))}}),[v.layers,e.mapId,e.active]),Object(o.useEffect)((function(){h&&v.layers&&(e.active||h.cleanup(b.current))}),[e.active,h,v.layers]);var C=function(){S.current.lat=i.current.getCenter().lat,S.current.lng=i.current.getCenter().lng,S.current.zoom=i.current.getZoom(),S.current.bearing=i.current.getBearing(),S.current.pitch=i.current.getPitch()},L=function(e){var t={};e.forEach((function(e,r,n){n[e.key]||(t[e.key]=!0)}))},w=function(){x.current.viewport.center||(x.current.viewport.center=!0,i.current.setCenter([S.current.lng,S.current.lat]),i.current.setZoom(S.current.zoom),i.current.setBearing(S.current.bearing),i.current.setPitch(S.current.pitch)),j.current=!0};return window.onpopstate=function(e){e.state&&e.state.lng&&e.state.lat&&e.state.zoom&&i.current.easeTo({zoom:e.state.zoom,center:[e.state.lng,e.state.lat]})},Object(p.jsx)(p.Fragment,{})};m.defaultProps={mapId:void 0},m.propTypes={mapId:s.a.string},m.__docgenInfo={description:"TODO: Add short & useful description\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlShareMapState",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var h=m;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlShareMapState/MlShareMapState.js"]={name:"MlShareMapState",docgenInfo:m.__docgenInfo,path:"src/components/MlShareMapState/MlShareMapState.js"});var g=r(40),y=r(76),b=r(345),v=r(1158),j=r(278),O=r(346),x=r.n(O),S=r(347),M=r.n(S),C=r(1161),L=r(343),w=r(657),I=r(1160),E=r(84),T=r(1237),_=r(658),R=r.n(_),A=r(659),P=r.n(A),k={title:"MapComponents/MlShareMapState",component:h,argTypes:{},decorators:g.a},H=(t.default=k,function(){var e,t=[L,w],r=Object(o.useState)(!0),n=Object(a.a)(r,2),i=n[0],s=n[1],c=Object(y.a)({mapId:"map_1"}),l=Object(u.a)({mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}});return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(h,{active:i}),t.map((function(e,t){return Object(p.jsx)(E.a,{layerId:"GeoJson_"+t,type:"line",geojson:e},"GeoJson_"+t)})),Object(p.jsxs)(b.a,{sx:{wordBreak:"break-word"},children:[Object(p.jsxs)(T.a,{size:"small",selected:i,value:i,onChange:function(){s(!i)},children:[i?Object(p.jsx)(R.a,{}):Object(p.jsx)(P.a,{}),i?"active":"inactive"]}),Object(p.jsx)(I.a,{dense:!0,children:null===(e=l.layers)||void 0===e?void 0:e.map((function(e){return Object(p.jsx)(v.a,{secondaryAction:Object(p.jsx)(j.a,{edge:"end","aria-label":"toggle visibility",onClick:function(){var t,r,n,a,o,i,s=null===(t=c.map)||void 0===t||null===(r=t.getLayer)||void 0===r||null===(n=r.call(t,e.id))||void 0===n?void 0:n.getLayoutProperty("visibility");null===(a=c.map)||void 0===a||null===(o=a.getLayer)||void 0===o||null===(i=o.call(a,e.id))||void 0===i||i.setLayoutProperty("visibility","none"===s?"visible":"none"),setTimeout((function(){c.map._render()}),100)},children:e.visible?Object(p.jsx)(x.a,{}):Object(p.jsx)(M.a,{})}),children:Object(p.jsx)(C.a,{primary:e.id,secondary:""})},e.id)}))},"layers")]})]})}.bind({}));H.parameters={},H.args={},H.parameters=Object(n.a)({storySource:{source:'() => {\n  const geoJsonArray = [sample_geojson_1, sample_geojson_2];\n  const [watchState, setWatchState] = useState(true);\n  const mapHook = useMap({ mapId: "map_1" });\n  const mapState = useMapState({\n    mapId: "map_1",\n    watch: {\n      viewport: false,\n      layers: true,\n      sources: false,\n    },\n    filter: {\n      includeBaseLayers: false,\n    },\n  });\n\n  return (\n    <>\n      <MlShareMapState active={watchState} />\n      {geoJsonArray.map((el, i) => (\n        <MlGeoJsonLayer layerId={"GeoJson_" + i} type="line" geojson={el} key={"GeoJson_" + i} />\n      ))}\n      <Sidebar sx={{ wordBreak: "break-word" }}>\n        <ToggleButton\n          size="small"\n          selected={watchState}\n          value={watchState}\n          onChange={() => {\n            setWatchState(!watchState);\n          }}\n        >\n          {watchState ? <CheckCircleOutlineIcon /> : <ErrorOutlineIcon />}\n\n          {watchState ? "active" : "inactive"}\n        </ToggleButton>\n        <List dense key="layers">\n          {mapState.layers?.map((el) => (\n            <ListItem\n              key={el.id}\n              secondaryAction={\n                <IconButton\n                  edge="end"\n                  aria-label="toggle visibility"\n                  onClick={() => {\n                    let currentVisibility = mapHook.map\n                      ?.getLayer?.(el.id)\n                      ?.getLayoutProperty("visibility");\n                    mapHook.map\n                      ?.getLayer?.(el.id)\n                      ?.setLayoutProperty(\n                        "visibility",\n                        currentVisibility === "none" ? "visible" : "none"\n                      );\n                    setTimeout(() => {\n                      mapHook.map._render();\n                    }, 100);\n                  }}\n                >\n                  {el.visible ? <VisibilityIcon /> : <VisibilityOffIcon />}\n                </IconButton>\n              }\n            >\n              <ListItemText primary={el.id} secondary={""} />\n            </ListItem>\n          ))}\n        </List>\n      </Sidebar>\n    </>\n  );\n}'}},H.parameters)},1146:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return p}));var n=r(5),a=r(0),o=r(64),i=r(1),s=function(e){var t=Object(o.a)({mapId:e.mapId,watch:Object(n.a)({layers:!0,sources:!1,viewport:!1},e.watch),filter:Object(n.a)({},e.filter)}),r=Object(a.useRef)(0);return r.current=r.current+1,Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("div",{style:{overflow:"hidden",width:"100px",height:"20px"},children:["Render: ",r.current,Object(i.jsx)("br",{}),Object(i.jsx)("pre",{children:JSON.stringify(t,null," ")})]})})};s.defaultProps={mapId:void 0},s.__docgenInfo={description:"Renders a collapsable top-drawer containing live map debug information\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlUseMapDebugger",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var c=s;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlUseMapDebugger/MlUseMapDebugger.js"]={name:"MlUseMapDebugger",docgenInfo:s.__docgenInfo,path:"src/components/MlUseMapDebugger/MlUseMapDebugger.js"});var l=r(40),u={title:"MapComponents/MlUseMapDebugger",component:c,argTypes:{url:{},layer:{}},decorators:l.a},p=(t.default=u,function(e){return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(c,Object(n.a)({},e))})}.bind({}));p.parameters={},p.args={mapId:"map_1"},p.parameters=Object(n.a)({storySource:{source:"(props) => {\n  return (\n    <>\n      <MlUseMapDebugger {...props} />\n    </>\n  );\n}"}},p.parameters)},1147:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return m}));var n=r(5),a=r(0),o=r(3),i=r.n(o),s=r(34),c=r(96),l=r(1),u=function(e){var t=Object(a.useContext)(s.b),r=Object(a.useRef)(!1),n=Object(a.useRef)(void 0),o=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlWmsFeatureInfoPopup-")+Object(c.a)());return Object(a.useEffect)((function(){var e=o.current;return function(){n.current&&(n.current.cleanup(e),n.current=void 0),r.current=!1}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,n.current=t.getMap(e.mapId),n.current.setCenter([7.132122000552613,50.716405378037706]))}),[t.mapIds,t,e.mapId]),Object(l.jsx)(l.Fragment,{})};u.defaultProps={mapId:void 0},u.propTypes={mapId:i.a.string},u.__docgenInfo={description:"TODO: Add short & useful description\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlWmsFeatureInfoPopup",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var p=u;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlWmsFeatureInfoPopup/MlWmsFeatureInfoPopup.js"]={name:"MlWmsFeatureInfoPopup",docgenInfo:u.__docgenInfo,path:"src/components/MlWmsFeatureInfoPopup/MlWmsFeatureInfoPopup.js"});var d=r(40),f={title:"MapComponents/MlWmsFeatureInfoPopup",component:p,argTypes:{url:{},layer:{}},decorators:d.a},m=(t.default=f,function(e){return Object(l.jsx)(p,{})}.bind({}));m.parameters={},m.args={},m.parameters=Object(n.a)({storySource:{source:"(args) => <MlWmsFeatureInfoPopup />"}},m.parameters)},124:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(34),i=r(623),s=r(56),c=r(213),l=r(440),u=r.n(l),p=r(161),d=r.n(p),f=["lng","lat"],m=function(e){var t=this,r=this;this.registeredElements={},this.baseLayers=[],this.firstSymbolLayer=void 0,this.eventHandlers={layerchange:[],viewportchange:[]},this.wrapper={on:function(e,t,n,a){if(r.eventHandlers[e]){"string"==typeof n&&(a=n,n={}),r.eventHandlers[e].push({handler:t,options:n});var o=[e,t];a&&"string"==typeof a&&(r.initRegisteredElements(a),r.registeredElements[a].wrapperEvents.push(o))}},off:function(e,t){r.eventHandlers[e]&&(r.eventHandlers[e]=r.eventHandlers[e].filter((function(e){return!Object.is(e.handler,t)&&e})))},fire:function(e,t){if(r.eventHandlers[e]){var n=t||window,a=new Event(e);a.data=r,r.eventHandlers[e].forEach((function(e){e.handler.call(n,a)}))}},layerState:[],layerStateString:"",oldLayerStateStrings:{},buildLayerObject:function(e){return{id:e.id,type:e.type,visible:"none"!==e.visibility,baseLayer:-1!==r.baseLayers.indexOf(e.id)}},buildLayerObjects:function(){return r.style._order.map((function(e){return r.wrapper.buildLayerObject(r.map.style._layers[e])})).filter((function(e){return e}))},refreshLayerState:function(){r.wrapper.layerState=r.wrapper.buildLayerObjects(),JSON.stringify(r.wrapper.layerState)!==r.wrapper.layerStateString&&(r.wrapper.fire("layerchange"),r.wrapper.layerStateString=JSON.stringify(r.wrapper.layerState))},viewportState:{},viewportStateString:"{}",oldViewportStateString:"{}",getViewport:function(){return"function"==typeof r.map.getCenter?{center:function(e){var t=e.lng,r=e.lat;Object(c.a)(e,f);return{lng:t,lat:r}}(r.map.getCenter()),zoom:r.map.getZoom(),bearing:r.map.getBearing(),pitch:r.map.getPitch()}:{}},refreshViewport:function(){r.wrapper.viewportState=r.wrapper.getViewport()}},this.initRegisteredElements=function(e,t){(void 0===r.registeredElements[e]||"undefined"!==t&&t)&&(r.registeredElements[e]={layers:[],sources:[],images:[],events:[],controls:[],wrapperEvents:[]})},this.addLayer=function(e,t,n){r.map.style&&(n&&"string"==typeof n&&void 0!==e.id&&(r.initRegisteredElements(n),r.registeredElements[n].layers.push(e.id),"object"==typeof e.source&&r.registeredElements[n].sources.push(e.id)),r.map.addLayer(e,t))},this.addSource=function(e,t,n,a){if(r.map.style){if("string"==typeof n&&void 0===a)return r.addSource.call(r,e,t,void 0,n);a&&"string"==typeof a&&void 0!==e&&(r.initRegisteredElements(a),r.registeredElements[a].sources.push(e)),r.map.addSource(e,t,n)}},this.addImage=function(e,t,n,a){if(r.map.style){if("string"==typeof n&&void 0===a)return r.addImage.call(r,e,t,void 0,n);a&&"string"==typeof a&&void 0!==e&&(r.initRegisteredElements(a),r.registeredElements[a].images.push(e)),r.map.addImage(e,t,n)}},this.on=function(e,t,n,a){var o;if("string"==typeof n&&"function"==typeof t)return r.on.call(r,e,void 0,t,n);var i=[e,t,n];t||(i=[e,n]),a&&"string"==typeof a&&(r.initRegisteredElements(a),r.registeredElements[a].events.push(i)),(o=r.map).on.apply(o,Object(s.a)(i))},this.addControl=function(e,t,n){n&&"string"==typeof n&&(r.initRegisteredElements(n),r.registeredElements[n].controls.push(e)),r.map.addControl(e,t)},this.cleanup=function(e){r.map.style&&void 0!==r.registeredElements[e]&&(r.registeredElements[e].layers.forEach((function(e){r.map.style.getLayer(e)&&r.map.style.removeLayer(e)})),r.registeredElements[e].sources.forEach((function(e){r.map.style.getSource(e)&&r.map.style.removeSource(e)})),r.registeredElements[e].images.forEach((function(e){r.map.hasImage(e)&&r.map.style.removeImage(e)})),r.registeredElements[e].events.forEach((function(e){var t;(t=r.map).off.apply(t,Object(s.a)(e))})),r.registeredElements[e].controls.forEach((function(e){r.map.removeControl(e)})),r.registeredElements[e].wrapperEvents.forEach((function(e){var t;(t=r.wrapper).off.apply(t,Object(s.a)(e))})),r.initRegisteredElements(e,!0))};["moveLayer","removeLayer","removeSource","setPaintProperty","setLayoutProperty"].forEach((function(e){t[e]=function(){var n;r.map&&t.map.style&&"function"==typeof r.map.style[e]&&(n=r.map.style)[e].apply(n,arguments);return r.map._update?r.map._update(!0):void 0}}));["getLayer","getSource","listImages","getPaintProperty","getLayoutProperty","removeImage"].forEach((function(e){t[e]=function(){var t;return!(!r.map||!r.map.style)&&(t=r.map.style)[e].apply(t,arguments)}})),this.addNativeMaplibreFunctionsAndProps=function(){Object.getOwnPropertyNames(Object.getPrototypeOf(t.map)).forEach((function(e){void 0===t[e]&&(t[e]=function(){var t;return(t=r.map)[e].apply(t,arguments)})})),Object.keys(t.map).forEach((function(e){void 0===t[e]&&(t[e]=r.map[e])}))};["getZoom","setZoom","getCenter","setCenter","getBearing","setBearing","getPitch","setPitch","jumpTo","flyTo","panTo","panBy","panBy","zoomTo","zoomIn","zoomOut","getPadding","setPadding","rotateTo","resetNorth","resetNorthPitch","snapToNorth","cameraForBounds","fitBounds","fitScreenCoordinates","getFreeCameraOptions","setFreeCameraOptions","easeTo","stop"].forEach((function(e){t[e]=function(){if("function"==typeof r.map[e]){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=r.map[e]).call.apply(t,[r.map].concat(a))}}})),function(){var t=Object(i.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e.mapOptions.style||-1!==e.mapOptions.style.indexOf("mapbox://")){t.next=3;break}return t.next=3,fetch(e.mapOptions.style).then((function(e){if(e.ok)return e.json();throw new Error("error loading map style.json")})).then((function(t){t.layers.forEach((function(e){r.baseLayers.push(e.id),r.firstSymbolLayer||"symbol"!==e.type||(r.firstSymbolLayer=e.id)})),r.styleJson=t,e.mapOptions.style=t})).catch((function(e){console.log(e)}));case 3:r.map=new d.a.Map(e.mapOptions),r.addNativeMaplibreFunctionsAndProps(),r.wrapper.refreshViewport(),r.wrapper.fire("viewportchange"),r.map.on("load",(function(){r.addNativeMaplibreFunctionsAndProps()})),r.map.on("move",(function(){r.wrapper.viewportState=r.wrapper.getViewport(),r.wrapper.fire("viewportchange")})),r.map.on("idle",(function(){r.wrapper.refreshLayerState()})),r.map.on("data",(function(){r.wrapper.refreshLayerState()})),"function"==typeof e.onReady&&e.onReady(r.map,r);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()},h=(r(1040),r(1)),g=function(e){var t=Object(a.useRef)(null),r=Object(a.useRef)(null),i=Object(a.useContext)(o.b),s=Object(a.useRef)(i),c=Object(a.useRef)(e.mapId),l=e.options;return Object(a.useEffect)((function(){var e=c.current,r=s.current;return function(){var n,a;r.removeMap(e),null===(n=t.current)||void 0===n||null===(a=n.remove)||void 0===a||a.call(n),t.current=null}}),[]),Object(a.useEffect)((function(){r.current&&(t.current=new m({mapOptions:Object(n.a)({container:r.current},l),onReady:function(t,r){t.once("load",(function(){e.mapId?i.registerMap(e.mapId,r):i.setMap(r)})),window.map=r}}))}),[r]),Object(h.jsx)("div",{ref:r,className:"mapContainer"})};g.defaultProps={mapId:void 0,options:{lng:8.607,lat:53.1409349,zoom:10,accessToken:"pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA"}},g.__docgenInfo={description:"Creates a MapLibreGlWrapper instance and registers it in MapContext\nafter the MapLibre-gl load event has fired.\n\nMapLibreMap returns the html node that will be used by MapLibre-gl to render the map.\nThis Component must be kept unaware of any related components that interact with the MapLibre-gl\ninstance.\n\n@component",methods:[],displayName:"MapLibreMap",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the MapLibreGl(Wrapper) instance in mapContext"},options:{defaultValue:{value:'{\n  lng: 8.607,\n  lat: 53.1409349,\n  zoom: 10,\n  accessToken:\n    "pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA",\n}',computed:!1},type:{name:"object"},required:!1,description:"Config object that is passed to the MapLibreGl constructor as first parameter.\nSee https://maplibre.org/maplibre-gl-js-docs/api/map/ for a formal documentation of al\navailable properties."}}};t.a=g;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MapLibreMap/MapLibreMap.js"]={name:"MapLibreMap",docgenInfo:g.__docgenInfo,path:"src/components/MapLibreMap/MapLibreMap.js"})},160:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0),a=r.n(n).a.createContext({}),o=a.Provider;t.b=a},183:function(e,t,r){"use strict";var n=r(5),a=r(15),o=r(0),i=r(76),s=r(168),c=r(636),l=r.n(c),u=r(65),p=r(84),d=r(1),f=function(e){var t=Object(i.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(o.useState)(!1),c=Object(a.a)(r,2),f=c[0],m=c[1],h=Object(o.useState)(void 0),g=Object(a.a)(h,2),y=g[0],b=g[1],v=Object(o.useState)(!1),j=Object(a.a)(v,2),O=j[0],x=j[1],S=Object(o.useState)(),M=Object(a.a)(S,2),C=M[0],L=M[1],w=Object(o.useCallback)((function(e){if(t.map){t.map.flyTo({center:[e.coords.longitude,e.coords.latitude],zoom:18,speed:1,curve:1});var r=Object(u.point)([e.coords.longitude,e.coords.latitude]);b(r),L(Object(u.circle)(r,e.coords.accuracy/1e3))}}),[t.map]),I=function(e){console.log("Access of user location denied"),x(!0)};return Object(o.useEffect)((function(){if(t.map&&f){var e=navigator.geolocation.watchPosition(w,I);return function(){navigator.geolocation.clearWatch(e)}}}),[t.map,f,w]),Object(d.jsxs)(d.Fragment,{children:[f&&y&&Object(d.jsx)(p.a,{geojson:C,type:"fill",paint:Object(n.a)({"fill-color":"#cbd300","fill-opacity":.3},e.accuracyPaint),insertBeforeLayer:e.insertBeforeLayer}),f&&y&&Object(d.jsx)(p.a,{geojson:y,type:"circle",paint:Object(n.a)({"circle-color":"#009ee0","circle-radius":5,"circle-stroke-color":"#fafaff","circle-stroke-width":1},e.circlePaint),insertBeforeLayer:e.insertBeforeLayer}),Object(d.jsxs)(s.a,{sx:Object(n.a)({zIndex:1002,color:f?e.onColor:e.offColor},e.style),disabled:O,onClick:function(){m(!f)},children:[" ",Object(d.jsx)(l.a,{sx:{fontSize:e.style.fontSize}})," "]})]})};f.defaultProps={mapId:void 0,style:{minWidth:"30px",minHeight:"30px",width:"30px",height:"30px",backgroundColor:"#414141",borderRadius:"23%",margin:.15,fontSize:"1.3em",":hover":{backgroundColor:"#515151",color:"#ececec"}},onColor:"#ececec",offColor:"#666"},f.__docgenInfo={description:"Adds a button that makes the map follow the users GPS position using\nnavigator.geolocation.watchPosition if activated\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlFollowGps",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},style:{defaultValue:{value:'{\n  minWidth: "30px",\n  minHeight: "30px",\n  width: "30px",\n  height: "30px",\n  backgroundColor: "#414141",\n  borderRadius: "23%",\n  margin: 0.15,\n  fontSize: "1.3em",\n  ":hover": {\n    backgroundColor: "#515151",\n    color: "#ececec",\n  },\n}',computed:!1},type:{name:"object"},required:!1,description:"CSS style object that is applied to the button component"},onColor:{defaultValue:{value:'"#ececec"',computed:!1},type:{name:"string"},required:!1,description:"Active button font color"},offColor:{defaultValue:{value:'"#666"',computed:!1},type:{name:"string"},required:!1,description:"Inactive button font color"},accuracyPaint:{type:{name:"object"},required:!1,description:'Accuracy paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy circle.\nUse any available paint prop from layer type "fill".\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill'},circlePaint:{type:{name:"object"},required:!1,description:'position circle paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy circle.\nUse any available paint prop from layer type "fill".\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill'}}},t.a=f,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlFollowGps/MlFollowGps.js"]={name:"MlFollowGps",docgenInfo:f.__docgenInfo,path:"src/components/MlFollowGps/MlFollowGps.js"})},184:function(e,t,r){"use strict";var n=r(56),a=r(15),o=r(0),i=r(34),s=r(65),c=r(1165),l=r(670),u=r(669),p=r(278),d=r(639),f=r.n(d),m=r(638),h=r.n(m),g=r(161),y=r(1160),b=r(1158),v=r(1161),j=r(160),O=r(637),x=r(353),S=r(96),M=r(1),C=function(e){var t=Object(o.useContext)(j.b),r=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlGpxViewer-")+Object(S.a)()),d=Object(o.useContext)(i.b),m=e.mapId,C=Object(o.useRef)(!1),L=Object(o.useRef)(null),w="importer-layer-lines",I="importer-layer-points",E=Object(o.useState)(!1),T=Object(a.a)(E,2),_=T[0],R=T[1],A=Object(o.useRef)(null),P=Object(o.useState)(0),k=Object(a.a)(P,2),H=k[0],F=k[1],N=Object(o.useState)([]),B=Object(a.a)(N,2),U=B[0],G=B[1],D=Object(o.useRef)(null),q=Object(x.a)("(max-width:900px)"),z=Object(o.useRef)(new g.Popup({closeButton:!1,closeOnClick:!0}));Object(o.useEffect)((function(){var e=r.current,t=z.current;return function(){L.current&&(L.current.cleanup(e),L.current.getCanvas().style.cursor="",L.current=null),t.remove()}}),[]),Object(o.useEffect)((function(){d.mapExists(m)&&!C.current&&(C.current=!0,L.current=d.getMap(m),L.current.addSource("import-source",{type:"geojson",data:t.data},r.current),L.current.addLayer({id:w,source:"import-source",type:"line",paint:{"line-width":4,"line-color":"rgba(212, 55, 23,0.5)"}},e.insertBeforeLayer,r.current),L.current.addLayer({id:I,source:"import-source",type:"circle",paint:{"circle-color":"rgba(72, 77, 99,0.5)","circle-radius":7},filter:["==","$type","Point"]},e.insertBeforeLayer,r.current),[w,I].forEach((function(e){L.current.setLayoutProperty(e,"visibility","visible")})),L.current.on("mouseenter",I,(function(t){d.getMap(e.mapId).getCanvas().style.cursor="pointer";for(var r=t.features[0].geometry.coordinates.slice(),n=t.features[0].properties.name;Math.abs(t.lngLat.lng-r[0])>180;)r[0]+=t.lngLat.lng>r[0]?360:-360;z.current.setLngLat(r).setHTML(n).addTo(L.current)})),L.current.on("mouseleave","places",(function(){L.current.getCanvas().style.cursor="",z.current.remove()})),L.current.setZoom(10))}),[d.mapIds,d,t.data,m,e]),Object(o.useEffect)((function(){var e=A.current,t=function(e){F(1e3),V(e)},r=function(){F(0)},n=function(e){F(0),V(e)};return window.addEventListener("dragenter",t),window.addEventListener("dragover",V),e.addEventListener("dragleave",r),window.addEventListener("drop",n),function(){window.removeEventListener("dragenter",t),window.removeEventListener("dragover",V),window.removeEventListener("drop",V),e.removeEventListener("dragleave",r),window.removeEventListener("drop",(function(e){return n}))}}));var V=function(e){e.preventDefault(),e.stopPropagation()};Object(o.useEffect)((function(){if(L.current){var t=e.visible?"visible":"none";[w,I].forEach((function(e){L.current.setLayoutProperty(e,"visibility",t)}))}}),[e.visible]);var W=function(e){if(L.current)try{G([]);var r=(new DOMParser).parseFromString(e,"application/xml");r.querySelector("metadata").childNodes.forEach((function(e){var t=e.textContent,r=e.nodeName;if("link"===e.nodeName&&(t=e.getAttribute("href")),t.trim().length){var a={title:r,value:t,id:(new Date).getTime()};G((function(e){return[].concat(Object(n.a)(e),[a])}))}}));var a=O.a.gpx(r);t.setData(a),L.current.getSource("import-source").setData(a);var o=Object(s.bbox)(a);L.current.fitBounds(o)}catch(e){console.log(e)}};return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("div",{style:{position:"fixed",right:"5px",bottom:q?"40px":"25px",display:"flex",flexDirection:"column",gap:"5px",zIndex:1e3},children:[Object(M.jsxs)(p.a,{onClick:function(){D.current.click()},style:{backgroundColor:"rgba(255,255,255,1)"},size:"large",children:[Object(M.jsx)("input",{ref:D,onChange:function(){var e=D.current.files[0];if(!e)return!1;var t=new FileReader;t.onload=function(e){W(e.currentTarget.result)},t.readAsText(e)},type:"file",id:"input",multiple:!0,style:{display:"none"}}),Object(M.jsx)(h.a,{})]}),Object(M.jsx)(p.a,{onClick:function(){R((function(e){return!e}))},style:{backgroundColor:"rgba(255,255,255,1)"},size:"large",children:Object(M.jsx)(f.a,{})})]}),Object(M.jsxs)(u.a,{variant:"persistent",anchor:"left",open:_,children:[Object(M.jsx)(l.a,{variant:"h6",style:{textAlign:"center",padding:"1em"},noWrap:!0,children:"Informationen zur Route"}),Object(M.jsx)(c.a,{}),Object(M.jsx)(y.a,{children:U.map((function(e){return Object(M.jsx)(b.a,{children:Object(M.jsx)(v.a,{primary:e.value})},"item--".concat(e.id))}))})]}),Object(M.jsx)("div",{onDrop:function(e){if(e.preventDefault(),e.dataTransfer.items){if(e.dataTransfer.items.length>1)return!1;if("file"===e.dataTransfer.items[0].kind){var t=new FileReader;t.onload=function(e){W(e.currentTarget.result)};var r=e.dataTransfer.items[0].getAsFile();t.readAsText(r)}}},ref:A,style:{position:"absolute",left:"0",top:"0",backgroundColor:"rgba(255,255,255,0.5)",width:"100%",height:"100%",zIndex:H},children:Object(M.jsx)(l.a,{variant:"h6",style:{top:"50%",position:"absolute",left:"50%",msTransform:"translate(-50%, -50%)",transform:" translate(-50%, -50%)"},noWrap:!0,children:"Gpx-Datei ablegen"})})]})};C.defaultProps={visible:!0},C.__docgenInfo={description:"MlGPXViewer returns a dropzone and a button to load a GPX Track into the map.\n\n@component",methods:[],displayName:"MlGPXViewer",props:{visible:{defaultValue:{value:"true",computed:!1},type:{name:"bool"},required:!1,description:'Sets the layers layout-property "visibility" to "none" if false or "visible" if true'},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}},t.a=C,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlGPXViewer/MlGPXViewer.js"]={name:"MlGPXViewer",docgenInfo:C.__docgenInfo,path:"src/components/MlGPXViewer/MlGPXViewer.js"})},185:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(96),i=r(34),s=r(64),c=r(1),l=function(e){var t=Object(a.useContext)(i.b),r=Object(s.a)({mapId:e.mapId,watch:{viewport:!1,layers:!0,sources:!1}}),l=Object(a.useRef)(!1),u=Object(a.useRef)(null),p=Object(a.useRef)((e.layerId?e.layerId:"MlLayer-")+Object(o.a)()),d=Object(a.useRef)(e.layerId||p.current),f=Object(a.useRef)(void 0),m=Object(a.useRef)(void 0);return Object(a.useEffect)((function(){var e=p.current;return function(){u.current&&(u.current.cleanup(e),u.current=null)}}),[]),Object(a.useEffect)((function(){var r,n;if(t.mapExists(e.mapId)&&null!==(r=t.getMap(e.mapId))&&void 0!==r&&null!==(n=r.getLayer)&&void 0!==n&&n.call(r,d)&&l.current&&e.options){var a,o=JSON.stringify(e.options.layout);if(e.options.layout&&o!==m.current){for(a in e.options.layout)u.current.setLayoutProperty(d,a,e.options.layout[a]);m.current=o}var i=JSON.stringify(e.options.paint);if(e.options.paint&&i===f.current)for(a in e.options.paint)u.current.setPaintProperty(d,a,e.options.paint[a])}}),[e.options,d,t,e]),Object(a.useEffect)((function(){if(t.mapExists(e.mapId)&&!l.current){if(e.insertBeforeLayer){var a,o=!1;if(null==r||null===(a=r.layers)||void 0===a||a.forEach((function(t){t.id===e.insertBeforeLayer&&(o=!0)})),!o)return}var i,s;if(u.current=t.getMap(e.mapId),u.current)l.current=!0,u.current.addLayer(Object(n.a)({id:d.current,type:"background",paint:{"background-color":"rgba(0,0,0,0)"}},e.options),e.insertBeforeLayer,p.current),f.current=JSON.stringify(null===(i=e.options)||void 0===i?void 0:i.paint),m.current=JSON.stringify(null===(s=e.options)||void 0===s?void 0:s.layout)}}),[t.mapIds,t,e,r.layers]),Object(c.jsx)(c.Fragment,{})};l.__docgenInfo={description:"",methods:[],displayName:"MlLayer"},t.a=l,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayer/MlLayer.js"]={name:"MlLayer",docgenInfo:l.__docgenInfo,path:"src/components/MlLayer/MlLayer.js"})},186:function(e,t,r){"use strict";var n=r(5),a=r(15),o=r(223),i=r(0),s=r(34),c=r(96),l=["title","titleId"];function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function d(e,t){var r=e.title,n=e.titleId,a=p(e,l);return i.createElement("svg",u({width:"39.675098mm",height:"104.27064mm",viewBox:"0 0 39.675098 104.27064",ref:t,"aria-labelledby":n},a),r?i.createElement("title",{id:n},r):null,i.createElement("g",{transform:"translate(-86.019554,-58.032633)"},i.createElement("path",{style:{strokeWidth:.744756},d:"m 442.74023,219.33594 -117.62695,32.32422 54.71094,31.12304 c -21.99397,41.5931 -32.8507,84.88283 -38.33008,127.89649 -6.86182,50.94051 -5.95715,103.99765 20.23828,155.46484 5.97246,11.72776 13.65817,23.59773 24.38867,35.06641 2.6597,2.84073 5.65602,5.75455 9.12891,8.68164 0.87557,0.7378 1.85363,1.52609 2.95117,2.35547 0.29669,0.22563 0.63616,0.47742 1.02149,0.75586 l 0.58203,0.42578 34.57812,-15.12305 -0.33789,-0.2207 c -0.0265,-0.0151 -0.0842,-0.0587 -0.18359,-0.13086 -0.46723,-0.34885 -0.9819,-0.76796 -1.56055,-1.25 -2.29757,-1.91343 -4.46539,-4.04643 -6.64062,-6.33985 -8.80052,-9.27114 -15.30333,-19.4993 -20.83985,-30.13867 -24.42289,-46.90715 -24.77465,-97.03535 -18.58008,-146.68164 4.94388,-37.37493 13.65299,-74.4847 30.20508,-109.92969 l 58.6211,33.34766 z",transform:"scale(0.26458333)"})))}var f,m=i.forwardRef(d),h=(r.p,["title","titleId"]);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function y(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function b(e,t){var r=e.title,n=e.titleId,a=y(e,h);return i.createElement("svg",g({width:"39.675098mm",height:"104.27064mm",viewBox:"0 0 39.675098 104.27064",ref:t,"aria-labelledby":n},a),r?i.createElement("title",{id:n},r):null,f||(f=i.createElement("g",{transform:"translate(-86.019554,-58.032633)"},i.createElement("path",{d:"m 94.572523,58.032633 31.122127,8.55245 -14.4756,8.234638 c 5.81924,11.004841 8.69175,22.458582 10.1415,33.839279 1.81552,13.47801 1.57616,27.51604 -5.35471,41.13341 -1.58021,3.10296 -3.61373,6.24356 -6.45284,9.27798 -0.70371,0.75161 -1.49649,1.52256 -2.41535,2.29702 -0.23167,0.19521 -0.49044,0.40378 -0.78083,0.62322 -0.0785,0.0597 -0.16832,0.12632 -0.27027,0.19999 l -0.154,0.11265 -9.148793,-4.00131 0.0894,-0.0584 c 0.007,-0.004 0.02228,-0.0155 0.04857,-0.0346 0.123621,-0.0923 0.259794,-0.20319 0.412895,-0.33073 0.607899,-0.50626 1.181468,-1.07062 1.756997,-1.67742 2.328481,-2.45299 4.049011,-5.15919 5.513881,-7.97419 6.46189,-12.41085 6.55496,-25.67394 4.91598,-38.80952 -1.30807,-9.888781 -3.61235,-19.707408 -7.99176,-29.085561 l -15.510171,8.823235 z"}))))}var v,j=i.forwardRef(b),O=(r.p,["title","titleId"]);function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function M(e,t){var r=e.title,n=e.titleId,a=S(e,O);return i.createElement("svg",x({width:"75.967445mm",height:"234.71339mm",viewBox:"0 0 75.967445 234.71339",ref:t,"aria-labelledby":n},a),r?i.createElement("title",{id:n},r):null,v||(v=i.createElement("g",{transform:"translate(-76.705281,-29.77268)"},i.createElement("path",{d:"m 114.68901,29.77268 37.98372,117.3567 H 76.705281 Z"}),i.createElement("path",{d:"m 114.68901,264.48608 37.98372,-117.3567 H 76.705281 Z"}))))}var C,L,w,I=i.forwardRef(M),E=(r.p,r(165)),T=r(167),_=r(1),R=E.a.div(C||(C=Object(o.a)(["\n  width: 40%;\n  display: flex;\n  align-items: center;\n\n  &:hover {\n    cursor: pointer;\n  }\n  path {\n    filter: drop-shadow(0px 0px 15px rgba(0, 0, 0, 0.2));\n  }\n  &:hover path {\n    filter: drop-shadow(0px 0px 13px rgba(255, 255, 255, 0.1));\n  }\n  path:nth-of-type(2) {\n    fill: #343434;\n  }\n  &:hover path:nth-of-type(2) {\n    fill: #434343;\n  }\n  path:nth-of-type(1) {\n    fill: #e90318;\n  }\n  &:hover path:nth-of-type(1) {\n    fill: #fb4052;\n  }\n"]))),A=E.a.div(L||(L=Object(o.a)(["\n  pointer-events: none;\n  display: flex;\n  z-index: 1002;\n  position: absolute;\n  align-items: center;\n\n  margin-left: -30%;\n  path:nth-of-type(2) {\n  }\n  svg g {\n    transform: translate(-76.7053, -29.7727) scale(2, 1);\n  }\n  svg {\n    z-index: 9990;\n    height: 150px;\n    width: 200px;\n  }\n"]))),P=E.a.div(w||(w=Object(o.a)(["\n  width: 30%;\n  margin-top: 14px;\n  z-index: 999;\n  display: flex;\n\n  svg:hover {\n    cursor: pointer;\n  }\n  svg:hover path {\n    fill: #ececec;\n    filter: drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.1));\n  }\n  path {\n    fill: #bbb;\n  }\n  svg {\n    transform: scale(0.6);\n    z-index: 9990;\n    height: 172px;\n  }\n"]))),k=function(e){var t=Object(i.useContext)(s.b),r=Object(i.useRef)(!1),o=Object(i.useRef)(void 0),l=Object(i.useRef)((e.idPrefix?e.idPrefix:"MlNavigationCompass-")+Object(c.a)()),u=Object(i.useState)(0),p=Object(a.a)(u,2),d=p[0],f=p[1];return Object(i.useEffect)((function(){var e=l.current;return function(){o.current&&(o.current.cleanup(e),o.current=void 0),r.current=!1}}),[]),Object(i.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,o.current=t.getMap(e.mapId),o.current.on("rotate",(function(){f(Math.round(o.current.getBearing()))}),l.current),f(Math.round(o.current.getBearing())))}),[t.mapIds,t,e.mapId]),Object(_.jsx)(_.Fragment,{children:Object(_.jsx)("div",{className:Object(T.a)(Object(n.a)({zIndex:1e3,top:0,position:"absolute"},e.style)),children:Object(_.jsxs)("div",{className:Object(T.a)(Object(n.a)({position:"absolute",border:"10px solid #bcbcbc",backgroundColor:"#717171",background:"radial-gradient(#717171, #414141)",height:"200px",width:"200px",borderRadius:"50%",display:"flex",justifyContent:"center",transform:"scale(0.2) translateX(-448px) translateY(-448px)"},e.backgroundStyle)),children:[Object(_.jsx)(P,{className:Object(T.a)(Object(n.a)({},e.rotateRightStyle)),children:Object(_.jsx)(m,{onClick:function(){var e,t,r=Math.round(null===(e=o.current)||void 0===e?void 0:e.getBearing()),n=Math.round(r%90);r>0&&(n=90-n),0===n&&(n=90),null===(t=o.current)||void 0===t||t.setBearing(Math.round(r+Math.abs(n)))}})}),Object(_.jsx)(R,{className:Object(T.a)(Object(n.a)({},e.needleStyle)),onClick:function(){var e;null===(e=o.current)||void 0===e||e.setBearing(0)},children:Object(_.jsx)(A,{style:{transform:"rotate("+d+"deg)"},children:Object(_.jsx)(I,{})})}),Object(_.jsx)(P,{className:Object(T.a)(Object(n.a)({},e.rotateLeftStyle)),children:Object(_.jsx)(j,{onClick:function(){var e,t,r=Math.round(null===(e=o.current)||void 0===e?void 0:e.getBearing()),n=Math.round(r%90);r<0&&(n=90+n),0===n&&(n=90),null===(t=o.current)||void 0===t||t.setBearing(Math.round(r-Math.abs(n)))}})})]})})})};k.__docgenInfo={description:"Navigation component that displays a compass component which indicates the current oriantation of the map it is registered for and offers controls to turn the bearing 90° left/right or reset north to point up.\n\nAll style props are applied using @emotion/css to allow more complex css selectors.\n\n@component",methods:[],displayName:"MlNavigationCompass",props:{idPrefix:{type:{name:"string"},required:!1,description:"Component id prefix"},style:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the component."},backgroundStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the background."},needleStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the compass needle."},rotateRightStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the rotate right button."},rotateLeftStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the rotate left button."}}};t.a=k;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlNavigationCompass/MlNavigationCompass.js"]={name:"MlNavigationCompass",docgenInfo:k.__docgenInfo,path:"src/components/MlNavigationCompass/MlNavigationCompass.js"})},210:function(e,t,r){"use strict";var n=r(15),a=r(0),o=r(160),i=r(1),s=function(e){var t=e.children,r=Object(a.useState)({type:"FeatureCollection",features:[]}),s=Object(n.a)(r,2),c={data:s[0],setData:s[1],getEmptyFeatureCollection:function(){return{type:"FeatureCollection",features:[]}}};return Object(i.jsx)(o.a,{value:c,children:t})};s.__docgenInfo={description:"",methods:[],displayName:"GeoJsonProvider",props:{children:{type:{name:"node"},required:!0,description:""}}},t.a=s,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlGPXViewer/util/GeoJsonProvider.js"]={name:"GeoJsonProvider",docgenInfo:s.__docgenInfo,path:"src/components/MlGPXViewer/util/GeoJsonProvider.js"})},216:function(e,t,r){"use strict";r(0);var n=r(34),a=r(124),o=(r(599),r(276)),i=r(671),s=r(1),c=Object(o.a)({}),l=[function(e){return Object(s.jsx)("div",{className:"fullscreen_map",children:Object(s.jsx)(i.a,{theme:c,children:Object(s.jsx)(n.a,{children:Object(s.jsxs)("div",{style:{overflow:"hidden",position:"absolute",top:"0",bottom:"0",left:"0",right:"0"},children:[Object(s.jsx)(e,{}),Object(s.jsxs)("div",{className:"maps",children:[Object(s.jsx)(a.a,{mapId:"map_1",options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-liberty.json",center:[7.0851268,50.73884]}}),Object(s.jsx)(a.a,{mapId:"map_2",options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]}})]})]})})})})}];t.a=l},252:function(e,t,r){"use strict";var n=r(0),a=r(3),o=r.n(a),i=r(76),s=r(1),c=function(e){var t=Object(i.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(n.useRef)(!1);return Object(n.useEffect)((function(){t.mapIsReady&&!r.current&&(r.current=!0,t.map.setCenter([7.132122000552613,50.716405378037706]))}),[t.map,t.mapIsReady,e.mapId]),Object(s.jsx)(s.Fragment,{})};c.defaultProps={mapId:void 0},c.propTypes={mapId:o.a.string},c.__docgenInfo={description:"TODO: Add short & useful description\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlComponentTemplate",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}},t.a=c,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlComponentTemplate/MlComponentTemplate.js"]={name:"MlComponentTemplate",docgenInfo:c.__docgenInfo,path:"src/components/MlComponentTemplate/MlComponentTemplate.js"})},256:function(e,t,r){"use strict";var n=r(5),a=r(15),o=r(0),i=r(34),s=r(96),c=r(168),l=r(1),u=function(e){var t=Object(o.useContext)(i.b),r=Object(o.useRef)(null),u=Object(o.useState)(!0),p=Object(a.a)(u,2),d=p[0],f=p[1],m=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlFillExtrusionLayer-")+Object(s.a)()),h=Object(o.useRef)(!1),g=Object(o.useRef)(e.layerId||"MlFillExtrusionLayer-"+Object(s.a)());return Object(o.useEffect)((function(){var e=m.current;return function(){r.current&&(r.current.cleanup(e),r.current=void 0),h.current=!1}}),[]),Object(o.useEffect)((function(){if(t.mapExists(e.mapId)&&!h.current){h.current=!0,r.current=t.getMap(e.mapId);var a=void 0;t.map.getLayer("waterway-name")&&(a="waterway-name"),t.map.getLayer("poi_label")&&(a="poi_label"),t.map.addLayer({id:g.current,type:"fill-extrusion",source:e.sourceId||"openmaptiles","source-layer":e.sourceLayer||"building",minzoom:e.minZoom||14,paint:Object(n.a)({},e.paint)},e.insertBeforeLayer||a,m.current)}}),[t,e.insertBeforeLayer,e.mapId,e.minZoom,e.paint,e.sourceId,e.sourceLayer]),Object(o.useEffect)((function(){h.current&&r.current.setLayoutProperty(g.current,"visibility",d?"visible":"none")}),[d,t]),Object(l.jsx)(c.a,{color:"primary",variant:d?"contained":"outlined",onClick:function(){return f(!d)},children:"Composite"})};u.defaultProps={mapId:void 0,paint:{"fill-extrusion-color":"hsl(196, 61%, 83%)","fill-extrusion-height":{property:"render_height",type:"identity"},"fill-extrusion-base":{property:"render_min_height",type:"identity"},"fill-extrusion-opacity":1}},u.__docgenInfo={description:"Adds a fill extrusion layer to the MapLibre instance reference by props.mapId\n\n@Component",methods:[],displayName:"MlFillExtrusionLayer",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},paint:{defaultValue:{value:'{\n  "fill-extrusion-color": "hsl(196, 61%, 83%)",\n  "fill-extrusion-height": {\n    property: "render_height",\n    type: "identity",\n  },\n  "fill-extrusion-base": {\n    property: "render_min_height",\n    type: "identity",\n  },\n  "fill-extrusion-opacity": 1,\n}',computed:!1},type:{name:"object"},required:!1,description:"Paint properties of the config object that is passed to the MapLibreGl.addLayer call. All\navailable properties are documented in the MapLibreGl documentation\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill-extrusion"},layerId:{type:{name:"string"},required:!1,description:"Id of the layer that will be added by this component"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},sourceId:{type:{name:"string"},required:!1,description:"Source id of a vector tile source containing the geometries to use for this fill-extrusion\nlayer.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer"},sourceLayer:{type:{name:"string"},required:!1,description:"Layer id from a vector tile source containing the geometries to use for this fill-extrusion\nlayer.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer"},minZoom:{type:{name:"number"},required:!1,description:"This layer will be hidde for zoom levels lower than defined on this property\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#minzoom"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}},t.a=u,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlFillExtrusionLayer/MlFillExtrusionLayer.js"]={name:"MlFillExtrusionLayer",docgenInfo:u.__docgenInfo,path:"src/components/MlFillExtrusionLayer/MlFillExtrusionLayer.js"})},257:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(76),i=r(1),s=function(e){var t=Object(o.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(a.useRef)(!1),s=Object(a.useRef)(e.imageId||"img_"+(new Date).getTime()),c=Object(a.useRef)(e.layerId||"MlImageMarkerLayer-"+t.componentId);Object(a.useEffect)((function(){if(t.mapIsReady&&(!t.map||t.map.getLayer(c.current))&&e.options){var r;if(e.options.layout)for(r in e.options.layout)t.map.setLayoutProperty(c.current,r,e.options.layout[r]);if(e.options.paint)for(r in e.options.paint)t.map.setPaintProperty(c.current,r,e.options.paint[r])}}),[e.options,c.current,e.mapId]);var l=Object(a.useCallback)((function(){var r=Object(n.a)({id:c.current,layout:{}},e.options);r.layout["icon-image"]=s.current,t.map.addLayer(r,e.insertBeforeLayer,t.componentId)}),[e,t.mapIsReady,t.map]);return Object(a.useEffect)((function(){e.options&&t.mapIsReady&&!r.current&&(r.current=!0,e.imgSrc&&t.map.loadImage(e.imgSrc,(function(e,r){if(e)throw e;t.map.addImage(s.current,r,t.componentId)})),l())}),[t.mapIsReady,t.map,l,e]),Object(a.useEffect)((function(){t.mapIsReady&&(!t.map||t.map.getLayer(c.current))&&e.options&&t.map.getSource(c.current).setData(e.options.source.data)}),[e.options.source.data,e]),Object(i.jsx)(i.Fragment,{})};s.__docgenInfo={description:"",methods:[],displayName:"MlImageMarkerLayer"},t.a=s,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlImageMarkerLayer/MlImageMarkerLayer.js"]={name:"MlImageMarkerLayer",docgenInfo:s.__docgenInfo,path:"src/components/MlImageMarkerLayer/MlImageMarkerLayer.js"})},258:function(e,t,r){"use strict";var n=r(15),a=r(0),o=r(344),i=r.n(o),s=(r(1106),r(34)),c=r(1),l=function(e){var t=Object(a.useContext)(s.b),r=Object(a.useRef)(!1),o=Object(a.useRef)(null),l=Object(a.useState)(50),u=Object(n.a)(l,2),p=u[0],d=u[1],f=Object(a.useRef)(50),m=Object(a.useState)(50),h=Object(n.a)(m,2),g=h[0],y=h[1],b=Object(a.useRef)(50),v=Object(a.useRef)(e.magnifierRadius),j=Object(a.useState)(v.current),O=Object(n.a)(j,2),x=O[0],S=O[1],M=Object(a.useCallback)((function(){return!(!e.map1Id||!e.map2Id)&&!(!t.getMap(e.map1Id)||!t.getMap(e.map2Id))}),[e,t]),C=Object(a.useRef)((function(){M()&&L({clientX:f.current,clientY:b.current})}));Object(a.useEffect)((function(){window.addEventListener("resize",C.current);var e=C.current;return function(){window.removeEventListener("resize",e),o.current&&o.current()}}),[]);var L=Object(a.useCallback)((function(r){if(M()){var n=t.maps[e.map1Id].getCanvas().getBoundingClientRect(),a=r.clientX||(void 0!==r.touches&&void 0!==r.touches[0]?r.touches[0].clientX:0),o=r.clientY||(void 0!==r.touches&&void 0!==r.touches[0]?r.touches[0].clientY:0);a-=n.x,o-=n.y;var i=(a/n.width*100).toFixed(2),s=(o/n.height*100).toFixed(2);f.current===i&&b.current===s||(d(i),f.current=i,y(s),b.current=s,t.maps[e.map2Id].getContainer().style.clipPath="circle(".concat(v.current,"px at ")+f.current*n.width/100+"px "+b.current*n.height/100+"px)")}}),[t,M,e]);Object(a.useEffect)((function(){M()&&!r.current&&(r.current=!0,o.current=i()(t.getMap(e.map1Id).map,t.getMap(e.map2Id).map),t.maps[e.map1Id].getCanvas().clientWidth>t.maps[e.map1Id].getCanvas().clientHeight&&2*v.current>t.maps[e.map1Id].getCanvas().clientHeight&&(v.current=Math.floor(t.maps[e.map1Id].getCanvas().clientHeight/2),S(v.current)),t.maps[e.map1Id].getCanvas().clientHeight>t.maps[e.map1Id].getCanvas().clientWidth&&2*v.current>t.maps[e.map1Id].getCanvas().clientWidth&&(v.current=Math.floor(t.maps[e.map1Id].getCanvas().clientWidth/2),S(v.current)),L({clientX:t.maps[e.map1Id].getCanvas().clientWidth/2,clientY:t.maps[e.map1Id].getCanvas().clientHeight/2}))}),[t.mapIds,t,M,e,L]);var w=function(e){e.touches?(document.addEventListener("touchmove",L),document.addEventListener("touchend",I)):(document.addEventListener("mousemove",L),document.addEventListener("mouseup",E))},I=function e(){document.removeEventListener("touchmove",L),document.removeEventListener("touchend",e)},E=function e(){document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",e)};return Object(c.jsx)("div",{style:{position:"absolute",left:p+"%",top:g+"%",borderRadius:"50%",width:2*x+1+"px",height:2*x+1+"px",background:"rgba(0,0,0,0)",border:"2px solid #fafafa",boxShadow:"1px 2px 2px rgba(19, 19, 19, .5), inset 1px 1px 1px rgba(19, 19, 19, .2)",cursor:"pointer",zIndex:"110",marginLeft:-1*x-1+"px",marginTop:-1*x-1+"px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none"},onTouchStart:w,onMouseDown:w,onWheel:function(e){var r=new WheelEvent(e.type,e);t.map.getCanvas().dispatchEvent(r)}})};l.defaultProps={magnifierRadius:200},l.__docgenInfo={description:'Hides the MapLibreMap referenced by props.map2Id except for the "magnifier"-circle that reveals\nthe map and can be dragged around on top of the MapLibreMap referenced by props.map1Id\n\n@component',methods:[],displayName:"MlLayerMagnify",props:{magnifierRadius:{defaultValue:{value:"200",computed:!1},type:{name:"number"},required:!1,description:'Size of the "magnifier"-circle'},map1Id:{type:{name:"string"},required:!1,description:"Id of the first MapLibre instance"},map2Id:{type:{name:"string"},required:!1,description:"Id of the second MapLibre instance"}}},t.a=l,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerMagnify/MlLayerMagnify.js"]={name:"MlLayerMagnify",docgenInfo:l.__docgenInfo,path:"src/components/MlLayerMagnify/MlLayerMagnify.js"})},259:function(e,t,r){"use strict";var n=r(15),a=r(0),o=r(344),i=r.n(o),s=(r(1108),r(34)),c=r(1),l=function(e){var t=Object(a.useContext)(s.b),r=Object(a.useRef)(!1),o=Object(a.useState)(50),l=Object(n.a)(o,2),u=l[0],p=l[1],d=Object(a.useRef)(50),f=Object(a.useRef)(null),m=Object(a.useCallback)((function(){return!(!e.map1Id||!e.map2Id)&&!(!t.getMap(e.map1Id)||!t.getMap(e.map2Id))}),[t,e.map1Id,e.map2Id]),h=function(){f.current&&f.current()},g=Object(a.useCallback)((function(r){if(m()){var n=t.maps[e.map1Id].getCanvas().getBoundingClientRect(),a=r.clientX||(void 0!==r.touches&&void 0!==r.touches[0]?r.touches[0].clientX:0),o=((a-=n.x)/n.width*100).toFixed(2);if(d.current!==o){p(o),d.current=o;var i="rect(0, "+d.current*n.width/100+"px, 999em, 0)";t.maps[e.map2Id].getContainer().style.clip=i}}}),[t,m,e.map1Id,e.map2Id]);Object(a.useEffect)((function(){return h}),[]),Object(a.useEffect)((function(){m()&&!r.current&&(r.current=!0,f.current=i()(t.getMap(e.map1Id).map,t.getMap(e.map2Id).map),g({clientX:t.maps[e.map1Id].getCanvas().clientWidth/2}))}),[t.mapIds,t,e,g,m]);var y=function(e){e.touches?(document.addEventListener("touchmove",g),document.addEventListener("touchend",b)):(document.addEventListener("mousemove",g),document.addEventListener("mouseup",v))},b=function e(){document.removeEventListener("touchmove",g),document.removeEventListener("touchend",e)},v=function e(){document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",e)};return Object(c.jsx)("div",{style:{position:"absolute",left:u+"%",top:"50%",borderRadius:"50%",width:"100px",height:"100px",background:"#0066ff",border:"3px solid #eaebf1",cursor:"pointer",zIndex:"110",marginLeft:"-50px",marginTop:"-50px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none"},onTouchStart:y,onMouseDown:y})};l.__docgenInfo={description:"MlLayerSwipe returns a Button that will add a standard OSM tile layer to the maplibre-gl instance, that you can move like a curtain.\n\n@component",methods:[],displayName:"MlLayerSwipe",props:{map1Id:{type:{name:"string"},required:!1,description:"Id of the first MapLibre instance."},map2Id:{type:{name:"string"},required:!1,description:"Id of the second MapLibre instance."}}},t.a=l,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerSwipe/MlLayerSwipe.js"]={name:"MlLayerSwipe",docgenInfo:l.__docgenInfo,path:"src/components/MlLayerSwipe/MlLayerSwipe.js"})},260:function(e,t,r){"use strict";var n=r(213),a=r(5),o=r(15),i=r(0),s=r(34),c=r(168),l=r(1166),u=r(647),p=r.n(u),d=r(648),f=r.n(d),m=r(646),h=r.n(m),g=r(96),y=r(186),b=r(183),v=r(353),j=r(1),O=["color"],x=function(e){var t=Object(i.useContext)(s.b),r=Object(i.useRef)(!1),u=Object(i.useRef)(void 0),d=Object(i.useRef)((e.idPrefix?e.idPrefix:"MlComponentTemplate-")+Object(g.a)()),m=Object(i.useState)(0),x=Object(o.a)(m,2),S=x[0],M=x[1],C=Object(i.useState)(!1),L=Object(o.a)(C,2),w=L[0],I=L[1],E=Object(v.a)("(max-width:900px)"),T={minWidth:"20px",minHeight:"20px",width:E?"50px":"30px",height:E?"50px":"30px",backgroundColor:"#414141",borderRadius:"23%",margin:.15,fontSize:E?"1.5em":"1.2em",":hover":{backgroundColor:"#515151"},color:"#ececec"};Object(i.useEffect)((function(){var e=d.current;return function(){u.current&&(u.current.cleanup(e),u.current=void 0),r.current=!1}}),[]),Object(i.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,u.current=t.getMap(e.mapId),u.current.on("pitchend",(function(){M(u.current.getPitch())}),d.current),M(u.current.getPitch()))}),[t.mapIds,t,e.mapId]);var _,R=function(e){u.current.setCenter([e.coords.longitude,e.coords.latitude])},A=function(){console.log("Access of user location denied"),I(!0)};return Object(j.jsxs)("div",{style:{zIndex:501,position:"absolute",right:E?"15px":"5px",bottom:E?"40px":"20px",display:"flex",flexDirection:"column"},children:[Object(j.jsx)(y.a,{style:{width:"31px",position:"relative",height:E?"55px":"45px",marginLeft:E?"3px":"-5px",transform:E?"scale(1.6)":"scale(1)"},backgroundStyle:{boxShadow:"0px 0px 18px rgba(0,0,0,.5)"}}),Object(j.jsx)(c.a,{sx:Object(a.a)(Object(a.a)({},T),{},{fontWeight:600}),onClick:function(){if(u.current){var e=60;0!==u.current.getPitch()&&(e=0),u.current.easeTo({pitch:e})}},children:S?"2D":"3D"}),Object(j.jsx)(c.a,{sx:T,onClick:function(){navigator.geolocation.getCurrentPosition(R,A)},disabled:w,children:Object(j.jsx)(h.a,{sx:{fontSize:E?"1.5em":"1.2em"}})}),Object(j.jsx)(b.a,{style:Object(a.a)({},(_=T,Object(n.a)(_,O)))}),Object(j.jsxs)(l.a,{orientation:"vertical",sx:{width:"50px",border:"none",Button:{minWidth:"20px !important",border:"none",padding:0},"Button:hover":{border:"none"}},children:[Object(j.jsx)(c.a,{sx:Object(a.a)(Object(a.a)({},T),{},{color:"#ececec"}),onClick:function(){u.current&&u.current.transform._zoom+.5<=u.current.transform._maxZoom&&u.current.easeTo({zoom:u.current.transform._zoom+.5})},children:Object(j.jsx)(p.a,{sx:{fontSize:E?"1.5em":"1.2em"}})}),Object(j.jsx)(c.a,{sx:Object(a.a)(Object(a.a)({},T),{},{color:"#ececec"}),onClick:function(){u.current&&u.current.transform._zoom-.5>=u.current.transform._minZoom&&u.current.easeTo({zoom:u.current.transform._zoom-.5})},children:Object(j.jsx)(f.a,{sx:{fontSize:E?"1.5em":"1.2em"}})})]})]})};x.__docgenInfo={description:"",methods:[],displayName:"MlNavigationTools"},t.a=x,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlNavigationTools/MlNavigationTools.js"]={name:"MlNavigationTools",docgenInfo:x.__docgenInfo,path:"src/components/MlNavigationTools/MlNavigationTools.js"})},261:function(e,t,r){"use strict";var n=r(5),a=r(15),o=r(0),i=r(34),s=r(96),c=r(168),l=r(1),u=function(e){var t=Object(o.useContext)(i.b),r=Object(o.useRef)(void 0),u=Object(o.useState)(!0),p=Object(a.a)(u,2),d=p[0],f=p[1],m=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-")+Object(s.a)()),h=Object(o.useRef)(!1),g=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-source-")+Object(s.a)()),y=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-layer-")+Object(s.a)());return Object(o.useEffect)((function(){var e=m.current;return function(){r.current&&(r.current.cleanup(e),r.current=null)}}),[]),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!h.current&&(h.current=!0,r.current=t.getMap(e.mapId),r.current.addSource(g.current,Object(n.a)({type:"raster",tileSize:256},e.sourceOptions),m.current),r.current.addLayer(Object(n.a)({id:y.current,type:"raster",source:g.current,minzoom:0,maxzoom:22},e.layerOptions),e.insertBeforeLayer,m.current))}),[t.mapIds,e,t]),Object(o.useEffect)((function(){r.current&&(d?r.current.setLayoutProperty(y.current,"visibility","visible"):r.current.setLayoutProperty(y.current,"visibility","none"))}),[d]),Object(l.jsx)(c.a,{color:"primary",variant:d?"contained":"outlined",onClick:function(){return f(!d)},children:"OSM"})};u.__docgenInfo={description:"Adds a standard OSM tile layer to the maplibre-gl instancereference by\nprops.mapId\n\n@component",methods:[],displayName:"MlOsmLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},sourceOptions:{type:{name:"object"},required:!1,description:"Options object that will be used as first parameter on the MapLibreGl.addSource call see MapLibre source options documentation."},layerOptions:{type:{name:"object"},required:!1,description:"Options object that will be used as first parameter on the MapLibreGl.addLayer call see MapLibre layer options documentation."},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}},t.a=u,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlOsmLayer/MlOsmLayer.js"]={name:"MlOsmLayer",docgenInfo:u.__docgenInfo,path:"src/components/MlOsmLayer/MlOsmLayer.js"})},263:function(e,t,r){"use strict";var n=r(56),a=r(0),o=r(34),i=r(160),s=r(450),c=r(65),l=r(96),u=r(3),p=r.n(u),d=r(1),f=function(e){var t=Object(a.useContext)(o.b),r=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlSpatialElevationProfile-")+Object(l.a)()),u=Object(a.useRef)(null),p=Object(a.useRef)(!1),f=Object(a.useContext)(i.b),m=Object(a.useRef)("elevationprofile-"+Object(l.a)()),h=Object(a.useRef)("elevationprofile-layer-"+Object(l.a)()),g=Object(a.useCallback)((function(t,r,n,a,o){var i=Object(s.a)([[t,r],[a,o]]),l=Object(c.lineOffset)(i,5,{units:"meters"}),u=l.geometry.coordinates[0][0],p=l.geometry.coordinates[0][1],d=l.geometry.coordinates[1][0],f=l.geometry.coordinates[1][1];return Object(s.b)([[[t,r],[a,o],[d,f],[u,p],[t,r]]],{height:n*e.elevationFactor})}),[e.elevationFactor]);return Object(a.useEffect)((function(){var e=r.current;return function(){u.current&&(u.current.cleanup(e),u.current=null)}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!p.current&&(p.current=!0,u.current=t.getMap(e.mapId),u.current.addSource(m.current,{type:"geojson",data:f.data},r.current),u.current.addLayer({id:h.current,source:m.current,type:"fill-extrusion",paint:{"fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.9,"fill-extrusion-color":["interpolate",["linear"],["get","height"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"yellow"]}},e.insertBeforeLayer,r.current))}),[t.mapIds,e.insertBeforeLayer,e.mapId,f,t]),Object(a.useEffect)((function(){var t;if(u.current&&u.current.getLayer(h.current)){var r=f.data;if(r&&r.features){var a=r.features.find((function(e){return"LineString"===e.geometry.type}));if(a&&a.geometry){var o=a.geometry.coordinates.map((function(e,t){return e[2]})),i=Math.min.apply(Math,Object(n.a)(o)),s=Math.max.apply(Math,Object(n.a)(o))-i;s=0===s?1:s,u.current.setPaintProperty(h.current,"fill-extrusion-color",["interpolate",["linear"],["get","height"],0,"rgb(0,255,55)",s*e.elevationFactor,"rgb(255,0,0)"]);var l=function(e,t,r){return e*(1-r)+t*r},p=[];a.geometry.coordinates.forEach((function(e,t){if(a.geometry.coordinates[t+1]){var r=~~(1e3*Object(c.distance)([e[0],e[1]],[a.geometry.coordinates[t+1][0],a.geometry.coordinates[t+1][1]],{units:"kilometers"})/10);r=r<1?1:r;for(var n=0;n<r;n++){var o=l(a.geometry.coordinates[t][0],a.geometry.coordinates[t+1][0],n/r),s=l(a.geometry.coordinates[t][1],a.geometry.coordinates[t+1][1],n/r),u=l(a.geometry.coordinates[t][2]-i,a.geometry.coordinates[t+1][2]-i,n/r),d=l(a.geometry.coordinates[t][0],a.geometry.coordinates[t+1][0],(n+1)/r),f=l(a.geometry.coordinates[t][1],a.geometry.coordinates[t+1][1],(n+1)/r),m=g(o,s,u,d,f);p.push(m)}}}));var d=f.getEmptyFeatureCollection();d.features=p,null===(t=u.current.getSource(m.current))||void 0===t||t.setData(d)}}}}),[f.data,g,f,e.elevationFactor,t]),Object(d.jsx)(d.Fragment,{})};f.defaultProps={elevationFactor:1},f.propTypes={mapId:p.a.string,idPrefix:p.a.string,elevationFactor:p.a.number,insertBeforeLayer:p.a.string},f.__docgenInfo={description:"MlSpatialElevationProfile returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n\n@component",methods:[],displayName:"MlSpatialElevationProfile",props:{elevationFactor:{defaultValue:{value:"1",computed:!1},type:{name:"number"},required:!1,description:"Number describes the factor of the height of the elevation"},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}},t.a=f,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.js"]={name:"MlSpatialElevationProfile",docgenInfo:f.__docgenInfo,path:"src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.js"})},264:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(76),i=r(3),s=r.n(i),c=r(1),l=function(e){var t=Object(o.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(a.useRef)({}),i=Object(a.useRef)(e.layerId||"MlVectorTileLayer-"+t.componentId),s=Object(a.useRef)({}),l=Object(a.useRef)({}),u=Object(a.useRef)(!1);return Object(a.useEffect)((function(){if(t.map&&!u.current)for(var a in u.current=!0,t.map.addSource(i.current,Object(n.a)({type:"vector",tiles:[e.url],tileSize:512,attribution:""},e.sourceOptions),t.componentId),e.layers){var o=i.current+"_"+a;r.current[a]=o,t.map.addLayer(Object(n.a)({id:o,source:i.current,type:"line",minzoom:0,maxzoom:22,layout:{},paint:{"line-opacity":.5,"line-color":"rgb(80, 80, 80)","line-width":2}},e.layers[a]),e.insertBeforeLayer,t.componentId),s.current[a]=JSON.stringify(e.layers[a].paint),l.current[a]=JSON.stringify(e.layers[a].layout)}}),[t.map,e]),Object(a.useEffect)((function(){if(t.map&&u.current)for(var n in e.layers)if(t.map.getLayer(r.current[n])){var a=JSON.stringify(e.layers[n].paint);if(a!==s.current[n])for(var o in e.layers[n].paint)t.map.setPaintProperty(r.current[n],o,e.layers[n].paint[o]);s.current[n]=a;var i=JSON.stringify(e.layers[n].layout);if(i!==l.current[n])for(var c in e.layers[n].layout)t.map.setLayoutProperty(r.current[n],c,e.layers[n].layout[c]);l.current[n]=i}}),[e.layers,t.map]),Object(c.jsx)(c.Fragment,{})};l.propTypes={mapId:s.a.string,sourceOptions:s.a.object,layers:s.a.object,url:s.a.string},l.__docgenInfo={description:"Adds a vector-tile source and 0...n vector-tile-layers to the MapLibre instance referenced by\nprops.mapId\n\n@component",methods:[],displayName:"MlVectorTileLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},sourceOptions:{type:{name:"object"},required:!1,description:"Options object that will be used as first parameter on the MapLibreGl.addSource call see MapLibre source options documentation."},layers:{type:{name:"object"},required:!1,description:"Object that hold layers"},url:{type:{name:"string"},required:!1,description:"String of the URL of a wms layer"}}},t.a=l,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlVectorTileLayer/MlVectorTileLayer.js"]={name:"MlVectorTileLayer",docgenInfo:l.__docgenInfo,path:"src/components/MlVectorTileLayer/MlVectorTileLayer.js"})},265:function(e,t,r){"use strict";var n=r(15),a=r(0),o=(r(1089),r(1090),r(448)),i=r.n(o),s="mapbox-gl-draw_boxselect",c="add",l="move",u="pointer",p="none",d="polygon",f="Feature",m="Polygon",h="LineString",g="Point",y="Multi",b="MultiPoint",v="MultiLineString",j="MultiPolygon",O="draw.create",x="draw.update",S="draw.combine",M="draw.uncombine",C="move",L="change_coordinates",w="feature",I="midpoint",E="vertex",T="true",_="false";function R(e){return function(t){var r=t.featureTarget;return!!r&&(!!r.properties&&r.properties.meta===e)}}function A(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===T&&e.featureTarget.properties.meta===w))}function P(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===_&&e.featureTarget.properties.meta===w))}function k(e){return void 0===e.featureTarget}function H(e){var t=e.featureTarget;return!!t&&(!!t.properties&&t.properties.meta===E)}function F(e){return!!e.originalEvent&&!0===e.originalEvent.shiftKey}var N={enable:function(e){setTimeout((function(){e.map&&e.map.doubleClickZoom&&e._ctx&&e._ctx.store&&e._ctx.store.getInitialConfigValue&&e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()}),0)},disable:function(e){setTimeout((function(){e.map&&e.map.doubleClickZoom&&e.map.doubleClickZoom.disable()}),0)}};var B=function(e,t){return!!e.lngLat&&(e.lngLat.lng===t[0]&&e.lngLat.lat===t[1])},U=function(e,t,r,n){return{type:f,properties:{meta:E,parent:e,coord_path:r,active:n?T:_},geometry:{type:g,coordinates:t}}},G={onSetup:function(){console.log("Change mode: custom polygon");var e=this.newFeature({type:f,properties:{},geometry:{type:m,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),N.disable(this),this.updateUIClasses({mouse:c}),this.activateUIButton(d),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&B(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode("custom_select",{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:c}),e.polygon.updateCoordinate("0.".concat(e.currentVertexPosition),t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate("0.".concat(e.currentVertexPosition),t.lngLat.lng,t.lngLat.lat),this.map.fire(O,{features:[e.polygon.toGeoJSON()]})},clickOnVertex:function(e){return this.changeMode("custom_select",{featureIds:[e.polygon.id]})},onMouseMove:function(e,t){e.polygon.updateCoordinate("0.".concat(e.currentVertexPosition),t.lngLat.lng,t.lngLat.lat),H(t)&&this.updateUIClasses({mouse:u})}};G.onTap=G.onClick=function(e,t){return H(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},G.onKeyUp=function(e,t){!function(e){return 27===e.keyCode}(t)?function(e){return 13===e.keyCode}(t)&&this.changeMode("custom_select",{featureIds:[e.polygon.id]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode("custom_select"))},G.onStop=function(e){this.updateUIClasses({mouse:p}),N.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.polygon.id)&&(e.polygon.removeCoordinate("0.".concat(e.currentVertexPosition)),e.polygon.isValid()?this.map.fire(O,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode("custom_select",{},{silent:!0})))},G.toDisplayFeatures=function(e,t,r){var n=t.properties.id===e.polygon.id;if(t.properties.active=n?T:_,!n)return r(t);if(0!==t.geometry.coordinates.length){var a=t.geometry.coordinates[0].length;if(!(a<3)){if(t.properties.meta=w,r(U(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),a>3){var o=t.geometry.coordinates[0].length-3;r(U(e.polygon.id,t.geometry.coordinates[0][o],"0.".concat(o),!1))}if(a<=4){var i=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:f,properties:t.properties,geometry:{coordinates:i,type:h}}),3===a)return}return r(t)}}},G.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode("custom_select")};var D=G,q=r(634),z=r.n(q);var V=function(e,t){var r=t.getBoundingClientRect();return new z.a(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))},W=function(e,t,r){var n=t.geometry.coordinates,a=r.geometry.coordinates;if(n[1]>85||n[1]<-85||a[1]>85||a[1]<-85)return null;var o={lng:(n[0]+a[0])/2,lat:(n[1]+a[1])/2};return{type:f,properties:{meta:I,parent:e,lng:o.lng,lat:o.lat,coord_path:r.properties.coord_path},geometry:{type:g,coordinates:[o.lng,o.lat]}}};var K=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.geometry,o=a.type,i=a.coordinates,s=t.properties&&t.properties.id,c=[];function l(e,t){var n="",a=null;e.forEach((function(e,o){var i=null!=t?"".concat(t,".").concat(o):String(o),l=U(s,e,i,u(i));if(r.midpoints&&a){var p=W(s,a,l);p&&c.push(p)}a=l;var d=JSON.stringify(e);n!==d&&c.push(l),0===o&&(n=d)}))}function u(e){return!!r.selectedPaths&&-1!==r.selectedPaths.indexOf(e)}function p(){var n=o.replace(y,"");i.forEach((function(a,o){var i={type:f,properties:t.properties,geometry:{type:n,coordinates:a}};c=c.concat(e(i,r,o))}))}return o===g?c.push(U(s,i,n,u(n))):o===m?i.forEach((function(e,t){l(e,null!==n?"".concat(n,".").concat(t):String(t))})):o===h?l(i,n):0===o.indexOf(y)&&p(),c};function J(e){if(this._items={},this._nums={},this._length=e?e.length:0,e)for(var t=0,r=e.length;t<r;t++)this.add(e[t]),void 0!==e[t]&&("string"==typeof e[t]?this._items[e[t]]=t:this._nums[e[t]]=t)}J.prototype.add=function(e){return this.has(e)||(this._length++,"string"==typeof e?this._items[e]=this._length:this._nums[e]=this._length),this},J.prototype.delete=function(e){return!1===this.has(e)||(this._length--,delete this._items[e],delete this._nums[e]),this},J.prototype.has=function(e){return("string"==typeof e||"number"==typeof e)&&(void 0!==this._items[e]||void 0!==this._nums[e])},J.prototype.values=function(){var e=this,t=[];return Object.keys(this._items).forEach((function(r){t.push({k:r,v:e._items[r]})})),Object.keys(this._nums).forEach((function(r){t.push({k:JSON.parse(r),v:e._nums[r]})})),t.sort((function(e,t){return e.v-t.v})).map((function(e){return e.k}))},J.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Y=J,X=r(635),Z=r.n(X),Q=function(e,t){var r=-90,n=90,a=-90,o=90,i=270,s=-270;e.forEach((function(e){var t=Z()(e),c=t[1],l=t[3],u=t[0],p=t[2];c>r&&(r=c),l<n&&(n=l),l>a&&(a=l),c<o&&(o=c),u<i&&(i=u),p>s&&(s=p)}));var c=t;return r+c.lat>85&&(c.lat=85-r),a+c.lat>90&&(c.lat=90-a),n+c.lat<-85&&(c.lat=-85-n),o+c.lat<-90&&(c.lat=-90-o),i+c.lng<=-270&&(c.lng+=360*Math.ceil(Math.abs(c.lng)/360)),s+c.lng>=270&&(c.lng-=360*Math.ceil(Math.abs(c.lng)/360)),c},$=function(e,t){var r=Q(e.map((function(e){return e.toGeoJSON()})),t);e.forEach((function(e){var t,n=e.getCoordinates(),a=function(e){var t={lng:e[0]+r.lng,lat:e[1]+r.lat};return[t.lng,t.lat]},o=function(e){return e.map((function(e){return a(e)}))};e.type===g?t=a(n):e.type===h||e.type===b?t=n.map(a):e.type===m||e.type===v?t=n.map(o):e.type===j&&(t=n.map((function(e){return e.map((function(e){return o(e)}))}))),e.incomingCoords(t)}))},ee={onSetup:function(e){var t=this;console.log("Change mode: custom select");var r={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(r.initiallySelectedFeatureIds.filter((function(e){return void 0!==t.getFeature(e)}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),r},fireUpdate:function(){this.map.fire(x,{action:C,features:this.getSelected().map((function(e){return e.toGeoJSON()}))})},fireActionable:function(){var e=this,t=this.getSelected(),r=t.filter((function(t){return e.isInstanceOf("MultiFeature",t)})),n=!1;if(t.length>1){n=!0;var a=t[0].type.replace("Multi","");t.forEach((function(e){e.type.replace("Multi","")!==a&&(n=!1)}))}var o=r.length>0,i=t.length>0;this.setActionableState({combineFeatures:n,uncombineFeatures:o,trash:i})},getUniqueIds:function(e){return e.length?e.map((function(e){return e.properties.id})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.add(t),e}),new Y).values():[]},stopExtendedInteractions:function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1},onStop:function(){N.enable(this)},onMouseMove:function(e){return this.stopExtendedInteractions(e)},onMouseOut:function(e){if(e.dragMoving)return this.fireUpdate()}};ee.onTap=ee.onClick=function(e,t){return k(t)?this.clickAnywhere(e,t):R(E)(t)?this.clickOnVertex(e,t):function(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&e.featureTarget.properties.meta===w)}(t)?this.clickOnFeature(e,t):void 0},ee.clickAnywhere=function(e){var t=this,r=this.getSelectedIds();r.length&&(this.clearSelectedFeatures(),r.forEach((function(e){return t.doRender(e)}))),N.enable(this),this.stopExtendedInteractions(e)},ee.clickOnVertex=function(e,t){this.changeMode("custom_direct_select",{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:l})},ee.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},ee.clickOnFeature=function(e,t){var r=this;N.disable(this),this.stopExtendedInteractions(e);var n=F(t),a=this.getSelectedIds(),o=t.featureTarget.properties.id,i=this.isSelected(o);if(!n&&i&&this.getFeature(o).type!==g)return this.changeMode("custom_direct_select",{featureId:o});i&&n?(this.deselect(o),this.updateUIClasses({mouse:u}),1===a.length&&N.enable(this)):!i&&n?(this.select(o),this.updateUIClasses({mouse:l})):i||n||(a.forEach((function(e){return r.doRender(e)})),this.setSelected(o),this.updateUIClasses({mouse:l})),this.doRender(o)},ee.onMouseDown=function(e,t){return A(t)?this.startOnActiveFeature(e,t):this.drawConfig.boxSelect&&function(e){return!!e.originalEvent&&(!!e.originalEvent.shiftKey&&0===e.originalEvent.button)}(t)?this.startBoxSelect(e,t):void 0},ee.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=V(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0},ee.onTouchStart=function(e,t){if(A(t))return this.startOnActiveFeature(e,t)},ee.onDrag=function(e,t){return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0},ee.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:c}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(s),this.map.getContainer().appendChild(e.boxSelectElement));var r=V(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),a=Math.max(e.boxSelectStartLocation.x,r.x),o=Math.min(e.boxSelectStartLocation.y,r.y),i=Math.max(e.boxSelectStartLocation.y,r.y),l="translate(".concat(n,"px, ").concat(o,"px)");e.boxSelectElement.style.transform=l,e.boxSelectElement.style.WebkitTransform=l,e.boxSelectElement.style.width="".concat(a-n,"px"),e.boxSelectElement.style.height="".concat(i-o,"px")},ee.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();var r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};$(this.getSelected(),r),e.dragMoveLocation=t.lngLat},ee.onMouseUp=function(e,t){var r=this;if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){var n=[e.boxSelectStartLocation,V(t.originalEvent,this.map.getContainer())],a=this.featuresAt(null,n,"click"),o=this.getUniqueIds(a).filter((function(e){return!r.isSelected(e)}));o.length&&(this.select(o),o.forEach((function(e){return r.doRender(e)})),this.updateUIClasses({mouse:l}))}this.stopExtendedInteractions(e)},ee.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?T:_,r(t),this.fireActionable(),t.properties.active===T&&t.geometry.type!==g&&K(t).forEach(r)},ee.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},ee.onCombineFeatures=function(){var e=this.getSelected();if(!(0===e.length||e.length<2)){for(var t=[],r=[],n=e[0].type.replace("Multi",""),a=0;a<e.length;a++){var o=e[a];if(o.type.replace("Multi","")!==n)return;o.type.includes("Multi")?o.getCoordinates().forEach((function(e){t.push(e)})):t.push(o.getCoordinates()),r.push(o.toGeoJSON())}if(r.length>1){var i=this.newFeature({type:f,properties:r[0].properties,geometry:{type:"Multi".concat(n),coordinates:t}});this.addFeature(i),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([i.id]),this.map.fire(S,{createdFeatures:[i.toGeoJSON()],deletedFeatures:r})}this.fireActionable()}},ee.onUncombineFeatures=function(){var e=this,t=this.getSelected();if(0!==t.length){for(var r=[],n=[],a=function(a){var o=t[a];e.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach((function(t){e.addFeature(t),t.properties=o.properties,r.push(t.toGeoJSON()),e.select([t.id])})),e.deleteFeature(o.id,{silent:!0}),n.push(o.toGeoJSON()))},o=0;o<t.length;o++)a(o);r.length>1&&this.map.fire(M,{createdFeatures:r,deletedFeatures:n}),this.fireActionable()}};var te=ee,re={getMatchingVertices:function(e,t,r,n){for(var a=[],o=e[0].toFixed(5),i=e[1].toFixed(5),s=0;s<r.length;s++)if(r[s].id!==t)for(var c=0;c<r[s].geometry.coordinates.length;c++)for(var l=0;l<r[s].geometry.coordinates[c].length;l++)o===r[s].geometry.coordinates[c][l][0].toFixed(5)&&i===r[s].geometry.coordinates[c][l][1].toFixed(5)&&a.push({featureId:r[s].id,coord_path:c+"."+l,lng:r[s].geometry.coordinates[c][l][0],lat:r[s].geometry.coordinates[c][l][1]});return a},getDrawInstance:function(e){for(var t=e._controls.length-1;t>=0;t--)if(e._controls[t].options&&"custom_select"===e._controls[t].options.defaultMode)return e._controls[t];return null}},ne=R(E),ae=R(I),oe={fireUpdate:function(){this.map.fire(x,{action:L,features:this.getSelected().map((function(e){return e.toGeoJSON()}))})},fireActionable:function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})},startDragging:function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},stopDragging:function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null},onVertex:function(e,t){this.startDragging(e,t);var r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);F(t)||-1!==n?F(t)&&-1===n&&e.selectedCoordPaths.push(r.coord_path):e.selectedCoordPaths=[r.coord_path];var a=re.getDrawInstance(this.map).getAll(),o=re.getMatchingVertices(t.featureTarget._geometry.coordinates,t.featureTarget.properties.parent,a.features,this.map);e.groupMove_vertices=o;for(var i=0;i<e.groupMove_vertices.length;i++)e.groupMove_vertices[i].feature=this.getFeature(e.groupMove_vertices[i].featureId);var s=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(s)},onMidpoint:function(e,t){this.startDragging(e,t);var r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]},pathsToCoordinates:function(e,t){return t.map((function(t){return{feature_id:e,coord_path:t}}))},onFeature:function(e,t){0===e.selectedCoordPaths.length?this.startDragging(e,t):this.stopDragging(e)},dragFeature:function(e,t,r){$(this.getSelected(),r),e.dragMoveLocation=t.lngLat},dragVertex:function(e,t,r){for(var n=e.selectedCoordPaths.map((function(t){return e.feature.getCoordinate(t)})),a=n.map((function(e){return{type:f,properties:{},geometry:{type:g,coordinates:e}}})),o=Q(a,r),i=0;i<n.length;i++){var s=n[i];e.feature.updateCoordinate(e.selectedCoordPaths[i],s[0]+o.lng,s[1]+o.lat);for(var c=0;c<e.groupMove_vertices.length;c++){var l=e.groupMove_vertices[c].coord_path.split(".");if(void 0!==l[0]&&void 0!==l[1]&&void 0!==e.groupMove_vertices[c].feature.coordinates[l[0]]&&void 0!==e.groupMove_vertices[c].feature.coordinates[l[0]][l[1]]){var u=e.groupMove_vertices[c].feature.coordinates[l[0]][l[1]];e.groupMove_vertices[c].feature.updateCoordinate(e.groupMove_vertices[c].coord_path,u[0]+o.lng,u[1]+o.lat)}}}},clickNoTarget:function(){this.changeMode("custom_select")},clickInactive:function(){this.changeMode("custom_select")},clickActiveFeature:function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()},onSetup:function(e){var t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===g)throw new TypeError("direct_select mode doesn't handle point features");var n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[],groupMove_vertices:e.groupMove_vertices?e.groupMove_vertices:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),N.disable(this),this.setActionableState({trash:!0}),n},onStop:function(){N.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(e,t,r){e.featureId===t.properties.id?(t.properties.active=T,r(t),K(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=_,r(t)),this.fireActionable(e)},onTrash:function(e){e.selectedCoordPaths.sort((function(e,t){return t.localeCompare(e,"en",{numeric:!0})})).forEach((function(t){return e.feature.removeCoordinate(t)})),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),!1===e.feature.isValid()&&(this.deleteFeature([e.featureId]),this.changeMode("custom_select",{}))},onMouseMove:function(e,t){var r=A(t),n=ne(t),a=0===e.selectedCoordPaths.length;r&&a||n&&!a?this.updateUIClasses({mouse:l}):this.updateUIClasses({mouse:p}),this.stopDragging(e)},onMouseOut:function(e){e.dragMoving&&this.fireUpdate()}};oe.onTouchStart=oe.onMouseDown=function(e,t){return ne(t)?this.onVertex(e,t):A(t)?this.onFeature(e,t):ae(t)?this.onMidpoint(e,t):void 0},oe.onDrag=function(e,t){if(!0===e.canDragMove){e.dragMoving=!0,t.originalEvent.stopPropagation();var r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat}},oe.onClick=function(e,t){return k(t)?this.clickNoTarget(e,t):A(t)?this.clickActiveFeature(e,t):P(t)?this.clickInactive(e,t):void this.stopDragging(e)},oe.onTap=function(e,t){return k(t)?this.clickNoTarget(e,t):A(t)?this.clickActiveFeature(e,t):P(t)?this.clickInactive(e,t):void 0},oe.onTouchEnd=oe.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var ie=oe,se=r(96),ce=r(34),le=r(1);function ue(e){var t=Object(a.useRef)(null),r=Object(a.useRef)(null),o=Object(a.useContext)(ce.b),s=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlFeatureEditor-")+Object(se.a)()),c=Object(a.useRef)(e.onChange),l=Object(a.useState)(!1),u=Object(n.a)(l,2),p=u[0],d=u[1],f=Object(a.useState)(!1),m=Object(n.a)(f,2),h=m[0],g=m[1],y=Object(a.useState)(!1),b=Object(n.a)(y,2),v=b[0],j=b[1],O=function(e){console.log("MlFeatureEditor mode change to "+e.mode)},x=function(){j(Math.random())};return Object(a.useEffect)((function(){var e=s.current;return function(){t.current&&(t.current.cleanup(e),t.current=null)}}),[]),Object(a.useEffect)((function(){o.mapExists(e.mapId)&&o.getMap(e.mapId).style&&!p&&(t.current=o.getMap(e.mapId),d(!0),t.current&&t.current.style&&t.current.getSource("mapbox-gl-draw-cold")&&r.current&&void 0!==r.current.remove&&r.current.remove(),r.current=new i.a({displayControlsDefault:!1,defaultMode:e.mode||"custom_select",modes:Object.assign({custom_polygon:D,custom_select:te,custom_direct_select:ie},i.a.modes)}),t.current.on("draw.modechange",O,s.current),t.current.addControl(r.current,"top-left",s.current),t.current.on("mouseup",x,s.current),g(!0))}),[o.map,o,e,p]),Object(a.useEffect)((function(){r.current&&e.geojson&&e.geojson.geometry&&e.geojson.geometry.coordinates&&r.current.set({type:"FeatureCollection",features:[e.geojson]})}),[e.geojson,h]),Object(a.useEffect)((function(){if(r.current&&v){var e=r.current.getAll();"function"==typeof c.current&&c.current(e.features)}}),[v]),Object(a.useEffect)((function(){e.mode&&r.current&&r.current.changeMode(e.mode)}),[e.mode]),Object(le.jsx)(le.Fragment,{})}ue.__docgenInfo={description:"",methods:[],displayName:"MlFeatureEditor"};t.a=ue;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlFeatureEditor/MlFeatureEditor.js"]={name:"MlFeatureEditor",docgenInfo:ue.__docgenInfo,path:"src/components/MlFeatureEditor/MlFeatureEditor.js"})},266:function(e,t,r){"use strict";var n=r(0),a=r(34),o=r(56),i=r(161),s=r.n(i),c=r(632),l={street:["footway","street","road","street_name","residential","path","pedestrian","road_reference","road_reference_intl","square","place"],number:["house_number","street_number"],place:["city","village","hamlet","locality","croft","neighbourhood","suburb","city_district","district","quarter","borough","city_block","residential","commercial","industrial","houses","subdivision","allotments","postal_city","town","municipality","local_administrative_area"],zip:["postcode","partial_postcode"],state:["state","province","state_code"]},u=function(e){var t=[];for(var r in l)l[r].some((function(r){return!!e.hasOwnProperty(r)&&(t.push(e[r]),!0)}));return t.join(", ")},p=function(e){return 25.4,96/25.4*e+"px"},d=function(e,t,r){r(!0);var n=window.devicePixelRatio,a=document.createElement("div");a.className="hidden-map",document.body.appendChild(a);var i=document.createElement("div");i.style.width=p(210),i.style.height=p(297),a.appendChild(i);var l=new s.a.Map({container:i,center:e.getCenter(),zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1}),d=e.getStyle(),f=function(e){var t=d.sources[e];Object.keys(t).forEach((function(e){t[e]||delete t[e]}))};for(var m in d.sources)f(m);l.setStyle(d),l.once("idle",(function(){var e,i=new c.a({orientation:"p",unit:"mm",compress:!0});Object.defineProperty(window,"devicePixelRatio",{get:function(){return 3.125}});var s=(t?u(t.address):"").split(","),p=[];p.length&&s.forEach((function(e){var t=e.match(/.{1,34}/g);p.push.apply(p,Object(o.a)(t))})),i.addImage(l.getCanvas().toDataURL("image/png"),"png",0,0,210,297,null,"FAST"),i.setFillColor("white"),i.rect(138,287,297,10,"F"),i.setFontSize(10),i.text("Datenquelle: © OpenStreetMap-Mitwirkende",140,i.internal.pageSize.height-3),i.setFillColor("white");var d=3.25*p.length+3+3+6.5+4+1;i.rect(2.5,2,66.5,d,"F"),i.setFontSize(10),i.text("Karten PDF:",6,5.5),i.rect(6,7,60,3.25*p.length+4+1),i.setFontSize(10),p.forEach((function(e,t){i.text(e.trim(),8,10+3.5*t+2)})),i.addImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKgAAACxCAMAAABnTAbVAAAC8VBMVEUAAAD/AACAAACqAFW/AECZMzOqK1W2JEm/IECqHDmzGk25F0aqFUCxJzu2JEmqIkSvIEC0HjyqHEeuG0OzGkC2GD2uI0axIUO1IECtHz2xHUWzHEKtG0CwGj6zIkS1IUKyHz60HkSvHUKxHECzHD6uG0OxIUGzIECuHz6wHkOyHkG0HUCwHD6xHEOzIUGvIECxHz6zH0KvHkGxHUCyHT+vHEKwHEGyIECzHz+wH0KxHkGzHkCwHT+xHUKyHEGvIECxHz+yH0KzHkGwHkCxHj+zHUKwHUGxHECyHz+wH0GxH0GyHkCwHj+xHUGyHUGzHUCwHz+xH0GyH0GwHkCxHj+yHkGwHUCxHUCyHT+wH0GxH0CxHkCyHj+wHkGxHkCyHUCwHT+xH0GyH0CwH0CxHj+yHkGwHkCxHUCxHT+yHUGwH0CxH0CyHj+wHkGxHkCyHkCwHT+xHUGxH0CyH0CxHz+xHkGyHkCwHkCxHj+yHUGwHUCxH0CwHkGxHkCxHkCyHj+xHUGxHUCyH0CwHz+xHkGyHkCwHkCxHj+xHkGwHUCxHUCxHz+yH0GxHkCyHj+wHkGxHUCxHUCwHz+xH0GxHkCyHkCxHj+xHkGyHkCxHUCxHT+yH0GwHkCxHkCxHj+wHkGxHkCxHkCyHT+xH0GxH0CyHkCxHj+xHkGxHkCwHkCxHT+xHUCwH0CxHkCxHj+yHkCxHkCxHkCyHj+xHUCxH0CxHkCwHj+xHkCxHkCwHkCxHj+xHkCyHUCxH0CxHj+xHkCxHkCxHkCxHj+wHkCxHUCxH0CyHj+xHkCxHkCyHkCxHj+xHkCxHUCxHz+xHkCwHkCxHkCxHj+yHkCxHkCxHkCxHkCxHkCxHkCxHj+xHkCwHkCxHT+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xH0CxHkCxHkCyHj+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xHkCxHkD///9g21WfAAAA+XRSTlMAAQIDBAUGBwgJCgsMDQ4PEBESExQVFhcYGRobHB0eHyEiIyQlJicoKSorLC0uLzAxMjM0NTY3ODk6Ozw9Pj9AQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpbXF1eX2BhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ent8fn+AgYKDhIWGh4iJiouMjY6PkZKTlJWWl5iZmpucnZ6foKGio6SlpqeoqaqrrK2ur7CxsrO0tba3uLm6u7y9vr/AwcLDxMXGx8jJysvMzc/Q0dLT1NXW19ja29zd3uDh4uPk5ebn6Onq6+zt7u/w8fLz9PX29/j5+vv8/f7v1AMKAAAAAWJLR0T61W0GSgAACWZJREFUGBnVwXlAVHUCB/DvmxkuD0QswFo3TcwzS0p01RVMpUytLKxMSVNpLUsLj7VDo7btsNTssrTMdAtWNjNbkyzF3EotwrXMI7XwAAxE5Jz5/rcaMMx782Z452/p84GV2na+ZmRqasrwxE4OtFRhI/+29SS9qn/86PGUKLQ4CW+X0p/n+xeTnGhB4v/NgIpXj3aihZhRyaCOPNYRwrW+KwkKmWxWTVYfiBRy49qzxW0hN5FaeLLiIUrv5UUkl0Au9iy1qXk1BgJIIzZ7eMG1kHuBmpVMkWCz0LQC1itzQkb6hTpsiYOdQmcfZ6M8yPWmLoWDYBsp9SCbZENuDPWpmgKbJO+mr9WQm0y95sEO8Zso9z7k7qJuj8JyzofPUeFjyA2nfvfDYl23089eyPWkfrXDYCXXI1X0Vy5BxllC/U50hHU676aqbpDLogEfoEFUR5g0qoTqJkJuAo0YjQZPpcIMab6bAayBXMgxGrDfiXrhBVnRMOyiTxhQkQtyGTTidjS4quZIEgzqfYRBjIFc2Pc0YCcaLWbdXyUY8acSBrMBCgPqqJ+nExpEniL/FQn9hpczKHdPKCyiAfeh0SMkf+wDvSbWsBlroCCtpX6volFkOcmzqdBntofN8QyGQkQudcuF12qe554DPWZRg70hUAjNoV6fwyuFv1nuhGYT3dRiDpRCVlCnHHiFlfM3m9tCo5trqUlFX/hJO0ddFqJJLut9HQ1NrquiRoc7wM/V31GPa9DkGTbIvwga9C+nZrlO+Al9opqabYWPqWy0NwbNuvQEdXgJKuI/oEaVfeFjFL32xaEZYV+yQeWBbVlZq15f9sp7W/YcrmYAS6AmOY9aeCbA13Vssv8SBPcazzuaPS/5Yvhy9bhtYfZxqlgiQU3SFg+bUzUJMtfTR0EUgpnK2s/n9oQ6qe+cT85R6SUnVPVYXsag9iVCLo2+dkQgsKv3zI9FUBGpuR7KbY6CulZ3bqplICfmhUHhWcpsdCGgi6FB16dOUeaHeATSbtyKI/Tn2TEtAn7yKLdSgkmt55ygr9M3I4ies9fkV7PJwXVTO0HFxbVUWAjTWj10kr7eikRQIb3vSJ8//5l5aSN7RyGAJ6nkuQXmRS1108eRZJgUeZp+yvvAAoP20od7VRxMeZEqDkXDAiFPuumjLCMExo3yUM2nLljhhhL6+iHVAYO6nqK6TFii05eU2ZfmhBHdf2YA7mRYIiybcnvTwqDbgJMM6Gh7WML5JhVOPvNH6CLNqmYQ62ENaSmVatbfFArNEvIoV7Phvmti2rXukrJgazXPmw6LLKa/4uUDHdAi/h8eylQtjoNX1H355JlOsIb0PtUUrhgTgeAcoza5KfddD8hIN37LjbBI+BdUV/HJI4NCEIBr2LKjVNrcFkquhypvh0UuOsCAzm5bktYnBHLRQx/d9Cv9veeCir550bBI3yoGVXv40xWZGdNT09LTH12yZmcR1X0VDlVtR8Aqc2mBXzrCdo7PaN44CHBZKc36CELMpUk1XSBE6EGa8xYEmUBT3L0giLSLZnwIYW6iGbdCGMdhGlcaAXHm07g3IVCHczRsHER6l0bVRkGk22jUTgjVpooGPQuxttCg8RDrARp0OcTqRWPKJYjlqqQh+RBtDw1ZD9FW0pDnIdqDNCQDoo2iIVMgWiINGQvRLqchwyBaFA35M0STamjEIAh3mkYMhnClNOJ6CHeGRqRCuCoakQ7RImhIJkSLoyFvQbSraMhWiDaWhhyFaDNpiKcdBFtOYwZCsG00ZjrEkoppzGsQqzsNyodY99CgukgI9TaNSoZIUiGNWgSREmjYfyDSszSsrj3EcRyjceMgTgpNWAlx1tGEYhdEiaygGddBlIdoyisQJKKQphx3QYxZNGk0hAj7mSblQIiZNKs2DgJEn6RpcyDACpr3kwu2S3TTAnfAbq58WmEP7PYYgzq1fdXf56anT5/ycOayNZ8WMaChsNeQWgZy4NXJie0hFzciY2MF1WyDrWJ/oaritfdchgAiRr18jP5ugI0cW6jCnZsWgaAcwzd6qPCdA/Z5mv4Ozr8EGvR4pZpyE2CbSR4qHU53QaP4LA99FbaDTW6po8L+iU7oMHg3fS2DPYZVUe50uhP6uBbWsom7P+xw7RnKrYuFfgMPsUl+KKw39FfKHEqBIW3Xs8lSWC61ijKrW8Egx1I2uQ0We8BNX1WzYMIsNxuVd4eVnIspc6gfTJnkZqP/RsM6l26nTG4UTHqAXl+1gVWGn6DMhnCYlkmvz8JhidDFHsqsdMICb9BrUxtY4M97KbdMghXCvqFXwWUwq+NaKjwHi3Qto1dhf5gSOruMCu9IsMqdbFI11wnDwmcepdLmEFhnHX18PQDGtM44Tj+72sBCl5yhD88/+0G/K18sor/CWFhqDuV2psfCq/UMNCdm9rdUU5cMa4V8TwVP/uszRicmJAyZ9m5ZJfCXpBAE4Lx2wWc1VLcQVhvHIN4DxrM0J2NwBBRikmdmlzCgrQ5YzbGfgaUA0k6eV1OQ8/y9qSMHJQy96e4HH389r5hBFcXBelMZ0DEngEQPdZsCG4T9zECewgUrqdcOCXZYyACqL8UFHYqoT21f2OJyD9WtQr1p1Oc52GQ3VXl6oZ6URz1OtYFNHqaqj9AovoI6LIBd/kBVQ+E1m9qVRMI2P1LFDjRx5FGzx2GfN+nPMxA+OpVQo7L2sM9k+suGzHhq9AJs1Jl+arpBbhW1uRJ2KqXSMii0LqAWu2Crb6hQGgOlrr9Sgxmw1ftUSIe/MR42q7I9bPU05bZLUPEEm5UDe02jTGU3qJHWsjn3wl7jKbMA6iK+YjO6wF430te3IQgg9hCDOgCbJdNH+RUIqMtxBvMybDaAPiYhiH5lDOJW2Kwfm7yBoJIqGFhX2CyJXgURCG74OQZS4YDNxrJR6RVozohKBrAHdpvEBjUj0LyUCqpbDbvdzwaTocWQUqqaB7stYr1MaJNQRDV3wG7v8DdrJGjU7SBVXA+7fcELPgyFZh2+oL/+sJmjjOd9HAYdWuXQzxWwWS+e92EodJEWeagQA5tNJ7khFHrdUk65cNgsh8wOhX4991GmFewVVs7nHTAiYil9tYO9Uuruh1F3n2GTONjr6dEwrnMevfrBXrEwwzGvig3GomXrvoP1HkQLJ6WV8II30OJ1XO0huQu/AwN3k5Vh+B1wpP3EIfhdCE2fhv+X/wF/AO+L9vuzfwAAAABJRU5ErkJggg==","png",5,12+3*p.length+4,3,3,null,"FAST"),i.setFontSize(10),i.text("wheregroup.com",40,12+3.25*p.length+4+1),i.setProperties({title:"Map export",subject:"Map export",creator:"WhereGroup GmbH",author:"(c)WhereGroup GmbH, (c)OpenStreetMap"}),i.save("Map.pdf"),l.remove(),null===(e=a.parentNode)||void 0===e||e.removeChild(a),Object.defineProperty(window,"devicePixelRatio",{get:function(){return n}}),r(!1)}))},f=r(633),m=r.n(f),h=r(168),g=r(1),y=function(e){var t=Object(n.useContext)(a.b),r=Object(n.useRef)(!1),o=Object(n.useRef)(void 0);return Object(n.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,o.current=t.getMap(e.mapId))}),[t.mapIds,t,e.mapId]),Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(h.a,{color:"primary",variant:"contained",onClick:function(){d(o.current,null,(function(){}))},children:Object(g.jsx)(m.a,{})})})};y.defaultProps={mapId:void 0},y.__docgenInfo={description:"Renders a button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).\n\n@component",methods:[],displayName:"MlCreatePdfButton",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};t.a=y;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlCreatePdfButton/MlCreatePdfButton.js"]={name:"MlCreatePdfButton",docgenInfo:y.__docgenInfo,path:"src/components/MlCreatePdfButton/MlCreatePdfButton.js"})},271:function(e,t,r){"use strict";var n=r(15),a=r(0),o=r(84),i=r(1163),s=r(64),c=r(34),l=r(96),u=r(1),p=function(e){var t=Object(a.useContext)(c.b),r=Object(s.a)({mapId:e.mapId,watch:{viewport:!0}}),p=Object(a.useRef)(void 0),d=Object(a.useRef)(!1),f=Object(a.useRef)(void 0),m=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlMarker-")+Object(l.a)()),h=Object(a.useState)({width:"400px",height:"500px"}),g=Object(n.a)(h,2),y=g[0],b=g[1],v=Object(a.useState)(void 0),j=Object(n.a)(v,2),O=j[0],x=j[1];return Object(a.useEffect)((function(){var e=m.current;return function(){f.current&&(f.current.cleanup(e),f.current=void 0),d.current=!1}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!d.current&&(d.current=!0,f.current=t.getMap(e.mapId))}),[t.mapIds,t,e.mapId]),Object(a.useEffect)((function(){var t;if(null!==(t=f.current)&&void 0!==t&&t.project){var r=f.current.project([e.lng,e.lat]);x(r)}}),[e.lng,e.lat,r.viewport]),Object(a.useEffect)((function(){var t,r,n,a;f.current&&null!==(t=p.current)&&void 0!==t&&null!==(r=t.contentWindow)&&void 0!==r&&null!==(n=r.document)&&void 0!==n&&null!==(a=n.body)&&void 0!==a&&a.scrollHeight&&setTimeout((function(){var t,r,n,a,o,i,s,c,l=f.current._container.clientHeight-f.current.project([e.lng,e.lat]).y,u=null===(t=p.current)||void 0===t||null===(r=t.contentWindow)||void 0===r||null===(n=r.document)||void 0===n||null===(a=n.body)||void 0===a?void 0:a.scrollHeight,d=null===(o=p.current)||void 0===o||null===(i=o.contentWindow)||void 0===i||null===(s=i.document)||void 0===s||null===(c=s.body)||void 0===c?void 0:c.scrollWidth;b({width:d,height:l<u?l:u})}),100)}),[e.lng,e.lat,e.content]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(o.a,{geojson:{type:"Feature",geometry:{type:"Point",coordinates:[e.lng,e.lat]},properties:{}},paint:{"circle-radius":14,"circle-color":"rgba(40,200,20,0.5)"},type:"circle",mapId:e.mapId}),O&&Object(u.jsx)(i.a,{sx:{opacity:.7,position:"fixed",display:"flex",left:O.x,top:O.y,width:y.width,height:y.height,"&:hover":{opacity:1},zIndex:-1},children:Object(u.jsx)("iframe",{style:{width:"100%"},srcDoc:e.content,ref:p,sandbox:"allow-same-origin allow-popups-to-escape-sandbox",frameBorder:"0",title:m.current})})]})};p.defaultProps={mapId:void 0},p.__docgenInfo={description:"Adds a marker to the map and displays a marker description next to it\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n@param {number} props.lng\n@param {number} props.lat\n@param {string} props.content\n\n@component",methods:[],displayName:"MlMarker",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},lng:{type:{name:"number"},required:!1,description:"Longitude of the marker position"},lat:{type:{name:"number"},required:!1,description:"Latitude of the marker position"},content:{type:{name:"string"},required:!1,description:"Content of the description popup"}}},t.a=p,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlMarker/MlMarker.js"]={name:"MlMarker",docgenInfo:p.__docgenInfo,path:"src/components/MlMarker/MlMarker.js"})},343:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.1074676513671875,50.74340774029213],[7.0992279052734375,50.756441089372665],[7.079315185546874,50.764693667025014],[7.045669555664062,50.77945780529241],[7.030563354492187,50.79161300845443],[7.0291900634765625,50.80940599750376],[7.0236968994140625,50.820685846099174],[7.0085906982421875,50.825891011253546],[6.9879913330078125,50.826758482363275],[6.97906494140625,50.835432306955276],[6.9824981689453125,50.84583876895451],[6.9962310791015625,50.85147463352982],[7.012023925781249,50.85710981721644],[7.021636962890625,50.86664473085768],[7.0367431640625,50.872278081520406],[7.0477294921875,50.877044231111014],[7.052536010742187,50.88397594225127]]}}')},345:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(5),a=r(15),o=r(0),i=r(10),s=r(1157),c=r(669),l=r(656),u=r.n(l),p=r(655),d=r.n(p),f=r(278),m=r(353),h=r(1),g=Object(s.a)((function(e){return{drawer:{flexGrow:1,zIndex:105,position:"absolute",top:0,left:0,bottom:0,backgroundColor:"#fafafa",display:"flex",flexDirection:"column",alignItems:"stretch",alignContent:"stretch"},drawerPaper:{position:"initial !important",boxSizing:"border-box",padding:"40px",visibility:"visible !important",zIndex:"initial !important"},drawerHeader:{alignContent:"flex-start",display:"flex"},drawerContent:{}}})),y=Object(i.a)("div")((function(e){e.theme;return{display:"flex",alignItems:"center"}}));function b(e){var t=g(),r=Object(m.a)("(max-width:900px)"),i=Object(o.useState)(!0),s=Object(a.a)(i,2),l=s[0],p=s[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(f.a,{onClick:function(){p(!0)},style:{zIndex:101,position:"relative",padding:"20px"},children:Object(h.jsx)(d.a,{})}),Object(h.jsxs)(c.a,{transitionDuration:0,className:t.drawer,variant:"persistent",anchor:"left",open:l,classes:{paper:t.drawerPaper},sx:Object(n.a)(Object(n.a)(Object(n.a)({},e.sx),{maxWidth:r?"90vw":"20vw"}),l?{}:{left:r?"-90vw":"-20vw"}),children:[Object(h.jsx)(y,{className:t.drawerHeader,children:Object(h.jsx)(f.a,{onClick:function(){p(!1)},children:Object(h.jsx)(u.a,{style:{}})})}),Object(h.jsx)("div",{style:{maxWidth:"100%"},children:e.children})]})]})}b.__docgenInfo={description:"",methods:[],displayName:"Sidebar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/Sidebar.js"]={name:"Sidebar",docgenInfo:b.__docgenInfo,path:"src/ui_components/Sidebar.js"})},351:function(e){e.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","properties":{},"geometry":{"coordinates":[[[7.08646747303149,50.74485058672653],[7.084287513691095,50.74371917250187],[7.084437772332876,50.743610683782215],[7.084640903561933,50.743721758552354],[7.085805654941254,50.74293993704128],[7.087023278906713,50.74218320888983],[7.087791368229503,50.74258090834434],[7.088796806075749,50.743261830692745],[7.089275088452752,50.743701110992674],[7.088087117762917,50.74409411011173],[7.087662548338368,50.743784963165815],[7.087184330538875,50.7440368518605],[7.087233860417484,50.744077781245316],[7.08714938625954,50.744122118772154],[7.087057544749172,50.74427276821896],[7.087104984084277,50.744509715654885],[7.08646747303149,50.74485058672653]]],"type":"Polygon"}}]}')},40:function(e,t,r){"use strict";r(0);var n=r(34),a=r(124),o=(r(599),r(276)),i=r(671),s=r(1),c=Object(o.a)({}),l=[function(e){return Object(s.jsx)("div",{className:"fullscreen_map",children:Object(s.jsx)(i.a,{theme:c,children:Object(s.jsxs)(n.a,{children:[Object(s.jsx)(e,{}),Object(s.jsx)(a.a,{options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]},mapId:"map_1"})]})})})}];t.a=l},599:function(e,t,r){},637:function(e,t,r){"use strict";(function(e){var n=function(){var t,n=/\s*/g,a=/^\s*|\s*$/g,o=/\s+/;function i(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function s(e,t){return e.getElementsByTagName(t)}function c(e,t){return e.getAttribute(t)}function l(e,t){return parseFloat(c(e,t))}function u(e,t){var r=s(e,t);return r.length?r[0]:null}function p(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function d(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function f(e,t){var r,n,a={};for(n=0;n<t.length;n++)(r=u(e,t[n]))&&(a[t[n]]=d(r));return a}function m(e,t){for(var r in t)e[r]=t[r]}function h(e){return p(e.replace(n,"").split(","))}function g(e){for(var t=e.replace(a,"").split(o),r=[],n=0;n<t.length;n++)r.push(h(t[n]));return r}function y(e){var t,r=[l(e,"lon"),l(e,"lat")],n=u(e,"ele"),a=u(e,"gpxtpx:hr")||u(e,"hr"),o=u(e,"time");return n&&(t=parseFloat(d(n)),isNaN(t)||r.push(t)),{coordinates:r,time:o?d(o):null,heartRate:a?parseFloat(d(a)):null}}if("undefined"!=typeof XMLSerializer)t=new XMLSerializer;else{var b="object"==typeof e&&!e.browser,v="object"==typeof Titanium;if("object"!=typeof exports||!b&&!v)throw new Error("Unable to initialize serializer");t=new(r(1100).XMLSerializer)}function j(e){return void 0!==e.xml?e.xml:t.serializeToString(e)}return{kml:function(e){for(var t={type:"FeatureCollection",features:[]},r={},n={},a={},o=["Polygon","LineString","Point","Track","gx:Track"],l=s(e,"Placemark"),f=s(e,"Style"),m=s(e,"StyleMap"),y=0;y<f.length;y++){var b=i(j(f[y])).toString(16);r["#"+c(f[y],"id")]=b,n[b]=f[y]}for(var v=0;v<m.length;v++){r["#"+c(m[v],"id")]=i(j(m[v])).toString(16);for(var O=s(m[v],"Pair"),x={},S=0;S<O.length;S++)x[d(u(O[S],"key"))]=d(u(O[S],"styleUrl"));a["#"+c(m[v],"id")]=x}for(var M=0;M<l.length;M++)t.features=t.features.concat(w(l[M]));function C(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function L(e){var t=s(e,"coord"),r=[],n=[];0===t.length&&(t=s(e,"gx:coord"));for(var a=0;a<t.length;a++)r.push(p(d(t[a]).split(" ")));for(var o=s(e,"when"),i=0;i<o.length;i++)n.push(d(o[i]));return{coords:r,times:n}}function w(e){var t,i=function e(t){var r,n,a,i,c,l=[],p=[];if(u(t,"MultiGeometry"))return e(u(t,"MultiGeometry"));if(u(t,"MultiTrack"))return e(u(t,"MultiTrack"));if(u(t,"gx:MultiTrack"))return e(u(t,"gx:MultiTrack"));for(a=0;a<o.length;a++)if(n=s(t,o[a]))for(i=0;i<n.length;i++)if(r=n[i],"Point"===o[a])l.push({type:"Point",coordinates:h(d(u(r,"coordinates")))});else if("LineString"===o[a])l.push({type:"LineString",coordinates:g(d(u(r,"coordinates")))});else if("Polygon"===o[a]){var f=s(r,"LinearRing"),m=[];for(c=0;c<f.length;c++)m.push(g(d(u(f[c],"coordinates"))));l.push({type:"Polygon",coordinates:m})}else if("Track"===o[a]||"gx:Track"===o[a]){var y=L(r);l.push({type:"LineString",coordinates:y.coords}),y.times.length&&p.push(y.times)}return{geoms:l,coordTimes:p}}(e),l={},p=d(u(e,"name")),f=d(u(e,"address")),m=d(u(e,"styleUrl")),y=d(u(e,"description")),b=u(e,"TimeSpan"),v=u(e,"TimeStamp"),j=u(e,"ExtendedData"),O=u(e,"LineStyle"),x=u(e,"PolyStyle"),S=u(e,"visibility");if(!i.geoms.length)return[];if(p&&(l.name=p),f&&(l.address=f),m){"#"!==m[0]&&(m="#"+m),l.styleUrl=m,r[m]&&(l.styleHash=r[m]),a[m]&&(l.styleMapHash=a[m],l.styleHash=r[a[m].normal]);var M=n[l.styleHash];if(M){O||(O=u(M,"LineStyle")),x||(x=u(M,"PolyStyle"));var w=u(M,"IconStyle");if(w){var I=u(w,"Icon");if(I){var E=d(u(I,"href"));E&&(l.icon=E)}}}}if(y&&(l.description=y),b){var T=d(u(b,"begin")),_=d(u(b,"end"));l.timespan={begin:T,end:_}}if(v&&(l.timestamp=d(u(v,"when"))),O){var R=C(d(u(O,"color"))),A=R[0],P=R[1],k=parseFloat(d(u(O,"width")));A&&(l.stroke=A),isNaN(P)||(l["stroke-opacity"]=P),isNaN(k)||(l["stroke-width"]=k)}if(x){var H=C(d(u(x,"color"))),F=H[0],N=H[1],B=d(u(x,"fill")),U=d(u(x,"outline"));F&&(l.fill=F),isNaN(N)||(l["fill-opacity"]=N),B&&(l["fill-opacity"]="1"===B?l["fill-opacity"]||1:0),U&&(l["stroke-opacity"]="1"===U?l["stroke-opacity"]||1:0)}if(j){var G=s(j,"Data"),D=s(j,"SimpleData");for(t=0;t<G.length;t++)l[G[t].getAttribute("name")]=d(u(G[t],"value"));for(t=0;t<D.length;t++)l[D[t].getAttribute("name")]=d(D[t])}S&&(l.visibility=d(S)),i.coordTimes.length&&(l.coordTimes=1===i.coordTimes.length?i.coordTimes[0]:i.coordTimes);var q={type:"Feature",geometry:1===i.geoms.length?i.geoms[0]:{type:"GeometryCollection",geometries:i.geoms},properties:l};return c(e,"id")&&(q.id=c(e,"id")),[q]}return t},gpx:function(e){var t,r,n=s(e,"trk"),a=s(e,"rte"),o=s(e,"wpt"),i={type:"FeatureCollection",features:[]};for(t=0;t<n.length;t++)(r=h(n[t]))&&i.features.push(r);for(t=0;t<a.length;t++)(r=g(a[t]))&&i.features.push(r);for(t=0;t<o.length;t++)i.features.push(b(o[t]));function l(e,t){for(var r=0;r<t;r++)e.push(null);return e}function p(e,t){var r=s(e,t),n=[],a=[],o=[],i=r.length;if(i<2)return{};for(var c=0;c<i;c++){var u=y(r[c]);n.push(u.coordinates),u.time&&a.push(u.time),(u.heartRate||o.length)&&(o.length||l(o,c),o.push(u.heartRate||null))}return{line:n,times:a,heartRates:o}}function h(e){for(var t,r=s(e,"trkseg"),n=[],a=[],o=[],i=0;i<r.length;i++)if((t=p(r[i],"trkpt"))&&(t.line&&n.push(t.line),t.times&&t.times.length&&a.push(t.times),o.length||t.heartRates&&t.heartRates.length)){if(!o.length)for(var c=0;c<i;c++)o.push(l([],n[c].length));t.heartRates&&t.heartRates.length?o.push(t.heartRates):o.push(l([],t.line.length||0))}if(0!==n.length){var d=j(e);return m(d,v(u(e,"extensions"))),a.length&&(d.coordTimes=1===n.length?a[0]:a),o.length&&(d.heartRates=1===n.length?o[0]:o),{type:"Feature",properties:d,geometry:{type:1===n.length?"LineString":"MultiLineString",coordinates:1===n.length?n[0]:n}}}}function g(e){var t=p(e,"rtept");if(t.line){var r=j(e);return m(r,v(u(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}}function b(e){var t=j(e);return m(t,f(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:y(e).coordinates}}}function v(e){var t={};if(e){var r=u(e,"line");if(r){var n=d(u(r,"color")),a=parseFloat(d(u(r,"opacity"))),o=parseFloat(d(u(r,"width")));n&&(t.stroke=n),isNaN(a)||(t["stroke-opacity"]=a),isNaN(o)||(t["stroke-width"]=96*o/25.4)}}return t}function j(e){var t=f(e,["name","cmt","desc","type","time","keywords"]),r=s(e,"link");r.length&&(t.links=[]);for(var n,a=0;a<r.length;a++)m(n={href:c(r[a],"href")},f(r[a],["text","type"])),t.links.push(n);return t}return i}}}();t.a=n}).call(this,r(170))},64:function(e,t,r){"use strict";var n=r(15),a=r(0),o=r(3),i=r.n(o),s=r(96),c=r(34);function l(e){var t=Object(a.useContext)(c.b),r=Object(a.useRef)(!1),o=Object(a.useRef)(void 0),i=Object(a.useState)(void 0),l=Object(n.a)(i,2),u=l[0],p=l[1],d=Object(a.useRef)(void 0),f=Object(a.useState)(void 0),m=Object(n.a)(f,2),h=m[0],g=m[1],y=Object(a.useRef)(void 0),b=Object(a.useRef)(Object(s.a)()),v=Object(a.useCallback)((function(t){var r,n;return!((null==e||null===(r=e.filter)||void 0===r||!r.includeBaseLayers)&&t.baseLayer)&&(void 0===(null===(n=e.filter)||void 0===n?void 0:n.matchLayerIds)||(e.filter.matchLayerIds instanceof RegExp?e.filter.matchLayerIds.test(t.id):t.id.includes(e.filter.matchLayerIds)))}),[e.filter]),j=Object(a.useCallback)((function(){var e=o.current.wrapper.layerState.filter(v),t=JSON.stringify(e);y.current!==t&&(y.current=t,g(e))}),[v]);return Object(a.useEffect)((function(){var e=b.current;return function(){o.current&&(o.current.cleanup(e),o.current=void 0),r.current=!1}}),[]),Object(a.useEffect)((function(){var n,a,i,s;t.mapExists(e.mapId)&&!r.current&&(r.current=!0,o.current=t.getMap(e.mapId),null!=e&&null!==(n=e.watch)&&void 0!==n&&n.viewport&&(p(o.current.wrapper.viewportState),o.current.wrapper.on("viewportchange",(function(){var e,t;d.current!==(null===(e=o.current)||void 0===e?void 0:e.wrapper.viewportStateString)&&p(null===(t=o.current)||void 0===t?void 0:t.wrapper.viewportState)}),b.current)),null!=e&&null!==(a=e.watch)&&void 0!==a&&a.layers&&(j(),o.current.wrapper.on("layerchange",j,{includeBaseLayers:null==e||null===(i=e.filter)||void 0===i?void 0:i.includeBaseLayers,matchLayerIds:null==e||null===(s=e.filter)||void 0===s?void 0:s.matchLayerIds},b.current)))}),[t.mapIds,t,e.mapId,j,e]),{layers:h,viewport:u}}l.defaultProps={mapId:void 0,watch:{layers:!0,sources:!1,viewport:!1},filter:{includeBaseLayers:!1}},l.propTypes={mapId:i.a.string,watch:i.a.shape({layers:i.a.bool,sources:i.a.bool,viewport:i.a.bool}),filter:i.a.shape({includeBaseLayers:i.a.bool,matchLayerIds:i.a.oneOfType([i.a.string,i.a.instanceOf(RegExp)]),matchSourceIds:i.a.oneOfType([i.a.string,i.a.instanceOf(RegExp)])})},t.a=l},644:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.1074676513671875,50.74340774029213],[7.0992279052734375,50.756441089372665],[7.079315185546874,50.764693667025014],[7.045669555664062,50.77945780529241],[7.030563354492187,50.79161300845443],[7.0291900634765625,50.80940599750376],[7.0236968994140625,50.820685846099174],[7.0085906982421875,50.825891011253546],[6.9879913330078125,50.826758482363275],[6.97906494140625,50.835432306955276],[6.9824981689453125,50.84583876895451],[6.9962310791015625,50.85147463352982],[7.012023925781249,50.85710981721644],[7.021636962890625,50.86664473085768],[7.0367431640625,50.872278081520406],[7.0477294921875,50.877044231111014],[7.052536010742187,50.88397594225127]]}}')},645:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.0635223388671875,50.71385204707258],[7.06146240234375,50.709721458354075],[7.063865661621094,50.70298129536074],[7.064552307128906,50.69906720767511],[7.059059143066406,50.69428287906098],[7.05596923828125,50.68797551838366],[7.0580291748046875,50.680797145321655],[7.062835693359375,50.67514068397085],[7.060432434082031,50.6686131506577],[7.051849365234375,50.659255436656736],[7.044639587402344,50.6512019574539],[7.0484161376953125,50.64271166020676],[7.0566558837890625,50.63748609931014]]}}')},657:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.0635223388671875,50.71385204707258],[7.06146240234375,50.709721458354075],[7.063865661621094,50.70298129536074],[7.064552307128906,50.69906720767511],[7.059059143066406,50.69428287906098],[7.05596923828125,50.68797551838366],[7.0580291748046875,50.680797145321655],[7.062835693359375,50.67514068397085],[7.060432434082031,50.6686131506577],[7.051849365234375,50.659255436656736],[7.044639587402344,50.6512019574539],[7.0484161376953125,50.64271166020676],[7.0566558837890625,50.63748609931014]]}}')},661:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.1074676513671875,50.74340774029213],[7.0992279052734375,50.756441089372665],[7.079315185546874,50.764693667025014],[7.045669555664062,50.77945780529241],[7.030563354492187,50.79161300845443],[7.0291900634765625,50.80940599750376],[7.0236968994140625,50.820685846099174],[7.0085906982421875,50.825891011253546],[6.9879913330078125,50.826758482363275],[6.97906494140625,50.835432306955276],[6.9824981689453125,50.84583876895451],[6.9962310791015625,50.85147463352982],[7.012023925781249,50.85710981721644],[7.021636962890625,50.86664473085768],[7.0367431640625,50.872278081520406],[7.0477294921875,50.877044231111014],[7.052536010742187,50.88397594225127]]}}')},662:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.0635223388671875,50.71385204707258],[7.06146240234375,50.709721458354075],[7.063865661621094,50.70298129536074],[7.064552307128906,50.69906720767511],[7.059059143066406,50.69428287906098],[7.05596923828125,50.68797551838366],[7.0580291748046875,50.680797145321655],[7.062835693359375,50.67514068397085],[7.060432434082031,50.6686131506577],[7.051849365234375,50.659255436656736],[7.044639587402344,50.6512019574539],[7.0484161376953125,50.64271166020676],[7.0566558837890625,50.63748609931014]]}}')},663:function(e){e.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","properties":{},"geometry":{"coordinates":[[[7.08646747303149,50.74485058672653],[7.084287513691095,50.74371917250187],[7.084437772332876,50.743610683782215],[7.084640903561933,50.743721758552354],[7.085805654941254,50.74293993704128],[7.087023278906713,50.74218320888983],[7.087791368229503,50.74258090834434],[7.088796806075749,50.743261830692745],[7.089275088452752,50.743701110992674],[7.088087117762917,50.74409411011173],[7.087662548338368,50.743784963165815],[7.087184330538875,50.7440368518605],[7.087233860417484,50.744077781245316],[7.08714938625954,50.744122118772154],[7.087057544749172,50.74427276821896],[7.087104984084277,50.744509715654885],[7.08646747303149,50.74485058672653]]],"type":"Polygon"}}]}')},721:function(e,t,r){r(722),r(878),r(879),r(1135),r(1128),r(1138),r(1139),r(1140),r(1136),r(1130),r(1141),r(1129),r(1131),r(1142),e.exports=r(1043)},76:function(e,t,r){"use strict";var n=r(15),a=r(0),o=r(96),i=r(34),s=r(64);t.a=function(e){var t=Object(a.useContext)(i.b),r=Object(s.a)({mapId:e.mapId,watch:{viewport:!1,layers:!!e.waitForLayer,sources:!1},filter:{includeBaseLayers:!0}}),c=Object(a.useRef)(!1),l=Object(a.useRef)(void 0),u=Object(a.useRef)(Object(o.a)()),p=Object(a.useState)(!1),d=Object(n.a)(p,2),f=d[0],m=d[1];return Object(a.useEffect)((function(){var e=u.current;return function(){l.current&&(l.current.cleanup(e),l.current=void 0),c.current=!1,m(!1)}}),[]),Object(a.useEffect)((function(){if(t.mapExists(e.mapId)&&!c.current){if(e.waitForLayer){var n,a=!1;if(null==r||null===(n=r.layers)||void 0===n||n.forEach((function(t){t.id===e.waitForLayer&&(a=!0)})),!a)return}c.current=!0,l.current=t.getMap(e.mapId),m(!0)}}),[t.mapIds,r.layers,t,e.waitForLayer,e.mapId]),{map:l.current,mapIsReady:f,componentId:u.current,layers:r.layers}}},788:function(e,t){},84:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(3),i=r.n(o),s=r(76),c=function(e,t){switch(e){case"fill":return null!=t&&t.fill?t.fill:{"fill-color":"rgba(10,240,256,0.6)"};case"line":return null!=t&&t.line?t.line:{"line-color":"rgb(203,211,2)","line-width":5};case"circle":default:return null!=t&&t.circle?t.circle:{"circle-color":"rgba(10,240,256)","circle-stroke-color":"#fff","circle-stroke-width":2}}},l={Position:"circle",Point:"circle",MultiPoint:"circle",LineString:"line",MultiLineString:"line",Polygon:"fill",MultiPolygon:"fill",GeometryCollection:"circle"},u=function e(t){var r;return"Feature"===(null==t?void 0:t.type)?null!=l&&l[null==t||null===(r=t.geometry)||void 0===r?void 0:r.type]?l[t.geometry.type]:"circle":"FeatureCollection"===(null==t?void 0:t.type)?t.features.length?e(t.features[0]):"circle":void 0},p=r(1),d=["circle","fill","line"],f=function(e){var t=Object(s.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(a.useRef)(!1),o=Object(a.useRef)(e.layerId||"MlGeoJsonLayer-"+t.componentId),i=Object(a.useRef)(void 0);Object(a.useEffect)((function(){if(t.map&&r.current)for(var n in e.layout)t.map.setLayoutProperty(o.current,n,e.layout[n])}),[e.layout,t.map,e.mapId]),Object(a.useEffect)((function(){if(t.map&&r.current){var n=e.paint||c(i.current,e.defaultPaintOverrides);for(var a in n)t.map.setPaintProperty(o.current,a,n[a])}}),[e.paint,t.map,e.mapId,e.defaultPaintOverrides]),Object(a.useEffect)((function(){var n;null!=t&&null!==(n=t.map)&&void 0!==n&&n.getSource(o.current)&&r.current&&t.map.getSource(o.current).setData(e.geojson)}),[e.geojson,t.map,e.type]);var l=Object(a.useCallback)((function(){var r=e.geojson;i.current=e.type||u(e.geojson),t.map.addLayer(Object(n.a)({id:o.current,source:{type:"geojson",data:r},type:i.current,paint:e.paint||c(i.current,e.defaultPaintOverrides),layout:e.layout||{}},e.options),e.insertBeforeLayer,t.componentId),void 0!==e.onHover&&t.map.on("mousemove",o.current,e.onHover,t.componentId),void 0!==e.onClick&&t.map.on("click",o.current,e.onClick,t.componentId),void 0!==e.onLeave&&t.map.on("mouseleave",o.current,e.onLeave,t.componentId)}),[t,e]);return Object(a.useEffect)((function(){if(t.map&&e.geojson){if(r.current&&-1!==d.indexOf(e.type)&&i.current&&e.type!==i.current)t.map.cleanup(t.componentId);else if(r.current&&(-1===d.indexOf(e.type)||-1!==d.indexOf(e.type)&&e.type===i.current))return;r.current=!0,l()}}),[t,l,e]),Object(p.jsx)(p.Fragment,{})};f.propTypes={mapId:i.a.string,type:i.a.string,layout:i.a.object,paint:i.a.object,defaultPaintOverrides:i.a.object,options:i.a.object,geojson:i.a.object,insertBeforeLayer:i.a.string,layerId:i.a.string,onClick:i.a.func,onHover:i.a.func,onLeave:i.a.func},f.__docgenInfo={description:'Adds source and layer of types "line", "fill" or "circle" to display GeoJSON data on the map.\n\n@component',methods:[],displayName:"MlGeoJsonLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},type:{type:{name:"string"},required:!1,description:'Type of the layer that will be added to the MapLibre instance.\nPossible values: "line", "circle", "fill"'},layout:{type:{name:"object"},required:!1,description:"Layout property object, that is passed to the addLayer call.\nPossible props depend on the layer type.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill"},paint:{type:{name:"object"},required:!1,description:"Paint property object, that is passed to the addLayer call.\nPossible props depend on the layer type.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill"},defaultPaintOverrides:{type:{name:"object"},required:!1,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.'},options:{type:{name:"object"},required:!1,description:"Javascript object that is spread into the addLayer commands first parameter."},geojson:{type:{name:"object"},required:!1,description:"GeoJSON data that is supposed to be rendered by this component."},insertBeforeLayer:{type:{name:"string"},required:!1,description:'Id of an existing layer in the mapLibre instance to help specify the layer order\nThis layer will be visually beneath the layer with the "insertBeforeLayer" id.'},layerId:{type:{name:"string"},required:!1,description:"Id of the new layer and source that are added to the MapLibre instance"},onClick:{type:{name:"func"},required:!1,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked."},onHover:{type:{name:"func"},required:!1,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered."},onLeave:{type:{name:"func"},required:!1,description:"Leave event handler that is executed whenever a geometry rendered by this component is\nleft/unhovered."}}};t.a=f;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlGeoJsonLayer/MlGeoJsonLayer.js"]={name:"MlGeoJsonLayer",docgenInfo:f.__docgenInfo,path:"src/components/MlGeoJsonLayer/MlGeoJsonLayer.js"})},879:function(e,t,r){"use strict";r.r(t);r(511)},92:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r(0);var n=r(1162),a=r(1164),o=r(1);function i(e){return Object(o.jsx)("div",{style:{flexGrow:1,zIndex:120,position:"absolute",top:0,left:0,right:0},children:Object(o.jsx)(n.a,{sx:{minHeight:"62px",backgroundColor:"#f1f1f1"},color:"primary",position:"static",children:Object(o.jsx)(a.a,{children:e.children})})})}i.__docgenInfo={description:"",methods:[],displayName:"TopToolbar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/TopToolbar.js"]={name:"TopToolbar",docgenInfo:i.__docgenInfo,path:"src/ui_components/TopToolbar.js"})},93:function(e,t,r){"use strict";var n=r(5),a=r(0),o=r(76),i=r(3),s=r.n(i),c=r(1),l={visible:!0,urlParameters:{bbox:"{bbox-epsg-3857}",format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",width:256,height:256,styles:""},attribution:"",sourceOptions:{minZoom:0,maxZoom:20},layerOptions:{minZoom:0,maxZoom:20}},u=function(e){var t=Object(o.a)({mapId:e.mapId,waitForLayer:e.insertBeforeLayer}),r=Object(a.useRef)(!1),i=Object(a.useRef)(e.layerId||"MlWmsLayer-"+t.componentId);return Object(a.useEffect)((function(){var a;if(t.map&&!r.current){var o;r.current=!0;var s=e.url;-1!==e.url.indexOf("?")&&(s=(o=e.url.split("?"))[0]);var c=new URLSearchParams(null===(a=o)||void 0===a?void 0:a[1]),u=Object(n.a)(Object(n.a)(Object(n.a)({},l.urlParameters),Object.fromEntries(c)),e.urlParameters),p=new URLSearchParams(u),d=decodeURIComponent(p.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");t.map.addSource(i.current,Object(n.a)({type:"raster",tiles:[s+"?"+d],tileSize:u.width,attribution:e.attribution},e.sourceOptions),t.componentId),t.map.addLayer(Object(n.a)({id:i.current,type:"raster",source:i.current},e.layerOptions),e.insertBeforeLayer,t.componentId),e.visible||t.map.setLayoutProperty(i.current,"visibility","none")}}),[t,e]),Object(a.useEffect)((function(){t.map&&r.current&&(e.visible?t.map.setLayoutProperty(i.current,"visibility","visible"):t.map.setLayoutProperty(i.current,"visibility","none"))}),[e.visible,t.map]),Object(c.jsx)(c.Fragment,{})};u.defaultProps=Object(n.a)({},l),u.propTypes={url:s.a.string.isRequired,urlParameters:s.a.shape({layers:s.a.string.isRequired,bbox:s.a.string,format:s.a.string,service:s.a.string,version:s.a.string,request:s.a.string,srs:s.a.string,width:s.a.number,height:s.a.number}),mapId:s.a.string,attribution:s.a.string,layerOptions:s.a.object,sourceOptions:s.a.object,insertBeforeLayer:s.a.string,visible:s.a.bool},u.__docgenInfo={description:'Adds a WMS raster source & layer to the maplibre-gl instance\n\n@param {object} props\n@param {object} props.urlParameters URL query parameters that will be added to the WMS URL. A layers property (string) is mandatory. Any value defined on this attribute will extend the default object\n@param {string} props.url WMS URL\n@param {bool} props.visible Sets layer "visibility" property to "visible" if true or "none" if false\n@param {string} props.attribution MapLibre attribution shown in the bottom right of the map, if this layer is visible\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n@param {object} props.sourceOptions Object that is passed to the MapLibre.addSource call as config option parameter\n@param {object} props.layerOptions Object that is passed to the MapLibre.addLayer call as config option parameter\n@param {string} props.insertBeforeLayer Id of an existing layer in the mapLibre instance to help specify the layer order\n                                           This layer will be visually beneath the layer with the "insertBeforeLayer" id\n\n@component',methods:[],displayName:"MlWmsLayer",props:{visible:{defaultValue:{value:"true",computed:!1},type:{name:"bool"},required:!1,description:'Sets layer "visibility" property to "visible" if true or "none" if false'},urlParameters:{defaultValue:{value:'{\n  bbox: "{bbox-epsg-3857}",\n  format: "image/png",\n  service: "WMS",\n  version: "1.1.1",\n  request: "GetMap",\n  srs: "EPSG:3857",\n  width: 256,\n  height: 256,\n  styles: "",\n}',computed:!1},type:{name:"shape",value:{layers:{name:"string",required:!0},bbox:{name:"string",required:!1},format:{name:"string",required:!1},service:{name:"string",required:!1},version:{name:"string",required:!1},request:{name:"string",required:!1},srs:{name:"string",required:!1},width:{name:"number",required:!1},height:{name:"number",required:!1}}},required:!1,description:"URL query parameters that will be added to the WMS URL. A layers property (string) is mandatory. Any value defined on this attribute will extend the default object."},attribution:{defaultValue:{value:'""',computed:!1},type:{name:"string"},required:!1,description:"MapLibre attribution shown in the bottom right of the map, if this layer is visible"},sourceOptions:{defaultValue:{value:"{\n  minZoom: 0,\n  maxZoom: 20,\n}",computed:!1},type:{name:"object"},required:!1,description:"Object that is passed to the MapLibre.addSource call as config option parameter"},layerOptions:{defaultValue:{value:"{\n  minZoom: 0,\n  maxZoom: 20,\n}",computed:!1},type:{name:"object"},required:!1,description:"Object that is passed to the MapLibre.addLayer call as config option parameter"},url:{type:{name:"string"},required:!0,description:"WMS URL"},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'Id of an existing layer in the mapLibre instance to help specify the layer order\nThis layer will be visually beneath the layer with the "insertBeforeLayer" id.'}}},t.a=u,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlWmsLayer/MlWmsLayer.js"]={name:"MlWmsLayer",docgenInfo:u.__docgenInfo,path:"src/components/MlWmsLayer/MlWmsLayer.js"})}});
//# sourceMappingURL=main~24120820.d4921867.iframe.bundle.js.map